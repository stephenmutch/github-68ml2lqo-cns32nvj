const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/browser-DphJ6FDu.js","assets/react-vendor-DWJgz7Ui.js","assets/CustomerSearch-91yax2Nn.js","assets/ui-vendor-Cpg-DzmZ.js","assets/useDebounce-Q5Dd_TAD.js","assets/QueryList-CfNXohZy.js","assets/TagList-W2pCEymf.js","assets/GroupList-8IalffFt.js","assets/ClubList-BHo-9fE0.js"])))=>i.map(i=>d[i]);
import{j as e,S as t,a as s,b as r,P as a,C as i,I as n,c as o,d as l,R as c,L as d,e as u,f as h,T as m,g as p,h as x,i as g,k as f,l as v,m as y,V as j,n as b,o as w,p as N,q as _,r as k,s as S,t as C,u as T,v as A,w as P,x as E,y as O,z as $,O as R,A as D,B as I,D as M,E as q,F as L,G as F,H as z,J as V,K as U,M as Z,N as B,Q as G,U as W,W as J,X as H,Y as K,Z as Y}from"./ui-vendor-Cpg-DzmZ.js";import{a as Q,g as X,d as ee,r as te,N as se,O as re,u as ae,e as ie,R as ne,f as oe,B as le,h as ce,i as de,j as ue}from"./react-vendor-DWJgz7Ui.js";var he;!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const s of e)if("childList"===s.type)for(const e of s.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerPolicy&&(t.referrerPolicy=e.referrerPolicy),"use-credentials"===e.crossOrigin?t.credentials="include":"anonymous"===e.crossOrigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();var me=Q;he=me.createRoot,me.hydrateRoot;const pe={},xe=function(e,t,s){let r=Promise.resolve();if(t&&t.length>0){document.getElementsByTagName("link");const e=document.querySelector("meta[property=csp-nonce]"),s=(null==e?void 0:e.nonce)||(null==e?void 0:e.getAttribute("nonce"));r=Promise.allSettled(t.map((e=>{if((e=function(e){return"/"+e}(e))in pe)return;pe[e]=!0;const t=e.endsWith(".css"),r=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${r}`))return;const a=document.createElement("link");return a.rel=t?"stylesheet":"modulepreload",t||(a.as="script"),a.crossOrigin="",a.href=e,s&&a.setAttribute("nonce",s),document.head.appendChild(a),t?new Promise(((t,s)=>{a.addEventListener("load",t),a.addEventListener("error",(()=>s(new Error(`Unable to preload CSS for ${e}`))))})):void 0})))}function a(e){const t=new Event("vite:preloadError",{cancelable:!0});if(t.payload=e,window.dispatchEvent(t),!t.defaultPrevented)throw e}return r.then((t=>{for(const e of t||[])"rejected"===e.status&&a(e.reason);return e().catch(a)}))};class ge extends Error{constructor(e,t="FunctionsError",s){super(e),this.name=t,this.context=s}}class fe extends ge{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class ve extends ge{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class ye extends ge{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var je,be;(be=je||(je={})).Any="any",be.ApNortheast1="ap-northeast-1",be.ApNortheast2="ap-northeast-2",be.ApSouth1="ap-south-1",be.ApSoutheast1="ap-southeast-1",be.ApSoutheast2="ap-southeast-2",be.CaCentral1="ca-central-1",be.EuCentral1="eu-central-1",be.EuWest1="eu-west-1",be.EuWest2="eu-west-2",be.EuWest3="eu-west-3",be.SaEast1="sa-east-1",be.UsEast1="us-east-1",be.UsWest1="us-west-1",be.UsWest2="us-west-2";var we=function(e,t,s,r){return new(s||(s=Promise))((function(a,i){function n(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((r=r.apply(e,t||[])).next())}))};class Ne{constructor(e,{headers:t={},customFetch:s,region:r=je.Any}={}){this.url=e,this.headers=t,this.region=r,this.fetch=(e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>xe((async()=>{const{default:e}=await Promise.resolve().then((()=>Ie));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)})(s)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,t={}){var s;return we(this,void 0,void 0,(function*(){try{const{headers:r,method:a,body:i}=t;let n,o={},{region:l}=t;l||(l=this.region),l&&"any"!==l&&(o["x-region"]=l),i&&(r&&!Object.prototype.hasOwnProperty.call(r,"Content-Type")||!r)&&("undefined"!=typeof Blob&&i instanceof Blob||i instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",n=i):"string"==typeof i?(o["Content-Type"]="text/plain",n=i):"undefined"!=typeof FormData&&i instanceof FormData?n=i:(o["Content-Type"]="application/json",n=JSON.stringify(i)));const c=yield this.fetch(`${this.url}/${e}`,{method:a||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),r),body:n}).catch((e=>{throw new fe(e)})),d=c.headers.get("x-relay-error");if(d&&"true"===d)throw new ve(c);if(!c.ok)throw new ye(c);let u,h=(null!==(s=c.headers.get("Content-Type"))&&void 0!==s?s:"text/plain").split(";")[0].trim();return u="application/json"===h?yield c.json():"application/octet-stream"===h?yield c.blob():"text/event-stream"===h?c:"multipart/form-data"===h?yield c.formData():yield c.text(),{data:u,error:null}}catch(r){return{data:null,error:r}}}))}}var _e={},ke={},Se={},Ce={},Te={},Ae={},Pe=function(){if("undefined"!=typeof self)return self;if("undefined"!=typeof window)return window;if("undefined"!=typeof global)return global;throw new Error("unable to locate global object")}();const Ee=Pe.fetch,Oe=Pe.fetch.bind(Pe),$e=Pe.Headers,Re=Pe.Request,De=Pe.Response,Ie=Object.freeze(Object.defineProperty({__proto__:null,Headers:$e,Request:Re,Response:De,default:Oe,fetch:Ee},Symbol.toStringTag,{value:"Module"})),Me=X(Ie);var qe={};Object.defineProperty(qe,"__esModule",{value:!0});let Le=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};qe.default=Le;var Fe=ee&&ee.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ae,"__esModule",{value:!0});const ze=Fe(Me),Ve=Fe(qe);Ae.default=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:"undefined"==typeof fetch?this.fetch=ze.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,t){return this.headers=Object.assign({},this.headers),this.headers[e]=t,this}then(e,t){void 0===this.schema||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),"GET"!==this.method&&"HEAD"!==this.method&&(this.headers["Content-Type"]="application/json");let s=(0,this.fetch)(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then((async e=>{var t,s,r;let a=null,i=null,n=null,o=e.status,l=e.statusText;if(e.ok){if("HEAD"!==this.method){const t=await e.text();""===t||(i="text/csv"===this.headers.Accept||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?t:JSON.parse(t))}const r=null===(t=this.headers.Prefer)||void 0===t?void 0:t.match(/count=(exact|planned|estimated)/),c=null===(s=e.headers.get("content-range"))||void 0===s?void 0:s.split("/");r&&c&&c.length>1&&(n=parseInt(c[1])),this.isMaybeSingle&&"GET"===this.method&&Array.isArray(i)&&(i.length>1?(a={code:"PGRST116",details:`Results contain ${i.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},i=null,n=null,o=406,l="Not Acceptable"):i=1===i.length?i[0]:null)}else{const t=await e.text();try{a=JSON.parse(t),Array.isArray(a)&&404===e.status&&(i=[],a=null,o=200,l="OK")}catch(c){404===e.status&&""===t?(o=204,l="No Content"):a={message:t}}if(a&&this.isMaybeSingle&&(null===(r=null==a?void 0:a.details)||void 0===r?void 0:r.includes("0 rows"))&&(a=null,o=200,l="OK"),a&&this.shouldThrowOnError)throw new Ve.default(a)}return{error:a,data:i,count:n,status:o,statusText:l}}));return this.shouldThrowOnError||(s=s.catch((e=>{var t,s,r;return{error:{message:`${null!==(t=null==e?void 0:e.name)&&void 0!==t?t:"FetchError"}: ${null==e?void 0:e.message}`,details:`${null!==(s=null==e?void 0:e.stack)&&void 0!==s?s:""}`,hint:"",code:`${null!==(r=null==e?void 0:e.code)&&void 0!==r?r:""}`},data:null,count:null,status:0,statusText:""}}))),s.then(e,t)}};var Ue=ee&&ee.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Te,"__esModule",{value:!0});const Ze=Ue(Ae);let Be=class extends Ze.default{select(e){let t=!1;const s=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!t?"":('"'===e&&(t=!t),e))).join("");return this.url.searchParams.set("select",s),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:t=!0,nullsFirst:s,foreignTable:r,referencedTable:a=r}={}){const i=a?`${a}.order`:"order",n=this.url.searchParams.get(i);return this.url.searchParams.set(i,`${n?`${n},`:""}${e}.${t?"asc":"desc"}${void 0===s?"":s?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:t,referencedTable:s=t}={}){const r=void 0===s?"limit":`${s}.limit`;return this.url.searchParams.set(r,`${e}`),this}range(e,t,{foreignTable:s,referencedTable:r=s}={}){const a=void 0===r?"offset":`${r}.offset`,i=void 0===r?"limit":`${r}.limit`;return this.url.searchParams.set(a,`${e}`),this.url.searchParams.set(i,""+(t-e+1)),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return"GET"===this.method?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:t=!1,settings:s=!1,buffers:r=!1,wal:a=!1,format:i="text"}={}){var n;const o=[e?"analyze":null,t?"verbose":null,s?"settings":null,r?"buffers":null,a?"wal":null].filter(Boolean).join("|"),l=null!==(n=this.headers.Accept)&&void 0!==n?n:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${i}; for="${l}"; options=${o};`,this}rollback(){var e;return(null!==(e=this.headers.Prefer)&&void 0!==e?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Te.default=Be;var Ge=ee&&ee.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Ce,"__esModule",{value:!0});const We=Ge(Te);let Je=class extends We.default{eq(e,t){return this.url.searchParams.append(e,`eq.${t}`),this}neq(e,t){return this.url.searchParams.append(e,`neq.${t}`),this}gt(e,t){return this.url.searchParams.append(e,`gt.${t}`),this}gte(e,t){return this.url.searchParams.append(e,`gte.${t}`),this}lt(e,t){return this.url.searchParams.append(e,`lt.${t}`),this}lte(e,t){return this.url.searchParams.append(e,`lte.${t}`),this}like(e,t){return this.url.searchParams.append(e,`like.${t}`),this}likeAllOf(e,t){return this.url.searchParams.append(e,`like(all).{${t.join(",")}}`),this}likeAnyOf(e,t){return this.url.searchParams.append(e,`like(any).{${t.join(",")}}`),this}ilike(e,t){return this.url.searchParams.append(e,`ilike.${t}`),this}ilikeAllOf(e,t){return this.url.searchParams.append(e,`ilike(all).{${t.join(",")}}`),this}ilikeAnyOf(e,t){return this.url.searchParams.append(e,`ilike(any).{${t.join(",")}}`),this}is(e,t){return this.url.searchParams.append(e,`is.${t}`),this}in(e,t){const s=Array.from(new Set(t)).map((e=>"string"==typeof e&&new RegExp("[,()]").test(e)?`"${e}"`:`${e}`)).join(",");return this.url.searchParams.append(e,`in.(${s})`),this}contains(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cs.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cs.{${t.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(t)}`),this}containedBy(e,t){return"string"==typeof t?this.url.searchParams.append(e,`cd.${t}`):Array.isArray(t)?this.url.searchParams.append(e,`cd.{${t.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(t)}`),this}rangeGt(e,t){return this.url.searchParams.append(e,`sr.${t}`),this}rangeGte(e,t){return this.url.searchParams.append(e,`nxl.${t}`),this}rangeLt(e,t){return this.url.searchParams.append(e,`sl.${t}`),this}rangeLte(e,t){return this.url.searchParams.append(e,`nxr.${t}`),this}rangeAdjacent(e,t){return this.url.searchParams.append(e,`adj.${t}`),this}overlaps(e,t){return"string"==typeof t?this.url.searchParams.append(e,`ov.${t}`):this.url.searchParams.append(e,`ov.{${t.join(",")}}`),this}textSearch(e,t,{config:s,type:r}={}){let a="";"plain"===r?a="pl":"phrase"===r?a="ph":"websearch"===r&&(a="w");const i=void 0===s?"":`(${s})`;return this.url.searchParams.append(e,`${a}fts${i}.${t}`),this}match(e){return Object.entries(e).forEach((([e,t])=>{this.url.searchParams.append(e,`eq.${t}`)})),this}not(e,t,s){return this.url.searchParams.append(e,`not.${t}.${s}`),this}or(e,{foreignTable:t,referencedTable:s=t}={}){const r=s?`${s}.or`:"or";return this.url.searchParams.append(r,`(${e})`),this}filter(e,t,s){return this.url.searchParams.append(e,`${t}.${s}`),this}};Ce.default=Je;var He=ee&&ee.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(Se,"__esModule",{value:!0});const Ke=He(Ce);Se.default=class{constructor(e,{headers:t={},schema:s,fetch:r}){this.url=e,this.headers=t,this.schema=s,this.fetch=r}select(e,{head:t=!1,count:s}={}){const r=t?"HEAD":"GET";let a=!1;const i=(null!=e?e:"*").split("").map((e=>/\s/.test(e)&&!a?"":('"'===e&&(a=!a),e))).join("");return this.url.searchParams.set("select",i),s&&(this.headers.Prefer=`count=${s}`),new Ke.default({method:r,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:t,defaultToNull:s=!0}={}){const r=[];if(this.headers.Prefer&&r.push(this.headers.Prefer),t&&r.push(`count=${t}`),s||r.push("missing=default"),this.headers.Prefer=r.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new Ke.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:t,ignoreDuplicates:s=!1,count:r,defaultToNull:a=!0}={}){const i=[`resolution=${s?"ignore":"merge"}-duplicates`];if(void 0!==t&&this.url.searchParams.set("on_conflict",t),this.headers.Prefer&&i.push(this.headers.Prefer),r&&i.push(`count=${r}`),a||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const t=e.reduce(((e,t)=>e.concat(Object.keys(t))),[]);if(t.length>0){const e=[...new Set(t)].map((e=>`"${e}"`));this.url.searchParams.set("columns",e.join(","))}}return new Ke.default({method:"POST",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:t}={}){const s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),t&&s.push(`count=${t}`),this.headers.Prefer=s.join(","),new Ke.default({method:"PATCH",url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const t=[];return e&&t.push(`count=${e}`),this.headers.Prefer&&t.unshift(this.headers.Prefer),this.headers.Prefer=t.join(","),new Ke.default({method:"DELETE",url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};var Ye={},Qe={};Object.defineProperty(Qe,"__esModule",{value:!0}),Qe.version=void 0,Qe.version="0.0.0-automated",Object.defineProperty(Ye,"__esModule",{value:!0}),Ye.DEFAULT_HEADERS=void 0;const Xe=Qe;Ye.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${Xe.version}`};var et=ee&&ee.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(ke,"__esModule",{value:!0});const tt=et(Se),st=et(Ce),rt=Ye;ke.default=class e{constructor(e,{headers:t={},schema:s,fetch:r}={}){this.url=e,this.headers=Object.assign(Object.assign({},rt.DEFAULT_HEADERS),t),this.schemaName=s,this.fetch=r}from(e){const t=new URL(`${this.url}/${e}`);return new tt.default(t,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(t){return new e(this.url,{headers:this.headers,schema:t,fetch:this.fetch})}rpc(e,t={},{head:s=!1,get:r=!1,count:a}={}){let i;const n=new URL(`${this.url}/rpc/${e}`);let o;s||r?(i=s?"HEAD":"GET",Object.entries(t).filter((([e,t])=>void 0!==t)).map((([e,t])=>[e,Array.isArray(t)?`{${t.join(",")}}`:`${t}`])).forEach((([e,t])=>{n.searchParams.append(e,t)}))):(i="POST",o=t);const l=Object.assign({},this.headers);return a&&(l.Prefer=`count=${a}`),new st.default({method:i,url:n,headers:l,schema:this.schemaName,body:o,fetch:this.fetch,allowEmpty:!1})}};var at=ee&&ee.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(_e,"__esModule",{value:!0}),_e.PostgrestError=_e.PostgrestBuilder=_e.PostgrestTransformBuilder=_e.PostgrestFilterBuilder=_e.PostgrestQueryBuilder=_e.PostgrestClient=void 0;const it=at(ke);_e.PostgrestClient=it.default;const nt=at(Se);_e.PostgrestQueryBuilder=nt.default;const ot=at(Ce);_e.PostgrestFilterBuilder=ot.default;const lt=at(Te);_e.PostgrestTransformBuilder=lt.default;const ct=at(Ae);_e.PostgrestBuilder=ct.default;const dt=at(qe);_e.PostgrestError=dt.default;var ut=_e.default={PostgrestClient:it.default,PostgrestQueryBuilder:nt.default,PostgrestFilterBuilder:ot.default,PostgrestTransformBuilder:lt.default,PostgrestBuilder:ct.default,PostgrestError:dt.default};const{PostgrestClient:ht,PostgrestQueryBuilder:mt,PostgrestFilterBuilder:pt,PostgrestTransformBuilder:xt,PostgrestBuilder:gt,PostgrestError:ft}=ut,vt={"X-Client-Info":"realtime-js/2.11.2"};var yt,jt,bt,wt,Nt,_t,kt,St,Ct,Tt,At;(jt=yt||(yt={}))[jt.connecting=0]="connecting",jt[jt.open=1]="open",jt[jt.closing=2]="closing",jt[jt.closed=3]="closed",(wt=bt||(bt={})).closed="closed",wt.errored="errored",wt.joined="joined",wt.joining="joining",wt.leaving="leaving",(_t=Nt||(Nt={})).close="phx_close",_t.error="phx_error",_t.join="phx_join",_t.reply="phx_reply",_t.leave="phx_leave",_t.access_token="access_token",(kt||(kt={})).websocket="websocket",(Ct=St||(St={})).Connecting="connecting",Ct.Open="open",Ct.Closing="closing",Ct.Closed="closed";class Pt{constructor(){this.HEADER_LENGTH=1}decode(e,t){return e.constructor===ArrayBuffer?t(this._binaryDecode(e)):t("string"==typeof e?JSON.parse(e):{})}_binaryDecode(e){const t=new DataView(e),s=new TextDecoder;return this._decodeBroadcast(e,t,s)}_decodeBroadcast(e,t,s){const r=t.getUint8(1),a=t.getUint8(2);let i=this.HEADER_LENGTH+2;const n=s.decode(e.slice(i,i+r));i+=r;const o=s.decode(e.slice(i,i+a));i+=a;return{ref:null,topic:n,event:o,payload:JSON.parse(s.decode(e.slice(i,e.byteLength)))}}}class Et{constructor(e,t){this.callback=e,this.timerCalc=t,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=t}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout((()=>{this.tries=this.tries+1,this.callback()}),this.timerCalc(this.tries+1))}}(At=Tt||(Tt={})).abstime="abstime",At.bool="bool",At.date="date",At.daterange="daterange",At.float4="float4",At.float8="float8",At.int2="int2",At.int4="int4",At.int4range="int4range",At.int8="int8",At.int8range="int8range",At.json="json",At.jsonb="jsonb",At.money="money",At.numeric="numeric",At.oid="oid",At.reltime="reltime",At.text="text",At.time="time",At.timestamp="timestamp",At.timestamptz="timestamptz",At.timetz="timetz",At.tsrange="tsrange",At.tstzrange="tstzrange";const Ot=(e,t,s={})=>{var r;const a=null!==(r=s.skipTypes)&&void 0!==r?r:[];return Object.keys(t).reduce(((s,r)=>(s[r]=$t(r,e,t,a),s)),{})},$t=(e,t,s,r)=>{const a=t.find((t=>t.name===e)),i=null==a?void 0:a.type,n=s[e];return i&&!r.includes(i)?Rt(i,n):Dt(n)},Rt=(e,t)=>{if("_"===e.charAt(0)){const s=e.slice(1,e.length);return Lt(t,s)}switch(e){case Tt.bool:return It(t);case Tt.float4:case Tt.float8:case Tt.int2:case Tt.int4:case Tt.int8:case Tt.numeric:case Tt.oid:return Mt(t);case Tt.json:case Tt.jsonb:return qt(t);case Tt.timestamp:return Ft(t);case Tt.abstime:case Tt.date:case Tt.daterange:case Tt.int4range:case Tt.int8range:case Tt.money:case Tt.reltime:case Tt.text:case Tt.time:case Tt.timestamptz:case Tt.timetz:case Tt.tsrange:case Tt.tstzrange:default:return Dt(t)}},Dt=e=>e,It=e=>{switch(e){case"t":return!0;case"f":return!1;default:return e}},Mt=e=>{if("string"==typeof e){const t=parseFloat(e);if(!Number.isNaN(t))return t}return e},qt=e=>{if("string"==typeof e)try{return JSON.parse(e)}catch(t){return e}return e},Lt=(e,t)=>{if("string"!=typeof e)return e;const s=e.length-1,r=e[s];if("{"===e[0]&&"}"===r){let r;const i=e.slice(1,s);try{r=JSON.parse("["+i+"]")}catch(a){r=i?i.split(","):[]}return r.map((e=>Rt(t,e)))}return e},Ft=e=>"string"==typeof e?e.replace(" ","T"):e,zt=e=>{let t=e;return t=t.replace(/^ws/i,"http"),t=t.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),t.replace(/\/+$/,"")};class Vt{constructor(e,t,s={},r=1e4){this.channel=e,this.event=t,this.payload=s,this.timeout=r,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,t){var s;return this._hasReceived(e)&&t(null===(s=this.receivedResp)||void 0===s?void 0:s.response),this.recHooks.push({status:e,callback:t}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);this.channel._on(this.refEvent,{},(e=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=e,this._matchReceive(e)})),this.timeoutTimer=setTimeout((()=>{this.trigger("timeout",{})}),this.timeout)}trigger(e,t){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:t})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:t}){this.recHooks.filter((t=>t.status===e)).forEach((e=>e.callback(t)))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Ut,Zt,Bt,Gt,Wt,Jt,Ht,Kt;(Zt=Ut||(Ut={})).SYNC="sync",Zt.JOIN="join",Zt.LEAVE="leave";class Yt{constructor(e,t){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const s=(null==t?void 0:t.events)||{state:"presence_state",diff:"presence_diff"};this.channel._on(s.state,{},(e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.joinRef=this.channel._joinRef(),this.state=Yt.syncState(this.state,e,t,s),this.pendingDiffs.forEach((e=>{this.state=Yt.syncDiff(this.state,e,t,s)})),this.pendingDiffs=[],r()})),this.channel._on(s.diff,{},(e=>{const{onJoin:t,onLeave:s,onSync:r}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(e):(this.state=Yt.syncDiff(this.state,e,t,s),r())})),this.onJoin(((e,t,s)=>{this.channel._trigger("presence",{event:"join",key:e,currentPresences:t,newPresences:s})})),this.onLeave(((e,t,s)=>{this.channel._trigger("presence",{event:"leave",key:e,currentPresences:t,leftPresences:s})})),this.onSync((()=>{this.channel._trigger("presence",{event:"sync"})}))}static syncState(e,t,s,r){const a=this.cloneDeep(e),i=this.transformState(t),n={},o={};return this.map(a,((e,t)=>{i[e]||(o[e]=t)})),this.map(i,((e,t)=>{const s=a[e];if(s){const r=t.map((e=>e.presence_ref)),a=s.map((e=>e.presence_ref)),i=t.filter((e=>a.indexOf(e.presence_ref)<0)),l=s.filter((e=>r.indexOf(e.presence_ref)<0));i.length>0&&(n[e]=i),l.length>0&&(o[e]=l)}else n[e]=t})),this.syncDiff(a,{joins:n,leaves:o},s,r)}static syncDiff(e,t,s,r){const{joins:a,leaves:i}={joins:this.transformState(t.joins),leaves:this.transformState(t.leaves)};return s||(s=()=>{}),r||(r=()=>{}),this.map(a,((t,r)=>{var a;const i=null!==(a=e[t])&&void 0!==a?a:[];if(e[t]=this.cloneDeep(r),i.length>0){const s=e[t].map((e=>e.presence_ref)),r=i.filter((e=>s.indexOf(e.presence_ref)<0));e[t].unshift(...r)}s(t,i,r)})),this.map(i,((t,s)=>{let a=e[t];if(!a)return;const i=s.map((e=>e.presence_ref));a=a.filter((e=>i.indexOf(e.presence_ref)<0)),e[t]=a,r(t,a,s),0===a.length&&delete e[t]})),e}static map(e,t){return Object.getOwnPropertyNames(e).map((s=>t(s,e[s])))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce(((t,s)=>{const r=e[s];return t[s]="metas"in r?r.metas.map((e=>(e.presence_ref=e.phx_ref,delete e.phx_ref,delete e.phx_ref_prev,e))):r,t}),{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}(Gt=Bt||(Bt={})).ALL="*",Gt.INSERT="INSERT",Gt.UPDATE="UPDATE",Gt.DELETE="DELETE",(Jt=Wt||(Wt={})).BROADCAST="broadcast",Jt.PRESENCE="presence",Jt.POSTGRES_CHANGES="postgres_changes",Jt.SYSTEM="system",(Kt=Ht||(Ht={})).SUBSCRIBED="SUBSCRIBED",Kt.TIMED_OUT="TIMED_OUT",Kt.CLOSED="CLOSED",Kt.CHANNEL_ERROR="CHANNEL_ERROR";class Qt{constructor(e,t={config:{}},s){this.topic=e,this.params=t,this.socket=s,this.bindings={},this.state=bt.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},t.config),this.timeout=this.socket.timeout,this.joinPush=new Vt(this,Nt.join,this.params,this.timeout),this.rejoinTimer=new Et((()=>this._rejoinUntilConnected()),this.socket.reconnectAfterMs),this.joinPush.receive("ok",(()=>{this.state=bt.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach((e=>e.send())),this.pushBuffer=[]})),this._onClose((()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=bt.closed,this.socket._remove(this)})),this._onError((e=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,e),this.state=bt.errored,this.rejoinTimer.scheduleTimeout())})),this.joinPush.receive("timeout",(()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=bt.errored,this.rejoinTimer.scheduleTimeout())})),this._on(Nt.reply,{},((e,t)=>{this._trigger(this._replyEventName(t),e)})),this.presence=new Yt(this),this.broadcastEndpointURL=zt(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,t=this.timeout){var s,r;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:a,presence:i,private:n}}=this.params;this._onError((t=>null==e?void 0:e(Ht.CHANNEL_ERROR,t))),this._onClose((()=>null==e?void 0:e(Ht.CLOSED)));const o={},l={broadcast:a,presence:i,postgres_changes:null!==(r=null===(s=this.bindings.postgres_changes)||void 0===s?void 0:s.map((e=>e.filter)))&&void 0!==r?r:[],private:n};this.socket.accessTokenValue&&(o.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},o)),this.joinedOnce=!0,this._rejoin(t),this.joinPush.receive("ok",(async({postgres_changes:t})=>{var s;if(this.socket.setAuth(),void 0!==t){const r=this.bindings.postgres_changes,a=null!==(s=null==r?void 0:r.length)&&void 0!==s?s:0,i=[];for(let s=0;s<a;s++){const a=r[s],{filter:{event:n,schema:o,table:l,filter:c}}=a,d=t&&t[s];if(!d||d.event!==n||d.schema!==o||d.table!==l||d.filter!==c)return this.unsubscribe(),void(null==e||e(Ht.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes")));i.push(Object.assign(Object.assign({},a),{id:d.id}))}return this.bindings.postgres_changes=i,void(e&&e(Ht.SUBSCRIBED))}null==e||e(Ht.SUBSCRIBED)})).receive("error",(t=>{null==e||e(Ht.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(t).join(", ")||"error")))})).receive("timeout",(()=>{null==e||e(Ht.TIMED_OUT)}))}return this}presenceState(){return this.presence.state}async track(e,t={}){return await this.send({type:"presence",event:"track",payload:e},t.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,t,s){return this._on(e,t,s)}async send(e,t={}){var s,r;if(this._canPush()||"broadcast"!==e.type)return new Promise((s=>{var r,a,i;const n=this._push(e.type,e,t.timeout||this.timeout);"broadcast"!==e.type||(null===(i=null===(a=null===(r=this.params)||void 0===r?void 0:r.config)||void 0===a?void 0:a.broadcast)||void 0===i?void 0:i.ack)||s("ok"),n.receive("ok",(()=>s("ok"))),n.receive("error",(()=>s("error"))),n.receive("timeout",(()=>s("timed out")))}));{const{event:i,payload:n}=e,o={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:n,private:this.private}]})};try{const e=await this._fetchWithTimeout(this.broadcastEndpointURL,o,null!==(s=t.timeout)&&void 0!==s?s:this.timeout);return await(null===(r=e.body)||void 0===r?void 0:r.cancel()),e.ok?"ok":"error"}catch(a){return"AbortError"===a.name?"timed out":"error"}}}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=bt.leaving;const t=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(Nt.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise((s=>{const r=new Vt(this,Nt.leave,{},e);r.receive("ok",(()=>{t(),s("ok")})).receive("timeout",(()=>{t(),s("timed out")})).receive("error",(()=>{s("error")})),r.send(),this._canPush()||r.trigger("ok",{})}))}async _fetchWithTimeout(e,t,s){const r=new AbortController,a=setTimeout((()=>r.abort()),s),i=await this.socket.fetch(e,Object.assign(Object.assign({},t),{signal:r.signal}));return clearTimeout(a),i}_push(e,t,s=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let r=new Vt(this,e,t,s);return this._canPush()?r.send():(r.startTimeout(),this.pushBuffer.push(r)),r}_onMessage(e,t,s){return t}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,t,s){var r,a;const i=e.toLocaleLowerCase(),{close:n,error:o,leave:l,join:c}=Nt;if(s&&[n,o,l,c].indexOf(i)>=0&&s!==this._joinRef())return;let d=this._onMessage(i,t,s);if(t&&!d)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(i)?null===(r=this.bindings.postgres_changes)||void 0===r||r.filter((e=>{var t,s,r;return"*"===(null===(t=e.filter)||void 0===t?void 0:t.event)||(null===(r=null===(s=e.filter)||void 0===s?void 0:s.event)||void 0===r?void 0:r.toLocaleLowerCase())===i})).map((e=>e.callback(d,s))):null===(a=this.bindings[i])||void 0===a||a.filter((e=>{var s,r,a,n,o,l;if(["broadcast","presence","postgres_changes"].includes(i)){if("id"in e){const i=e.id,n=null===(s=e.filter)||void 0===s?void 0:s.event;return i&&(null===(r=t.ids)||void 0===r?void 0:r.includes(i))&&("*"===n||(null==n?void 0:n.toLocaleLowerCase())===(null===(a=t.data)||void 0===a?void 0:a.type.toLocaleLowerCase()))}{const s=null===(o=null===(n=null==e?void 0:e.filter)||void 0===n?void 0:n.event)||void 0===o?void 0:o.toLocaleLowerCase();return"*"===s||s===(null===(l=null==t?void 0:t.event)||void 0===l?void 0:l.toLocaleLowerCase())}}return e.type.toLocaleLowerCase()===i})).map((e=>{if("object"==typeof d&&"ids"in d){const e=d.data,{schema:t,table:s,commit_timestamp:r,type:a,errors:i}=e,n={schema:t,table:s,commit_timestamp:r,eventType:a,new:{},old:{},errors:i};d=Object.assign(Object.assign({},n),this._getPayloadRecords(e))}e.callback(d,s)}))}_isClosed(){return this.state===bt.closed}_isJoined(){return this.state===bt.joined}_isJoining(){return this.state===bt.joining}_isLeaving(){return this.state===bt.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,t,s){const r=e.toLocaleLowerCase(),a={type:r,filter:t,callback:s};return this.bindings[r]?this.bindings[r].push(a):this.bindings[r]=[a],this}_off(e,t){const s=e.toLocaleLowerCase();return this.bindings[s]=this.bindings[s].filter((e=>{var r;return!((null===(r=e.type)||void 0===r?void 0:r.toLocaleLowerCase())===s&&Qt.isEqual(e.filter,t))})),this}static isEqual(e,t){if(Object.keys(e).length!==Object.keys(t).length)return!1;for(const s in e)if(e[s]!==t[s])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(Nt.close,{},e)}_onError(e){this._on(Nt.error,{},(t=>e(t)))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=bt.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const t={new:{},old:{}};return"INSERT"!==e.type&&"UPDATE"!==e.type||(t.new=Ot(e.columns,e.record)),"UPDATE"!==e.type&&"DELETE"!==e.type||(t.old=Ot(e.columns,e.old_record)),t}}const Xt=()=>{},es="undefined"!=typeof WebSocket;class ts{constructor(e,t){var s;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=vt,this.params={},this.timeout=1e4,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=Xt,this.conn=null,this.sendBuffer=[],this.serializer=new Pt,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>xe((async()=>{const{default:e}=await Promise.resolve().then((()=>Ie));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},this.endPoint=`${e}/${kt.websocket}`,this.httpEndpoint=zt(e),(null==t?void 0:t.transport)?this.transport=t.transport:this.transport=null,(null==t?void 0:t.params)&&(this.params=t.params),(null==t?void 0:t.headers)&&(this.headers=Object.assign(Object.assign({},this.headers),t.headers)),(null==t?void 0:t.timeout)&&(this.timeout=t.timeout),(null==t?void 0:t.logger)&&(this.logger=t.logger),(null==t?void 0:t.heartbeatIntervalMs)&&(this.heartbeatIntervalMs=t.heartbeatIntervalMs);const r=null===(s=null==t?void 0:t.params)||void 0===s?void 0:s.apikey;if(r&&(this.accessTokenValue=r,this.apiKey=r),this.reconnectAfterMs=(null==t?void 0:t.reconnectAfterMs)?t.reconnectAfterMs:e=>[1e3,2e3,5e3,1e4][e-1]||1e4,this.encode=(null==t?void 0:t.encode)?t.encode:(e,t)=>t(JSON.stringify(e)),this.decode=(null==t?void 0:t.decode)?t.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new Et((async()=>{this.disconnect(),this.connect()}),this.reconnectAfterMs),this.fetch=this._resolveFetch(null==t?void 0:t.fetch),null==t?void 0:t.worker){if("undefined"!=typeof window&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=(null==t?void 0:t.worker)||!1,this.workerUrl=null==t?void 0:t.workerUrl}this.accessToken=(null==t?void 0:t.accessToken)||null}connect(){if(!this.conn)if(this.transport)this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});else{if(es)return this.conn=new WebSocket(this.endpointURL()),void this.setupConnection();this.conn=new ss(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),xe((async()=>{const{default:e}=await import("./browser-DphJ6FDu.js").then((e=>e.b));return{default:e}}),__vite__mapDeps([0,1])).then((({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()}))}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:"1.0.0"}))}disconnect(e,t){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,null!=t?t:""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const t=await e.unsubscribe();return 0===this.channels.length&&this.disconnect(),t}async removeAllChannels(){const e=await Promise.all(this.channels.map((e=>e.unsubscribe())));return this.disconnect(),e}log(e,t,s){this.logger(e,t,s)}connectionState(){switch(this.conn&&this.conn.readyState){case yt.connecting:return St.Connecting;case yt.open:return St.Open;case yt.closing:return St.Closing;default:return St.Closed}}isConnected(){return this.connectionState()===St.Open}channel(e,t={config:{}}){const s=new Qt(`realtime:${e}`,t,this);return this.channels.push(s),s}push(e){const{topic:t,event:s,payload:r,ref:a}=e,i=()=>{this.encode(e,(e=>{var t;null===(t=this.conn)||void 0===t||t.send(e)}))};this.log("push",`${t} ${s} (${a})`,r),this.isConnected()?i():this.sendBuffer.push(i)}async setAuth(e=null){let t=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(t){let e=null;try{e=JSON.parse(atob(t.split(".")[1]))}catch(s){}if(e&&e.exp){if(!(Math.floor(Date.now()/1e3)-e.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${e.exp}`)}this.accessTokenValue=t,this.channels.forEach((e=>{t&&e.updateJoinPayload({access_token:t}),e.joinedOnce&&e._isJoined()&&e._push(Nt.access_token,{access_token:t})}))}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef)return this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),void(null===(e=this.conn)||void 0===e||e.close(1e3,"hearbeat timeout"));this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach((e=>e())),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let t=this.channels.find((t=>t.topic===e&&(t._isJoined()||t._isJoining())));t&&(this.log("transport",`leaving duplicate topic "${e}"`),t.unsubscribe())}_remove(e){this.channels=this.channels.filter((t=>t._joinRef()!==e._joinRef()))}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,(e=>{let{topic:t,event:s,payload:r,ref:a}=e;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${r.status||""} ${t} ${s} ${a&&"("+a+")"||""}`,r),this.channels.filter((e=>e._isMember(t))).forEach((e=>e._trigger(s,r,a))),this.stateChangeCallbacks.message.forEach((t=>t(e)))}))}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),this.worker){this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=e=>{this.log("worker","worker error",e.message),this.workerRef.terminate()},this.workerRef.onmessage=e=>{"keepAlive"===e.data.event&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}else this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval((()=>this.sendHeartbeat()),this.heartbeatIntervalMs);this.stateChangeCallbacks.open.forEach((e=>e()))}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach((t=>t(e)))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach((t=>t(e)))}_triggerChanError(){this.channels.forEach((e=>e._trigger(Nt.error)))}_appendParams(e,t){if(0===Object.keys(t).length)return e;const s=e.match(/\?/)?"&":"?";return`${e}${s}${new URLSearchParams(t)}`}_workerObjectUrl(e){let t;if(e)t=e;else{const e=new Blob(['\n  addEventListener("message", (e) => {\n    if (e.data.event === "start") {\n      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);\n    }\n  });'],{type:"application/javascript"});t=URL.createObjectURL(e)}return t}}class ss{constructor(e,t,s){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=yt.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=s.close}}class rs extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function as(e){return"object"==typeof e&&null!==e&&"__isStorageError"in e}class is extends rs{constructor(e,t){super(e),this.name="StorageApiError",this.status=t}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class ns extends rs{constructor(e,t){super(e),this.name="StorageUnknownError",this.originalError=t}}var os=function(e,t,s,r){return new(s||(s=Promise))((function(a,i){function n(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((r=r.apply(e,t||[])).next())}))};const ls=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>xe((async()=>{const{default:e}=await Promise.resolve().then((()=>Ie));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},cs=e=>{if(Array.isArray(e))return e.map((e=>cs(e)));if("function"==typeof e||e!==Object(e))return e;const t={};return Object.entries(e).forEach((([e,s])=>{const r=e.replace(/([-_][a-z])/gi,(e=>e.toUpperCase().replace(/[-_]/g,"")));t[r]=cs(s)})),t};var ds=function(e,t,s,r){return new(s||(s=Promise))((function(a,i){function n(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((r=r.apply(e,t||[])).next())}))};const us=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),hs=(e,t,s)=>ds(void 0,void 0,void 0,(function*(){const r=yield os(void 0,void 0,void 0,(function*(){return"undefined"==typeof Response?(yield xe((()=>Promise.resolve().then((()=>Ie))),void 0)).Response:Response}));e instanceof r&&!(null==s?void 0:s.noResolveJson)?e.json().then((s=>{t(new is(us(s),e.status||500))})).catch((e=>{t(new ns(us(e),e))})):t(new ns(us(e),e))}));function ms(e,t,s,r,a,i){return ds(this,void 0,void 0,(function*(){return new Promise(((n,o)=>{e(s,((e,t,s,r)=>{const a={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json"},null==t?void 0:t.headers),r&&(a.body=JSON.stringify(r)),Object.assign(Object.assign({},a),s))})(t,r,a,i)).then((e=>{if(!e.ok)throw e;return(null==r?void 0:r.noResolveJson)?e:e.json()})).then((e=>n(e))).catch((e=>hs(e,o,r)))}))}))}function ps(e,t,s,r){return ds(this,void 0,void 0,(function*(){return ms(e,"GET",t,s,r)}))}function xs(e,t,s,r,a){return ds(this,void 0,void 0,(function*(){return ms(e,"POST",t,r,a,s)}))}function gs(e,t,s,r,a){return ds(this,void 0,void 0,(function*(){return ms(e,"DELETE",t,r,a,s)}))}var fs=function(e,t,s,r){return new(s||(s=Promise))((function(a,i){function n(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((r=r.apply(e,t||[])).next())}))};const vs={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},ys={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class js{constructor(e,t={},s,r){this.url=e,this.headers=t,this.bucketId=s,this.fetch=ls(r)}uploadOrUpdate(e,t,s,r){return fs(this,void 0,void 0,(function*(){try{let a;const i=Object.assign(Object.assign({},ys),r);let n=Object.assign(Object.assign({},this.headers),"POST"===e&&{"x-upsert":String(i.upsert)});const o=i.metadata;"undefined"!=typeof Blob&&s instanceof Blob?(a=new FormData,a.append("cacheControl",i.cacheControl),o&&a.append("metadata",this.encodeMetadata(o)),a.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(a=s,a.append("cacheControl",i.cacheControl),o&&a.append("metadata",this.encodeMetadata(o))):(a=s,n["cache-control"]=`max-age=${i.cacheControl}`,n["content-type"]=i.contentType,o&&(n["x-metadata"]=this.toBase64(this.encodeMetadata(o)))),(null==r?void 0:r.headers)&&(n=Object.assign(Object.assign({},n),r.headers));const l=this._removeEmptyFolders(t),c=this._getFinalPath(l),d=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:a,headers:n},(null==i?void 0:i.duplex)?{duplex:i.duplex}:{})),u=yield d.json();if(d.ok)return{data:{path:l,id:u.Id,fullPath:u.Key},error:null};return{data:null,error:u}}catch(a){if(as(a))return{data:null,error:a};throw a}}))}upload(e,t,s){return fs(this,void 0,void 0,(function*(){return this.uploadOrUpdate("POST",e,t,s)}))}uploadToSignedUrl(e,t,s,r){return fs(this,void 0,void 0,(function*(){const a=this._removeEmptyFolders(e),i=this._getFinalPath(a),n=new URL(this.url+`/object/upload/sign/${i}`);n.searchParams.set("token",t);try{let e;const t=Object.assign({upsert:ys.upsert},r),i=Object.assign(Object.assign({},this.headers),{"x-upsert":String(t.upsert)});"undefined"!=typeof Blob&&s instanceof Blob?(e=new FormData,e.append("cacheControl",t.cacheControl),e.append("",s)):"undefined"!=typeof FormData&&s instanceof FormData?(e=s,e.append("cacheControl",t.cacheControl)):(e=s,i["cache-control"]=`max-age=${t.cacheControl}`,i["content-type"]=t.contentType);const o=yield this.fetch(n.toString(),{method:"PUT",body:e,headers:i}),l=yield o.json();if(o.ok)return{data:{path:a,fullPath:l.Key},error:null};return{data:null,error:l}}catch(o){if(as(o))return{data:null,error:o};throw o}}))}createSignedUploadUrl(e,t){return fs(this,void 0,void 0,(function*(){try{let s=this._getFinalPath(e);const r=Object.assign({},this.headers);(null==t?void 0:t.upsert)&&(r["x-upsert"]="true");const a=yield xs(this.fetch,`${this.url}/object/upload/sign/${s}`,{},{headers:r}),i=new URL(this.url+a.url),n=i.searchParams.get("token");if(!n)throw new rs("No token returned by API");return{data:{signedUrl:i.toString(),path:e,token:n},error:null}}catch(s){if(as(s))return{data:null,error:s};throw s}}))}update(e,t,s){return fs(this,void 0,void 0,(function*(){return this.uploadOrUpdate("PUT",e,t,s)}))}move(e,t,s){return fs(this,void 0,void 0,(function*(){try{return{data:yield xs(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers}),error:null}}catch(r){if(as(r))return{data:null,error:r};throw r}}))}copy(e,t,s){return fs(this,void 0,void 0,(function*(){try{return{data:{path:(yield xs(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:t,destinationBucket:null==s?void 0:s.destinationBucket},{headers:this.headers})).Key},error:null}}catch(r){if(as(r))return{data:null,error:r};throw r}}))}createSignedUrl(e,t,s){return fs(this,void 0,void 0,(function*(){try{let r=this._getFinalPath(e),a=yield xs(this.fetch,`${this.url}/object/sign/${r}`,Object.assign({expiresIn:t},(null==s?void 0:s.transform)?{transform:s.transform}:{}),{headers:this.headers});const i=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return a={signedUrl:encodeURI(`${this.url}${a.signedURL}${i}`)},{data:a,error:null}}catch(r){if(as(r))return{data:null,error:r};throw r}}))}createSignedUrls(e,t,s){return fs(this,void 0,void 0,(function*(){try{const r=yield xs(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:t,paths:e},{headers:this.headers}),a=(null==s?void 0:s.download)?`&download=${!0===s.download?"":s.download}`:"";return{data:r.map((e=>Object.assign(Object.assign({},e),{signedUrl:e.signedURL?encodeURI(`${this.url}${e.signedURL}${a}`):null}))),error:null}}catch(r){if(as(r))return{data:null,error:r};throw r}}))}download(e,t){return fs(this,void 0,void 0,(function*(){const s=void 0!==(null==t?void 0:t.transform)?"render/image/authenticated":"object",r=this.transformOptsToQueryString((null==t?void 0:t.transform)||{}),a=r?`?${r}`:"";try{const t=this._getFinalPath(e),r=yield ps(this.fetch,`${this.url}/${s}/${t}${a}`,{headers:this.headers,noResolveJson:!0});return{data:yield r.blob(),error:null}}catch(i){if(as(i))return{data:null,error:i};throw i}}))}info(e){return fs(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{const e=yield ps(this.fetch,`${this.url}/object/info/${t}`,{headers:this.headers});return{data:cs(e),error:null}}catch(s){if(as(s))return{data:null,error:s};throw s}}))}exists(e){return fs(this,void 0,void 0,(function*(){const t=this._getFinalPath(e);try{return yield function(e,t,s,r){return ds(this,void 0,void 0,(function*(){return ms(e,"HEAD",t,Object.assign(Object.assign({},s),{noResolveJson:!0}),r)}))}(this.fetch,`${this.url}/object/${t}`,{headers:this.headers}),{data:!0,error:null}}catch(s){if(as(s)&&s instanceof ns){const e=s.originalError;if([400,404].includes(null==e?void 0:e.status))return{data:!1,error:s}}throw s}}))}getPublicUrl(e,t){const s=this._getFinalPath(e),r=[],a=(null==t?void 0:t.download)?`download=${!0===t.download?"":t.download}`:"";""!==a&&r.push(a);const i=void 0!==(null==t?void 0:t.transform)?"render/image":"object",n=this.transformOptsToQueryString((null==t?void 0:t.transform)||{});""!==n&&r.push(n);let o=r.join("&");return""!==o&&(o=`?${o}`),{data:{publicUrl:encodeURI(`${this.url}/${i}/public/${s}${o}`)}}}remove(e){return fs(this,void 0,void 0,(function*(){try{return{data:yield gs(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(t){if(as(t))return{data:null,error:t};throw t}}))}list(e,t,s){return fs(this,void 0,void 0,(function*(){try{const r=Object.assign(Object.assign(Object.assign({},vs),t),{prefix:e||""});return{data:yield xs(this.fetch,`${this.url}/object/list/${this.bucketId}`,r,{headers:this.headers},s),error:null}}catch(r){if(as(r))return{data:null,error:r};throw r}}))}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return"undefined"!=typeof Buffer?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const t=[];return e.width&&t.push(`width=${e.width}`),e.height&&t.push(`height=${e.height}`),e.resize&&t.push(`resize=${e.resize}`),e.format&&t.push(`format=${e.format}`),e.quality&&t.push(`quality=${e.quality}`),t.join("&")}}const bs={"X-Client-Info":"storage-js/2.7.1"};var ws=function(e,t,s,r){return new(s||(s=Promise))((function(a,i){function n(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((r=r.apply(e,t||[])).next())}))};class Ns{constructor(e,t={},s){this.url=e,this.headers=Object.assign(Object.assign({},bs),t),this.fetch=ls(s)}listBuckets(){return ws(this,void 0,void 0,(function*(){try{return{data:yield ps(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(as(e))return{data:null,error:e};throw e}}))}getBucket(e){return ws(this,void 0,void 0,(function*(){try{return{data:yield ps(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(t){if(as(t))return{data:null,error:t};throw t}}))}createBucket(e,t={public:!1}){return ws(this,void 0,void 0,(function*(){try{return{data:yield xs(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers}),error:null}}catch(s){if(as(s))return{data:null,error:s};throw s}}))}updateBucket(e,t){return ws(this,void 0,void 0,(function*(){try{const s=yield function(e,t,s,r,a){return ds(this,void 0,void 0,(function*(){return ms(e,"PUT",t,r,a,s)}))}(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:t.public,file_size_limit:t.fileSizeLimit,allowed_mime_types:t.allowedMimeTypes},{headers:this.headers});return{data:s,error:null}}catch(s){if(as(s))return{data:null,error:s};throw s}}))}emptyBucket(e){return ws(this,void 0,void 0,(function*(){try{return{data:yield xs(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(t){if(as(t))return{data:null,error:t};throw t}}))}deleteBucket(e){return ws(this,void 0,void 0,(function*(){try{return{data:yield gs(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(t){if(as(t))return{data:null,error:t};throw t}}))}}class _s extends Ns{constructor(e,t={},s){super(e,t,s)}from(e){return new js(this.url,this.headers,e,this.fetch)}}let ks="";ks="undefined"!=typeof Deno?"deno":"undefined"!=typeof document?"web":"undefined"!=typeof navigator&&"ReactNative"===navigator.product?"react-native":"node";const Ss={headers:{"X-Client-Info":`supabase-js-${ks}/2.48.1`}},Cs={schema:"public"},Ts={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},As={};var Ps=function(e,t,s,r){return new(s||(s=Promise))((function(a,i){function n(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((r=r.apply(e,t||[])).next())}))};const Es=(e,t,s)=>{const r=(e=>{let t;return t=e||("undefined"==typeof fetch?Oe:fetch),(...e)=>t(...e)})(s),a="undefined"==typeof Headers?$e:Headers;return(s,i)=>Ps(void 0,void 0,void 0,(function*(){var n;const o=null!==(n=yield t())&&void 0!==n?n:e;let l=new a(null==i?void 0:i.headers);return l.has("apikey")||l.set("apikey",e),l.has("Authorization")||l.set("Authorization",`Bearer ${o}`),r(s,Object.assign(Object.assign({},i),{headers:l}))}))};var Os=function(e,t,s,r){return new(s||(s=Promise))((function(a,i){function n(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((r=r.apply(e,t||[])).next())}))};const $s="2.67.3",Rs={"X-Client-Info":`gotrue-js/${$s}`},Ds="X-Supabase-Api-Version",Is={timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"};const Ms=()=>"undefined"!=typeof window&&"undefined"!=typeof document,qs={tested:!1,writable:!1},Ls=()=>{if(!Ms())return!1;try{if("object"!=typeof globalThis.localStorage)return!1}catch(t){return!1}if(qs.tested)return qs.writable;const e=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(e,e),globalThis.localStorage.removeItem(e),qs.tested=!0,qs.writable=!0}catch(t){qs.tested=!0,qs.writable=!1}return qs.writable};const Fs=e=>{let t;return t=e||("undefined"==typeof fetch?(...e)=>xe((async()=>{const{default:e}=await Promise.resolve().then((()=>Ie));return{default:e}}),void 0).then((({default:t})=>t(...e))):fetch),(...e)=>t(...e)},zs=async(e,t,s)=>{await e.setItem(t,JSON.stringify(s))},Vs=async(e,t)=>{const s=await e.getItem(t);if(!s)return null;try{return JSON.parse(s)}catch(r){return s}},Us=async(e,t)=>{await e.removeItem(t)};class Zs{constructor(){this.promise=new Zs.promiseConstructor(((e,t)=>{this.resolve=e,this.reject=t}))}}function Bs(e){const t=e.split(".");if(3!==t.length)throw new Error("JWT is not valid: not a JWT structure");if(!/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i.test(t[1]))throw new Error("JWT is not valid: payload is not in base64url format");const s=t[1];return JSON.parse(function(e){const t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let s,r,a,i,n,o,l,c="",d=0;for(e=e.replace("-","+").replace("_","/");d<e.length;)i=t.indexOf(e.charAt(d++)),n=t.indexOf(e.charAt(d++)),o=t.indexOf(e.charAt(d++)),l=t.indexOf(e.charAt(d++)),s=i<<2|n>>4,r=(15&n)<<4|o>>2,a=(3&o)<<6|l,c+=String.fromCharCode(s),64!=o&&0!=r&&(c+=String.fromCharCode(r)),64!=l&&0!=a&&(c+=String.fromCharCode(a));return c}(s))}function Gs(e){return("0"+e.toString(16)).substr(-2)}async function Ws(e){if(!("undefined"!=typeof crypto&&void 0!==crypto.subtle&&"undefined"!=typeof TextEncoder))return e;const t=await async function(e){const t=(new TextEncoder).encode(e),s=await crypto.subtle.digest("SHA-256",t),r=new Uint8Array(s);return Array.from(r).map((e=>String.fromCharCode(e))).join("")}(e);return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function Js(e,t,s=!1){const r=function(){const e=new Uint32Array(56);if("undefined"==typeof crypto){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",t=e.length;let s="";for(let r=0;r<56;r++)s+=e.charAt(Math.floor(Math.random()*t));return s}return crypto.getRandomValues(e),Array.from(e,Gs).join("")}();let a=r;s&&(a+="/PASSWORD_RECOVERY"),await zs(e,`${t}-code-verifier`,a);const i=await Ws(r);return[i,r===i?"plain":"s256"]}Zs.promiseConstructor=Promise;const Hs=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;class Ks extends Error{constructor(e,t,s){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=t,this.code=s}}function Ys(e){return"object"==typeof e&&null!==e&&"__isAuthError"in e}class Qs extends Ks{constructor(e,t,s){super(e,t,s),this.name="AuthApiError",this.status=t,this.code=s}}class Xs extends Ks{constructor(e,t){super(e),this.name="AuthUnknownError",this.originalError=t}}class er extends Ks{constructor(e,t,s,r){super(e,s,r),this.name=t,this.status=s}}class tr extends er{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}class sr extends er{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class rr extends er{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ar extends er{constructor(e,t=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class ir extends er{constructor(e,t=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=t}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class nr extends er{constructor(e,t){super(e,"AuthRetryableFetchError",t,void 0)}}function or(e){return Ys(e)&&"AuthRetryableFetchError"===e.name}class lr extends er{constructor(e,t,s){super(e,"AuthWeakPasswordError",t,"weak_password"),this.reasons=s}}const cr=e=>e.msg||e.message||e.error_description||e.error||JSON.stringify(e),dr=[502,503,504];async function ur(e){var t,s;if(!("object"==typeof(s=e)&&null!==s&&"status"in s&&"ok"in s&&"json"in s&&"function"==typeof s.json))throw new nr(cr(e),0);if(dr.includes(e.status))throw new nr(cr(e),e.status);let r,a;try{r=await e.json()}catch(n){throw new Xs(cr(n),n)}const i=function(e){const t=e.headers.get(Ds);if(!t)return null;if(!t.match(Hs))return null;try{return new Date(`${t}T00:00:00.0Z`)}catch(n){return null}}(e);if(i&&i.getTime()>=Is.timestamp&&"object"==typeof r&&r&&"string"==typeof r.code?a=r.code:"object"==typeof r&&r&&"string"==typeof r.error_code&&(a=r.error_code),a){if("weak_password"===a)throw new lr(cr(r),e.status,(null===(t=r.weak_password)||void 0===t?void 0:t.reasons)||[]);if("session_not_found"===a)throw new tr}else if("object"==typeof r&&r&&"object"==typeof r.weak_password&&r.weak_password&&Array.isArray(r.weak_password.reasons)&&r.weak_password.reasons.length&&r.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0))throw new lr(cr(r),e.status,r.weak_password.reasons);throw new Qs(cr(r),e.status||500,a)}async function hr(e,t,s,r){var a;const i=Object.assign({},null==r?void 0:r.headers);i[Ds]||(i[Ds]=Is.name),(null==r?void 0:r.jwt)&&(i.Authorization=`Bearer ${r.jwt}`);const n=null!==(a=null==r?void 0:r.query)&&void 0!==a?a:{};(null==r?void 0:r.redirectTo)&&(n.redirect_to=r.redirectTo);const o=Object.keys(n).length?"?"+new URLSearchParams(n).toString():"",l=await async function(e,t,s,r,a,i){const n=((e,t,s,r)=>{const a={method:e,headers:(null==t?void 0:t.headers)||{}};return"GET"===e?a:(a.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},null==t?void 0:t.headers),a.body=JSON.stringify(r),Object.assign(Object.assign({},a),s))})(t,r,a,i);let o;try{o=await e(s,Object.assign({},n))}catch(l){throw new nr(cr(l),0)}o.ok||await ur(o);if(null==r?void 0:r.noResolveJson)return o;try{return await o.json()}catch(l){await ur(l)}}(e,t,s+o,{headers:i,noResolveJson:null==r?void 0:r.noResolveJson},{},null==r?void 0:r.body);return(null==r?void 0:r.xform)?null==r?void 0:r.xform(l):{data:Object.assign({},l),error:null}}function mr(e){var t;let s=null;var r;(function(e){return e.access_token&&e.refresh_token&&e.expires_in})(e)&&(s=Object.assign({},e),e.expires_at||(s.expires_at=(r=e.expires_in,Math.round(Date.now()/1e3)+r)));return{data:{session:s,user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function pr(e){const t=mr(e);return!t.error&&e.weak_password&&"object"==typeof e.weak_password&&Array.isArray(e.weak_password.reasons)&&e.weak_password.reasons.length&&e.weak_password.message&&"string"==typeof e.weak_password.message&&e.weak_password.reasons.reduce(((e,t)=>e&&"string"==typeof t),!0)&&(t.data.weak_password=e.weak_password),t}function xr(e){var t;return{data:{user:null!==(t=e.user)&&void 0!==t?t:e},error:null}}function gr(e){return{data:e,error:null}}function fr(e){const{action_link:t,email_otp:s,hashed_token:r,redirect_to:a,verification_type:i}=e,n=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(s[r[a]]=e[r[a]])}return s}(e,["action_link","email_otp","hashed_token","redirect_to","verification_type"]);return{data:{properties:{action_link:t,email_otp:s,hashed_token:r,redirect_to:a,verification_type:i},user:Object.assign({},n)},error:null}}function vr(e){return e}class yr{constructor({url:e="",headers:t={},fetch:s}){this.url=e,this.headers=t,this.fetch=Fs(s),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,t="global"){try{return await hr(this.fetch,"POST",`${this.url}/logout?scope=${t}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(s){if(Ys(s))return{data:null,error:s};throw s}}async inviteUserByEmail(e,t={}){try{return await hr(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:t.data},headers:this.headers,redirectTo:t.redirectTo,xform:xr})}catch(s){if(Ys(s))return{data:{user:null},error:s};throw s}}async generateLink(e){try{const{options:t}=e,s=function(e,t){var s={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(s[r]=e[r]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var a=0;for(r=Object.getOwnPropertySymbols(e);a<r.length;a++)t.indexOf(r[a])<0&&Object.prototype.propertyIsEnumerable.call(e,r[a])&&(s[r[a]]=e[r[a]])}return s}(e,["options"]),r=Object.assign(Object.assign({},s),t);return"newEmail"in s&&(r.new_email=null==s?void 0:s.newEmail,delete r.newEmail),await hr(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:r,headers:this.headers,xform:fr,redirectTo:null==t?void 0:t.redirectTo})}catch(t){if(Ys(t))return{data:{properties:null,user:null},error:t};throw t}}async createUser(e){try{return await hr(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:xr})}catch(t){if(Ys(t))return{data:{user:null},error:t};throw t}}async listUsers(e){var t,s,r,a,i,n,o;try{const l={nextPage:null,lastPage:0,total:0},c=await hr(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:null!==(s=null===(t=null==e?void 0:e.page)||void 0===t?void 0:t.toString())&&void 0!==s?s:"",per_page:null!==(a=null===(r=null==e?void 0:e.perPage)||void 0===r?void 0:r.toString())&&void 0!==a?a:""},xform:vr});if(c.error)throw c.error;const d=await c.json(),u=null!==(i=c.headers.get("x-total-count"))&&void 0!==i?i:0,h=null!==(o=null===(n=c.headers.get("link"))||void 0===n?void 0:n.split(","))&&void 0!==o?o:[];return h.length>0&&(h.forEach((e=>{const t=parseInt(e.split(";")[0].split("=")[1].substring(0,1)),s=JSON.parse(e.split(";")[1].split("=")[1]);l[`${s}Page`]=t})),l.total=parseInt(u)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(Ys(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){try{return await hr(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:xr})}catch(t){if(Ys(t))return{data:{user:null},error:t};throw t}}async updateUserById(e,t){try{return await hr(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:t,headers:this.headers,xform:xr})}catch(s){if(Ys(s))return{data:{user:null},error:s};throw s}}async deleteUser(e,t=!1){try{return await hr(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:t},xform:xr})}catch(s){if(Ys(s))return{data:{user:null},error:s};throw s}}async _listFactors(e){try{const{data:t,error:s}=await hr(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:e=>({data:{factors:e},error:null})});return{data:t,error:s}}catch(t){if(Ys(t))return{data:null,error:t};throw t}}async _deleteFactor(e){try{return{data:await hr(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(t){if(Ys(t))return{data:null,error:t};throw t}}}const jr={getItem:e=>Ls()?globalThis.localStorage.getItem(e):null,setItem:(e,t)=>{Ls()&&globalThis.localStorage.setItem(e,t)},removeItem:e=>{Ls()&&globalThis.localStorage.removeItem(e)}};function br(e={}){return{getItem:t=>e[t]||null,setItem:(t,s)=>{e[t]=s},removeItem:t=>{delete e[t]}}}const wr=!!(globalThis&&Ls()&&globalThis.localStorage&&"true"===globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug"));class Nr extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class _r extends Nr{}async function kr(e,t,s){const r=new globalThis.AbortController;return t>0&&setTimeout((()=>{r.abort()}),t),await Promise.resolve().then((()=>globalThis.navigator.locks.request(e,0===t?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},(async r=>{if(!r){if(0===t)throw new _r(`Acquiring an exclusive Navigator LockManager lock "${e}" immediately failed`);if(wr)try{await globalThis.navigator.locks.query()}catch(a){}return await s()}try{return await s()}finally{}}))))}!function(){if("object"!=typeof globalThis)try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch(e){"undefined"!=typeof self&&(self.globalThis=self)}}();const Sr={url:"http://localhost:9999",storageKey:"supabase.auth.token",autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:Rs,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},Cr=3e4;async function Tr(e,t,s){return await s()}class Ar{constructor(e){var t,s;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Ar.nextInstanceID,Ar.nextInstanceID+=1,this.instanceID>0&&Ms();const r=Object.assign(Object.assign({},Sr),e);if(this.logDebugMessages=!!r.debug,"function"==typeof r.debug&&(this.logger=r.debug),this.persistSession=r.persistSession,this.storageKey=r.storageKey,this.autoRefreshToken=r.autoRefreshToken,this.admin=new yr({url:r.url,headers:r.headers,fetch:r.fetch}),this.url=r.url,this.headers=r.headers,this.fetch=Fs(r.fetch),this.lock=r.lock||Tr,this.detectSessionInUrl=r.detectSessionInUrl,this.flowType=r.flowType,this.hasCustomAuthorizationHeader=r.hasCustomAuthorizationHeader,r.lock?this.lock=r.lock:Ms()&&(null===(t=null===globalThis||void 0===globalThis?void 0:globalThis.navigator)||void 0===t?void 0:t.locks)?this.lock=kr:this.lock=Tr,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?r.storage?this.storage=r.storage:Ls()?this.storage=jr:(this.memoryStorage={},this.storage=br(this.memoryStorage)):(this.memoryStorage={},this.storage=br(this.memoryStorage)),Ms()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(a){}null===(s=this.broadcastChannel)||void 0===s||s.addEventListener("message",(async e=>{this._debug("received broadcast notification from other tab or client",e),await this._notifyAllSubscribers(e.data.event,e.data.session,!1)}))}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${$s}) ${(new Date).toISOString()}`,...e),this}async initialize(){return this.initializePromise||(this.initializePromise=(async()=>await this._acquireLock(-1,(async()=>await this._initialize())))()),await this.initializePromise}async _initialize(){var e;try{const t=function(e){const t={},s=new URL(e);if(s.hash&&"#"===s.hash[0])try{new URLSearchParams(s.hash.substring(1)).forEach(((e,s)=>{t[s]=e}))}catch(r){}return s.searchParams.forEach(((e,s)=>{t[s]=e})),t}(window.location.href);let s="none";if(this._isImplicitGrantCallback(t)?s="implicit":await this._isPKCECallback(t)&&(s="pkce"),Ms()&&this.detectSessionInUrl&&"none"!==s){const{data:r,error:a}=await this._getSessionFromURL(t,s);if(a){if(this._debug("#_initialize()","error detecting session from URL",a),function(e){return Ys(e)&&"AuthImplicitGrantRedirectError"===e.name}(a)){const t=null===(e=a.details)||void 0===e?void 0:e.code;if("identity_already_exists"===t||"identity_not_found"===t||"single_identity_not_deletable"===t)return{error:a}}return await this._removeSession(),{error:a}}const{session:i,redirectType:n}=r;return this._debug("#_initialize()","detected session in URL",i,"redirect type",n),await this._saveSession(i),setTimeout((async()=>{"recovery"===n?await this._notifyAllSubscribers("PASSWORD_RECOVERY",i):await this._notifyAllSubscribers("SIGNED_IN",i)}),0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(t){return Ys(t)?{error:t}:{error:new Xs("Unexpected error during initialization",t)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var t,s,r;try{const a=await hr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:null!==(s=null===(t=null==e?void 0:e.options)||void 0===t?void 0:t.data)&&void 0!==s?s:{},gotrue_meta_security:{captcha_token:null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken}},xform:mr}),{data:i,error:n}=a;if(n||!i)return{data:{user:null,session:null},error:n};const o=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(a){if(Ys(a))return{data:{user:null,session:null},error:a};throw a}}async signUp(e){var t,s,r;try{let a;if("email"in e){const{email:s,password:r,options:i}=e;let n=null,o=null;"pkce"===this.flowType&&([n,o]=await Js(this.storage,this.storageKey)),a=await hr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:null==i?void 0:i.emailRedirectTo,body:{email:s,password:r,data:null!==(t=null==i?void 0:i.data)&&void 0!==t?t:{},gotrue_meta_security:{captcha_token:null==i?void 0:i.captchaToken},code_challenge:n,code_challenge_method:o},xform:mr})}else{if(!("phone"in e))throw new rr("You must provide either an email or phone number and a password");{const{phone:t,password:i,options:n}=e;a=await hr(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:t,password:i,data:null!==(s=null==n?void 0:n.data)&&void 0!==s?s:{},channel:null!==(r=null==n?void 0:n.channel)&&void 0!==r?r:"sms",gotrue_meta_security:{captcha_token:null==n?void 0:n.captchaToken}},xform:mr})}}const{data:i,error:n}=a;if(n||!i)return{data:{user:null,session:null},error:n};const o=i.session,l=i.user;return i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(a){if(Ys(a))return{data:{user:null,session:null},error:a};throw a}}async signInWithPassword(e){try{let t;if("email"in e){const{email:s,password:r,options:a}=e;t=await hr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:s,password:r,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:pr})}else{if(!("phone"in e))throw new rr("You must provide either an email or phone number and a password");{const{phone:s,password:r,options:a}=e;t=await hr(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:s,password:r,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},xform:pr})}}const{data:s,error:r}=t;return r?{data:{user:null,session:null},error:r}:s&&s.session&&s.user?(s.session&&(await this._saveSession(s.session),await this._notifyAllSubscribers("SIGNED_IN",s.session)),{data:Object.assign({user:s.user,session:s.session},s.weak_password?{weakPassword:s.weak_password}:null),error:r}):{data:{user:null,session:null},error:new sr}}catch(t){if(Ys(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOAuth(e){var t,s,r,a;return await this._handleProviderSignIn(e.provider,{redirectTo:null===(t=e.options)||void 0===t?void 0:t.redirectTo,scopes:null===(s=e.options)||void 0===s?void 0:s.scopes,queryParams:null===(r=e.options)||void 0===r?void 0:r.queryParams,skipBrowserRedirect:null===(a=e.options)||void 0===a?void 0:a.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,(async()=>this._exchangeCodeForSession(e)))}async _exchangeCodeForSession(e){const t=await Vs(this.storage,`${this.storageKey}-code-verifier`),[s,r]=(null!=t?t:"").split("/");try{const{data:t,error:a}=await hr(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:s},xform:mr});if(await Us(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return t&&t.session&&t.user?(t.session&&(await this._saveSession(t.session),await this._notifyAllSubscribers("SIGNED_IN",t.session)),{data:Object.assign(Object.assign({},t),{redirectType:null!=r?r:null}),error:a}):{data:{user:null,session:null,redirectType:null},error:new sr}}catch(a){if(Ys(a))return{data:{user:null,session:null,redirectType:null},error:a};throw a}}async signInWithIdToken(e){try{const{options:t,provider:s,token:r,access_token:a,nonce:i}=e,n=await hr(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:s,id_token:r,access_token:a,nonce:i,gotrue_meta_security:{captcha_token:null==t?void 0:t.captchaToken}},xform:mr}),{data:o,error:l}=n;return l?{data:{user:null,session:null},error:l}:o&&o.session&&o.user?(o.session&&(await this._saveSession(o.session),await this._notifyAllSubscribers("SIGNED_IN",o.session)),{data:o,error:l}):{data:{user:null,session:null},error:new sr}}catch(t){if(Ys(t))return{data:{user:null,session:null},error:t};throw t}}async signInWithOtp(e){var t,s,r,a,i;try{if("email"in e){const{email:r,options:a}=e;let i=null,n=null;"pkce"===this.flowType&&([i,n]=await Js(this.storage,this.storageKey));const{error:o}=await hr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:r,data:null!==(t=null==a?void 0:a.data)&&void 0!==t?t:{},create_user:null===(s=null==a?void 0:a.shouldCreateUser)||void 0===s||s,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken},code_challenge:i,code_challenge_method:n},redirectTo:null==a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:o}}if("phone"in e){const{phone:t,options:s}=e,{data:n,error:o}=await hr(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:t,data:null!==(r=null==s?void 0:s.data)&&void 0!==r?r:{},create_user:null===(a=null==s?void 0:s.shouldCreateUser)||void 0===a||a,gotrue_meta_security:{captcha_token:null==s?void 0:s.captchaToken},channel:null!==(i=null==s?void 0:s.channel)&&void 0!==i?i:"sms"}});return{data:{user:null,session:null,messageId:null==n?void 0:n.message_id},error:o}}throw new rr("You must provide either an email or phone number.")}catch(n){if(Ys(n))return{data:{user:null,session:null},error:n};throw n}}async verifyOtp(e){var t,s;try{let r,a;"options"in e&&(r=null===(t=e.options)||void 0===t?void 0:t.redirectTo,a=null===(s=e.options)||void 0===s?void 0:s.captchaToken);const{data:i,error:n}=await hr(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:a}}),redirectTo:r,xform:mr});if(n)throw n;if(!i)throw new Error("An error occurred on token verification.");const o=i.session,l=i.user;return(null==o?void 0:o.access_token)&&(await this._saveSession(o),await this._notifyAllSubscribers("recovery"==e.type?"PASSWORD_RECOVERY":"SIGNED_IN",o)),{data:{user:l,session:o},error:null}}catch(r){if(Ys(r))return{data:{user:null,session:null},error:r};throw r}}async signInWithSSO(e){var t,s,r;try{let a=null,i=null;return"pkce"===this.flowType&&([a,i]=await Js(this.storage,this.storageKey)),await hr(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:null!==(s=null===(t=e.options)||void 0===t?void 0:t.redirectTo)&&void 0!==s?s:void 0}),(null===(r=null==e?void 0:e.options)||void 0===r?void 0:r.captchaToken)?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:a,code_challenge_method:i}),headers:this.headers,xform:gr})}catch(a){if(Ys(a))return{data:null,error:a};throw a}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._reauthenticate()))}async _reauthenticate(){try{return await this._useSession((async e=>{const{data:{session:t},error:s}=e;if(s)throw s;if(!t)throw new tr;const{error:r}=await hr(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:t.access_token});return{data:{user:null,session:null},error:r}}))}catch(e){if(Ys(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const t=`${this.url}/resend`;if("email"in e){const{email:s,type:r,options:a}=e,{error:i}=await hr(this.fetch,"POST",t,{headers:this.headers,body:{email:s,type:r,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}},redirectTo:null==a?void 0:a.emailRedirectTo});return{data:{user:null,session:null},error:i}}if("phone"in e){const{phone:s,type:r,options:a}=e,{data:i,error:n}=await hr(this.fetch,"POST",t,{headers:this.headers,body:{phone:s,type:r,gotrue_meta_security:{captcha_token:null==a?void 0:a.captchaToken}}});return{data:{user:null,session:null,messageId:null==i?void 0:i.message_id},error:n}}throw new rr("You must provide either an email or phone number and a type")}catch(t){if(Ys(t))return{data:{user:null,session:null},error:t};throw t}}async getSession(){await this.initializePromise;return await this._acquireLock(-1,(async()=>this._useSession((async e=>e))))}async _acquireLock(e,t){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const e=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await e,await t()))();return this.pendingInLock.push((async()=>{try{await s}catch(e){}})()),s}return await this.lock(`lock:${this.storageKey}`,e,(async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const e=t();for(this.pendingInLock.push((async()=>{try{await e}catch(t){}})()),await e;this.pendingInLock.length;){const e=[...this.pendingInLock];await Promise.all(e),this.pendingInLock.splice(0,e.length)}return await e}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}}))}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const t=await this.__loadSession();return await e(t)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",(new Error).stack);try{let e=null;const t=await Vs(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",t),null!==t&&(this._isValidSession(t)?e=t:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const s=!!e.expires_at&&e.expires_at<=Date.now()/1e3;if(this._debug("#__loadSession()",`session has${s?"":" not"} expired`,"expires_at",e.expires_at),!s){if(this.storage.isServer){let t=this.suppressGetSessionWarning;e=new Proxy(e,{get:(e,s,r)=>(t||"user"!==s||(t=!0,this.suppressGetSessionWarning=!0),Reflect.get(e,s,r))})}return{data:{session:e},error:null}}const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{session:null},error:a}:{data:{session:r},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){if(e)return await this._getUser(e);await this.initializePromise;return await this._acquireLock(-1,(async()=>await this._getUser()))}async _getUser(e){try{return e?await hr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:xr}):await this._useSession((async e=>{var t,s,r;const{data:a,error:i}=e;if(i)throw i;return(null===(t=a.session)||void 0===t?void 0:t.access_token)||this.hasCustomAuthorizationHeader?await hr(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:null!==(r=null===(s=a.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0,xform:xr}):{data:{user:null},error:new tr}}))}catch(t){if(Ys(t))return function(e){return Ys(e)&&"AuthSessionMissingError"===e.name}(t)&&(await this._removeSession(),await Us(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:t};throw t}}async updateUser(e,t={}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._updateUser(e,t)))}async _updateUser(e,t={}){try{return await this._useSession((async s=>{const{data:r,error:a}=s;if(a)throw a;if(!r.session)throw new tr;const i=r.session;let n=null,o=null;"pkce"===this.flowType&&null!=e.email&&([n,o]=await Js(this.storage,this.storageKey));const{data:l,error:c}=await hr(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:null==t?void 0:t.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:n,code_challenge_method:o}),jwt:i.access_token,xform:xr});if(c)throw c;return i.user=l.user,await this._saveSession(i),await this._notifyAllSubscribers("USER_UPDATED",i),{data:{user:i.user},error:null}}))}catch(s){if(Ys(s))return{data:{user:null},error:s};throw s}}_decodeJWT(e){return Bs(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._setSession(e)))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new tr;const t=Date.now()/1e3;let s=t,r=!0,a=null;const i=Bs(e.access_token);if(i.exp&&(s=i.exp,r=s<=t),r){const{session:t,error:s}=await this._callRefreshToken(e.refresh_token);if(s)return{data:{user:null,session:null},error:s};if(!t)return{data:{user:null,session:null},error:null};a=t}else{const{data:r,error:i}=await this._getUser(e.access_token);if(i)throw i;a={access_token:e.access_token,refresh_token:e.refresh_token,user:r.user,token_type:"bearer",expires_in:s-t,expires_at:s},await this._saveSession(a),await this._notifyAllSubscribers("SIGNED_IN",a)}return{data:{user:a.user,session:a},error:null}}catch(t){if(Ys(t))return{data:{session:null,user:null},error:t};throw t}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._refreshSession(e)))}async _refreshSession(e){try{return await this._useSession((async t=>{var s;if(!e){const{data:r,error:a}=t;if(a)throw a;e=null!==(s=r.session)&&void 0!==s?s:void 0}if(!(null==e?void 0:e.refresh_token))throw new tr;const{session:r,error:a}=await this._callRefreshToken(e.refresh_token);return a?{data:{user:null,session:null},error:a}:r?{data:{user:r.user,session:r},error:null}:{data:{user:null,session:null},error:null}}))}catch(t){if(Ys(t))return{data:{user:null,session:null},error:t};throw t}}async _getSessionFromURL(e,t){try{if(!Ms())throw new ar("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ar(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(t){case"implicit":if("pkce"===this.flowType)throw new ir("Not a valid PKCE flow url.");break;case"pkce":if("implicit"===this.flowType)throw new ar("Not a valid implicit grant flow url.")}if("pkce"===t){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new ir("No code detected.");const{data:t,error:s}=await this._exchangeCodeForSession(e.code);if(s)throw s;const r=new URL(window.location.href);return r.searchParams.delete("code"),window.history.replaceState(window.history.state,"",r.toString()),{data:{session:t.session,redirectType:null},error:null}}const{provider_token:s,provider_refresh_token:r,access_token:a,refresh_token:i,expires_in:n,expires_at:o,token_type:l}=e;if(!(a&&n&&i&&l))throw new ar("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(n);let u=c+d;o&&(u=parseInt(o));const{data:h,error:m}=await this._getUser(a);if(m)throw m;const p={provider_token:s,provider_refresh_token:r,access_token:a,expires_in:d,expires_at:u,refresh_token:i,token_type:l,user:h.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:p,redirectType:e.type},error:null}}catch(s){if(Ys(s))return{data:{session:null,redirectType:null},error:s};throw s}}_isImplicitGrantCallback(e){return Boolean(e.access_token||e.error_description)}async _isPKCECallback(e){const t=await Vs(this.storage,`${this.storageKey}-code-verifier`);return!(!e.code||!t)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,(async()=>await this._signOut(e)))}async _signOut({scope:e}={scope:"global"}){return await this._useSession((async t=>{var s;const{data:r,error:a}=t;if(a)return{error:a};const i=null===(s=r.session)||void 0===s?void 0:s.access_token;if(i){const{error:t}=await this.admin.signOut(i,e);if(t&&(!function(e){return Ys(e)&&"AuthApiError"===e.name}(t)||404!==t.status&&401!==t.status&&403!==t.status))return{error:t}}return"others"!==e&&(await this._removeSession(),await Us(this.storage,`${this.storageKey}-code-verifier`)),{error:null}}))}onAuthStateChange(e){const t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){const t=16*Math.random()|0;return("x"==e?t:3&t|8).toString(16)})),s={id:t,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",t),this.stateChangeEmitters.delete(t)}};return this._debug("#onAuthStateChange()","registered callback with id",t),this.stateChangeEmitters.set(t,s),(async()=>{await this.initializePromise,await this._acquireLock(-1,(async()=>{this._emitInitialSession(t)}))})(),{data:{subscription:s}}}async _emitInitialSession(e){return await this._useSession((async t=>{var s,r;try{const{data:{session:r},error:a}=t;if(a)throw a;await(null===(s=this.stateChangeEmitters.get(e))||void 0===s?void 0:s.callback("INITIAL_SESSION",r)),this._debug("INITIAL_SESSION","callback id",e,"session",r)}catch(a){await(null===(r=this.stateChangeEmitters.get(e))||void 0===r?void 0:r.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",a)}}))}async resetPasswordForEmail(e,t={}){let s=null,r=null;"pkce"===this.flowType&&([s,r]=await Js(this.storage,this.storageKey,!0));try{return await hr(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:s,code_challenge_method:r,gotrue_meta_security:{captcha_token:t.captchaToken}},headers:this.headers,redirectTo:t.redirectTo})}catch(a){if(Ys(a))return{data:null,error:a};throw a}}async getUserIdentities(){var e;try{const{data:t,error:s}=await this.getUser();if(s)throw s;return{data:{identities:null!==(e=t.user.identities)&&void 0!==e?e:[]},error:null}}catch(t){if(Ys(t))return{data:null,error:t};throw t}}async linkIdentity(e){var t;try{const{data:s,error:r}=await this._useSession((async t=>{var s,r,a,i,n;const{data:o,error:l}=t;if(l)throw l;const c=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:null===(s=e.options)||void 0===s?void 0:s.redirectTo,scopes:null===(r=e.options)||void 0===r?void 0:r.scopes,queryParams:null===(a=e.options)||void 0===a?void 0:a.queryParams,skipBrowserRedirect:!0});return await hr(this.fetch,"GET",c,{headers:this.headers,jwt:null!==(n=null===(i=o.session)||void 0===i?void 0:i.access_token)&&void 0!==n?n:void 0})}));if(r)throw r;return Ms()&&!(null===(t=e.options)||void 0===t?void 0:t.skipBrowserRedirect)&&window.location.assign(null==s?void 0:s.url),{data:{provider:e.provider,url:null==s?void 0:s.url},error:null}}catch(s){if(Ys(s))return{data:{provider:e.provider,url:null},error:s};throw s}}async unlinkIdentity(e){try{return await this._useSession((async t=>{var s,r;const{data:a,error:i}=t;if(i)throw i;return await hr(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:null!==(r=null===(s=a.session)||void 0===s?void 0:s.access_token)&&void 0!==r?r:void 0})}))}catch(t){if(Ys(t))return{data:null,error:t};throw t}}async _refreshAccessToken(e){const t=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(t,"begin");try{const a=Date.now();return await(s=async s=>(s>0&&await async function(e){return await new Promise((t=>{setTimeout((()=>t(null)),e)}))}(200*Math.pow(2,s-1)),this._debug(t,"refreshing attempt",s),await hr(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:mr})),r=(e,t)=>{const s=200*Math.pow(2,e);return t&&or(t)&&Date.now()+s-a<Cr},new Promise(((e,t)=>{(async()=>{for(let i=0;i<1/0;i++)try{const t=await s(i);if(!r(i,null,t))return void e(t)}catch(a){if(!r(i,a))return void t(a)}})()})))}catch(a){if(this._debug(t,"error",a),Ys(a))return{data:{session:null,user:null},error:a};throw a}finally{this._debug(t,"end")}var s,r}_isValidSession(e){return"object"==typeof e&&null!==e&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,t){const s=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:t.redirectTo,scopes:t.scopes,queryParams:t.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",t,"url",s),Ms()&&!t.skipBrowserRedirect&&window.location.assign(s),{data:{provider:e,url:s},error:null}}async _recoverAndRefresh(){var e;const t="#_recoverAndRefresh()";this._debug(t,"begin");try{const s=await Vs(this.storage,this.storageKey);if(this._debug(t,"session from storage",s),!this._isValidSession(s))return this._debug(t,"session is not valid"),void(null!==s&&await this._removeSession());const r=Math.round(Date.now()/1e3),a=(null!==(e=s.expires_at)&&void 0!==e?e:1/0)<r+10;if(this._debug(t,`session has${a?"":" not"} expired with margin of 10s`),a){if(this.autoRefreshToken&&s.refresh_token){const{error:e}=await this._callRefreshToken(s.refresh_token);e&&(or(e)||(this._debug(t,"refresh failed with a non-retryable error, removing the session",e),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",s)}catch(s){return void this._debug(t,"error",s)}finally{this._debug(t,"end")}}async _callRefreshToken(e){var t,s;if(!e)throw new tr;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const r=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(r,"begin");try{this.refreshingDeferred=new Zs;const{data:t,error:s}=await this._refreshAccessToken(e);if(s)throw s;if(!t.session)throw new tr;await this._saveSession(t.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",t.session);const r={session:t.session,error:null};return this.refreshingDeferred.resolve(r),r}catch(a){if(this._debug(r,"error",a),Ys(a)){const e={session:null,error:a};return or(a)||await this._removeSession(),null===(t=this.refreshingDeferred)||void 0===t||t.resolve(e),e}throw null===(s=this.refreshingDeferred)||void 0===s||s.reject(a),a}finally{this.refreshingDeferred=null,this._debug(r,"end")}}async _notifyAllSubscribers(e,t,s=!0){const r=`#_notifyAllSubscribers(${e})`;this._debug(r,"begin",t,`broadcast = ${s}`);try{this.broadcastChannel&&s&&this.broadcastChannel.postMessage({event:e,session:t});const r=[],a=Array.from(this.stateChangeEmitters.values()).map((async s=>{try{await s.callback(e,t)}catch(a){r.push(a)}}));if(await Promise.all(a),r.length>0){for(let e=0;e<r.length;e+=1);throw r[0]}}finally{this._debug(r,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await zs(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await Us(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&Ms()&&(null===window||void 0===window?void 0:window.removeEventListener)&&window.removeEventListener("visibilitychange",e)}catch(t){}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval((()=>this._autoRefreshTokenTick()),Cr);this.autoRefreshTicker=e,e&&"object"==typeof e&&"function"==typeof e.unref?e.unref():"undefined"!=typeof Deno&&"function"==typeof Deno.unrefTimer&&Deno.unrefTimer(e),setTimeout((async()=>{await this.initializePromise,await this._autoRefreshTokenTick()}),0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,(async()=>{try{const t=Date.now();try{return await this._useSession((async e=>{const{data:{session:s}}=e;if(!s||!s.refresh_token||!s.expires_at)return void this._debug("#_autoRefreshTokenTick()","no session");const r=Math.floor((1e3*s.expires_at-t)/Cr);this._debug("#_autoRefreshTokenTick()",`access token expires in ${r} ticks, a tick lasts 30000ms, refresh threshold is 3 ticks`),r<=3&&await this._callRefreshToken(s.refresh_token)}))}catch(e){}}finally{this._debug("#_autoRefreshTokenTick()","end")}}))}catch(e){if(!(e.isAcquireTimeout||e instanceof Nr))throw e;this._debug("auto refresh token tick lock not available")}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!Ms()||!(null===window||void 0===window?void 0:window.addEventListener))return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),null===window||void 0===window||window.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){}}async _onVisibilityChanged(e){const t=`#_onVisibilityChanged(${e})`;this._debug(t,"visibilityState",document.visibilityState),"visible"===document.visibilityState?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,(async()=>{"visible"===document.visibilityState?await this._recoverAndRefresh():this._debug(t,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting")})))):"hidden"===document.visibilityState&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,t,s){const r=[`provider=${encodeURIComponent(t)}`];if((null==s?void 0:s.redirectTo)&&r.push(`redirect_to=${encodeURIComponent(s.redirectTo)}`),(null==s?void 0:s.scopes)&&r.push(`scopes=${encodeURIComponent(s.scopes)}`),"pkce"===this.flowType){const[e,t]=await Js(this.storage,this.storageKey),s=new URLSearchParams({code_challenge:`${encodeURIComponent(e)}`,code_challenge_method:`${encodeURIComponent(t)}`});r.push(s.toString())}if(null==s?void 0:s.queryParams){const e=new URLSearchParams(s.queryParams);r.push(e.toString())}return(null==s?void 0:s.skipBrowserRedirect)&&r.push(`skip_http_redirect=${s.skipBrowserRedirect}`),`${e}?${r.join("&")}`}async _unenroll(e){try{return await this._useSession((async t=>{var s;const{data:r,error:a}=t;return a?{data:null,error:a}:await hr(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})}))}catch(t){if(Ys(t))return{data:null,error:t};throw t}}async _enroll(e){try{return await this._useSession((async t=>{var s,r;const{data:a,error:i}=t;if(i)return{data:null,error:i};const n=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},"phone"===e.factorType?{phone:e.phone}:{issuer:e.issuer}),{data:o,error:l}=await hr(this.fetch,"POST",`${this.url}/factors`,{body:n,headers:this.headers,jwt:null===(s=null==a?void 0:a.session)||void 0===s?void 0:s.access_token});return l?{data:null,error:l}:("totp"===e.factorType&&(null===(r=null==o?void 0:o.totp)||void 0===r?void 0:r.qr_code)&&(o.totp.qr_code=`data:image/svg+xml;utf-8,${o.totp.qr_code}`),{data:o,error:null})}))}catch(t){if(Ys(t))return{data:null,error:t};throw t}}async _verify(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var s;const{data:r,error:a}=t;if(a)return{data:null,error:a};const{data:i,error:n}=await hr(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token});return n?{data:null,error:n}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+i.expires_in},i)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",i),{data:i,error:n})}))}catch(t){if(Ys(t))return{data:null,error:t};throw t}}))}async _challenge(e){return this._acquireLock(-1,(async()=>{try{return await this._useSession((async t=>{var s;const{data:r,error:a}=t;return a?{data:null,error:a}:await hr(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:null===(s=null==r?void 0:r.session)||void 0===s?void 0:s.access_token})}))}catch(t){if(Ys(t))return{data:null,error:t};throw t}}))}async _challengeAndVerify(e){const{data:t,error:s}=await this._challenge({factorId:e.factorId});return s?{data:null,error:s}:await this._verify({factorId:e.factorId,challengeId:t.id,code:e.code})}async _listFactors(){const{data:{user:e},error:t}=await this.getUser();if(t)return{data:null,error:t};const s=(null==e?void 0:e.factors)||[],r=s.filter((e=>"totp"===e.factor_type&&"verified"===e.status)),a=s.filter((e=>"phone"===e.factor_type&&"verified"===e.status));return{data:{all:s,totp:r,phone:a},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,(async()=>await this._useSession((async e=>{var t,s;const{data:{session:r},error:a}=e;if(a)return{data:null,error:a};if(!r)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const i=this._decodeJWT(r.access_token);let n=null;i.aal&&(n=i.aal);let o=n;(null!==(s=null===(t=r.user.factors)||void 0===t?void 0:t.filter((e=>"verified"===e.status)))&&void 0!==s?s:[]).length>0&&(o="aal2");return{data:{currentLevel:n,nextLevel:o,currentAuthenticationMethods:i.amr||[]},error:null}}))))}}Ar.nextInstanceID=0;const Pr=Ar;class Er extends Pr{constructor(e){super(e)}}var Or=function(e,t,s,r){return new(s||(s=Promise))((function(a,i){function n(e){try{l(r.next(e))}catch(t){i(t)}}function o(e){try{l(r.throw(e))}catch(t){i(t)}}function l(e){var t;e.done?a(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(n,o)}l((r=r.apply(e,t||[])).next())}))};class $r{constructor(e,t,s){var r,a,i;if(this.supabaseUrl=e,this.supabaseKey=t,!e)throw new Error("supabaseUrl is required.");if(!t)throw new Error("supabaseKey is required.");const n=e.replace(/\/$/,"");this.realtimeUrl=`${n}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${n}/auth/v1`,this.storageUrl=`${n}/storage/v1`,this.functionsUrl=`${n}/functions/v1`;const o=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l=function(e,t){const{db:s,auth:r,realtime:a,global:i}=e,{db:n,auth:o,realtime:l,global:c}=t,d={db:Object.assign(Object.assign({},n),s),auth:Object.assign(Object.assign({},o),r),realtime:Object.assign(Object.assign({},l),a),global:Object.assign(Object.assign({},c),i),accessToken:()=>Os(this,void 0,void 0,(function*(){return""}))};return e.accessToken?d.accessToken=e.accessToken:delete d.accessToken,d}(null!=s?s:{},{db:Cs,realtime:As,auth:Object.assign(Object.assign({},Ts),{storageKey:o}),global:Ss});this.storageKey=null!==(r=l.auth.storageKey)&&void 0!==r?r:"",this.headers=null!==(a=l.global.headers)&&void 0!==a?a:{},l.accessToken?(this.accessToken=l.accessToken,this.auth=new Proxy({},{get:(e,t)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(t)} is not possible`)}})):this.auth=this._initSupabaseAuthClient(null!==(i=l.auth)&&void 0!==i?i:{},this.headers,l.global.fetch),this.fetch=Es(t,this._getAccessToken.bind(this),l.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},l.realtime)),this.rest=new ht(`${n}/rest/v1`,{headers:this.headers,schema:l.db.schema,fetch:this.fetch}),l.accessToken||this._listenForAuthEvents()}get functions(){return new Ne(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new _s(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,t={},s={}){return this.rest.rpc(e,t,s)}channel(e,t={config:{}}){return this.realtime.channel(e,t)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,t;return Or(this,void 0,void 0,(function*(){if(this.accessToken)return yield this.accessToken();const{data:s}=yield this.auth.getSession();return null!==(t=null===(e=s.session)||void 0===e?void 0:e.access_token)&&void 0!==t?t:null}))}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,storageKey:a,flowType:i,lock:n,debug:o},l,c){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new Er({url:this.authUrl,headers:Object.assign(Object.assign({},d),l),storageKey:a,autoRefreshToken:e,persistSession:t,detectSessionInUrl:s,storage:r,flowType:i,lock:n,debug:o,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new ts(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},null==e?void 0:e.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange(((e,t)=>{this._handleTokenChanged(e,"CLIENT",null==t?void 0:t.access_token)}))}_handleTokenChanged(e,t,s){"TOKEN_REFRESHED"!==e&&"SIGNED_IN"!==e||this.changedAccessToken===s?"SIGNED_OUT"===e&&(this.realtime.setAuth(),"STORAGE"==t&&this.auth.signOut(),this.changedAccessToken=void 0):this.changedAccessToken=s}}const Rr=new $r("https://bbolclokjwysskzkjgot.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJib2xjbG9rand5c3NremtqZ290Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDAwNzU2MDcsImV4cCI6MjA1NTY1MTYwN30.1O8aQYdBptKnCo4JdwcWxARAk3s38AFCSeJ0PphhntI",Dr);var Dr;const Ir=te.createContext(void 0);function Mr({children:t}){const[s,r]=te.useState(null),[a,i]=te.useState(!0);te.useEffect((()=>{Rr.auth.getSession().then((({data:{session:e}})=>{r((null==e?void 0:e.user)??null),i(!1)}));const{data:{subscription:e}}=Rr.auth.onAuthStateChange(((e,t)=>{r((null==t?void 0:t.user)??null)}));return()=>e.unsubscribe()}),[]);return e.jsx(Ir.Provider,{value:{user:s,loading:a,signIn:async(e,t)=>{const{error:s}=await Rr.auth.signInWithPassword({email:e,password:t});if(s)throw s},signUp:async(e,t)=>{const{error:s}=await Rr.auth.signUp({email:e,password:t});if(s)throw s},signOut:async()=>{const{error:e}=await Rr.auth.signOut();if(e)throw e}},children:t})}function qr(){const e=te.useContext(Ir);if(void 0===e)throw new Error("useAuth must be used within an AuthProvider");return e}
/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var Lr={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};
/**
 * @license lucide-react v0.344.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fr=(e,t)=>{const s=te.forwardRef((({color:s="currentColor",size:r=24,strokeWidth:a=2,absoluteStrokeWidth:i,className:n="",children:o,...l},c)=>{return te.createElement("svg",{ref:c,...Lr,width:r,height:r,stroke:s,strokeWidth:i?24*Number(a)/Number(r):a,className:["lucide",`lucide-${d=e,d.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim()}`,n].join(" "),...l},[...t.map((([e,t])=>te.createElement(e,t))),...Array.isArray(o)?o:[o]]);var d}));return s.displayName=`${e}`,s},zr=Fr("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]),Vr=Fr("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]),Ur=Fr("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]),Zr=Fr("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]),Br=Fr("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]),Gr=Fr("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]),Wr=Fr("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]),Jr=Fr("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]]),Hr=Fr("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]),Kr=Fr("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]),Yr=Fr("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]),Qr=Fr("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]),Xr=Fr("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]),ea=Fr("Circle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]]),ta=Fr("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]),sa=Fr("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),ra=Fr("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]),aa=Fr("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]),ia=Fr("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]]),na=Fr("FileSearch",[["path",{d:"M4 22h14a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v3",key:"1vg67v"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["circle",{cx:"5",cy:"14",r:"3",key:"ufru5t"}],["path",{d:"m9 18-1.5-1.5",key:"1j6qii"}]]),oa=Fr("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]),la=Fr("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]),ca=Fr("Gift",[["rect",{x:"3",y:"8",width:"18",height:"4",rx:"1",key:"bkv52"}],["path",{d:"M12 8v13",key:"1c76mn"}],["path",{d:"M19 12v7a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2v-7",key:"6wjy6b"}],["path",{d:"M7.5 8a2.5 2.5 0 0 1 0-5A4.8 8 0 0 1 12 8a4.8 8 0 0 1 4.5-5 2.5 2.5 0 0 1 0 5",key:"1ihvrl"}]]),da=Fr("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]),ua=Fr("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]),ha=Fr("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]),ma=Fr("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]),pa=Fr("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]),xa=Fr("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]),ga=Fr("Package",[["path",{d:"m7.5 4.27 9 5.15",key:"1c824w"}],["path",{d:"M21 8a2 2 0 0 0-1-1.73l-7-4a2 2 0 0 0-2 0l-7 4A2 2 0 0 0 3 8v8a2 2 0 0 0 1 1.73l7 4a2 2 0 0 0 2 0l7-4A2 2 0 0 0 21 16Z",key:"hh9hay"}],["path",{d:"m3.3 7 8.7 5 8.7-5",key:"g66t2b"}],["path",{d:"M12 22V12",key:"d0xqtd"}]]),fa=Fr("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]),va=Fr("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]),ya=Fr("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]),ja=Fr("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]),ba=Fr("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]),wa=Fr("SquarePen",[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a2.121 2.121 0 1 1 3 3L12 15l-4 1 1-4Z",key:"1lpok0"}]]),Na=Fr("Tag",[["path",{d:"M12.586 2.586A2 2 0 0 0 11.172 2H4a2 2 0 0 0-2 2v7.172a2 2 0 0 0 .586 1.414l8.704 8.704a2.426 2.426 0 0 0 3.42 0l6.58-6.58a2.426 2.426 0 0 0 0-3.42z",key:"vktsd0"}],["circle",{cx:"7.5",cy:"7.5",r:".5",fill:"currentColor",key:"kqv944"}]]),_a=Fr("Terminal",[["polyline",{points:"4 17 10 11 4 5",key:"akl6gq"}],["line",{x1:"12",x2:"20",y1:"19",y2:"19",key:"q2wloq"}]]),ka=Fr("Trash",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]]),Sa=Fr("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]),Ca=Fr("Truck",[["path",{d:"M14 18V6a2 2 0 0 0-2-2H4a2 2 0 0 0-2 2v11a1 1 0 0 0 1 1h2",key:"wrbu53"}],["path",{d:"M15 18H9",key:"1lyqi6"}],["path",{d:"M19 18h2a1 1 0 0 0 1-1v-3.65a1 1 0 0 0-.22-.624l-3.48-4.35A1 1 0 0 0 17.52 8H14",key:"lysw3i"}],["circle",{cx:"17",cy:"18",r:"2",key:"332jqn"}],["circle",{cx:"7",cy:"18",r:"2",key:"19iecd"}]]),Ta=Fr("UserCheck",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["polyline",{points:"16 11 18 13 22 9",key:"1pwet4"}]]),Aa=Fr("UserX",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"17",x2:"22",y1:"8",y2:"13",key:"3nzzx3"}],["line",{x1:"22",x2:"17",y1:"8",y2:"13",key:"1swrse"}]]),Pa=Fr("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),Ea=Fr("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]),Oa=Fr("Wine",[["path",{d:"M8 22h8",key:"rmew8v"}],["path",{d:"M7 10h10",key:"1101jm"}],["path",{d:"M12 15v7",key:"t2xh3l"}],["path",{d:"M12 15a5 5 0 0 0 5-5c0-2-.5-4-2-8H9c-1.5 4-2 6-2 8a5 5 0 0 0 5 5Z",key:"10ffi3"}]]),$a=Fr("Workflow",[["rect",{width:"8",height:"8",x:"3",y:"3",rx:"2",key:"by2w9f"}],["path",{d:"M7 11v4a2 2 0 0 0 2 2h4",key:"xkn7yn"}],["rect",{width:"8",height:"8",x:"13",y:"13",rx:"2",key:"1cgmvn"}]]),Ra=Fr("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]);function Da(e){var t,s,r="";if("string"==typeof e||"number"==typeof e)r+=e;else if("object"==typeof e)if(Array.isArray(e)){var a=e.length;for(t=0;t<a;t++)e[t]&&(s=Da(e[t]))&&(r&&(r+=" "),r+=s)}else for(s in e)e[s]&&(r&&(r+=" "),r+=s);return r}function Ia(){for(var e,t,s=0,r="",a=arguments.length;s<a;s++)(e=arguments[s])&&(t=Da(e))&&(r&&(r+=" "),r+=t);return r}const Ma=e=>{const t=za(e),{conflictingClassGroups:s,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:e=>{const s=e.split("-");return""===s[0]&&1!==s.length&&s.shift(),qa(s,t)||Fa(e)},getConflictingClassGroupIds:(e,t)=>{const a=s[e]||[];return t&&r[e]?[...a,...r[e]]:a}}},qa=(e,t)=>{var s;if(0===e.length)return t.classGroupId;const r=e[0],a=t.nextPart.get(r),i=a?qa(e.slice(1),a):void 0;if(i)return i;if(0===t.validators.length)return;const n=e.join("-");return null==(s=t.validators.find((({validator:e})=>e(n))))?void 0:s.classGroupId},La=/^\[(.+)\]$/,Fa=e=>{if(La.test(e)){const t=La.exec(e)[1],s=null==t?void 0:t.substring(0,t.indexOf(":"));if(s)return"arbitrary.."+s}},za=e=>{const{theme:t,prefix:s}=e,r={nextPart:new Map,validators:[]};return Ba(Object.entries(e.classGroups),s).forEach((([e,s])=>{Va(s,r,e,t)})),r},Va=(e,t,s,r)=>{e.forEach((e=>{if("string"!=typeof e){if("function"==typeof e)return Za(e)?void Va(e(r),t,s,r):void t.validators.push({validator:e,classGroupId:s});Object.entries(e).forEach((([e,a])=>{Va(a,Ua(t,e),s,r)}))}else{(""===e?t:Ua(t,e)).classGroupId=s}}))},Ua=(e,t)=>{let s=e;return t.split("-").forEach((e=>{s.nextPart.has(e)||s.nextPart.set(e,{nextPart:new Map,validators:[]}),s=s.nextPart.get(e)})),s},Za=e=>e.isThemeGetter,Ba=(e,t)=>t?e.map((([e,s])=>[e,s.map((e=>"string"==typeof e?t+e:"object"==typeof e?Object.fromEntries(Object.entries(e).map((([e,s])=>[t+e,s]))):e))])):e,Ga=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,s=new Map,r=new Map;const a=(a,i)=>{s.set(a,i),t++,t>e&&(t=0,r=s,s=new Map)};return{get(e){let t=s.get(e);return void 0!==t?t:void 0!==(t=r.get(e))?(a(e,t),t):void 0},set(e,t){s.has(e)?s.set(e,t):a(e,t)}}},Wa=e=>{const{separator:t,experimentalParseClassName:s}=e,r=1===t.length,a=t[0],i=t.length,n=e=>{const s=[];let n,o=0,l=0;for(let u=0;u<e.length;u++){let c=e[u];if(0===o){if(c===a&&(r||e.slice(u,u+i)===t)){s.push(e.slice(l,u)),l=u+i;continue}if("/"===c){n=u;continue}}"["===c?o++:"]"===c&&o--}const c=0===s.length?e:e.substring(l),d=c.startsWith("!");return{modifiers:s,hasImportantModifier:d,baseClassName:d?c.substring(1):c,maybePostfixModifierPosition:n&&n>l?n-l:void 0}};return s?e=>s({className:e,parseClassName:n}):n},Ja=e=>{if(e.length<=1)return e;const t=[];let s=[];return e.forEach((e=>{"["===e[0]?(t.push(...s.sort(),e),s=[]):s.push(e)})),t.push(...s.sort()),t},Ha=/\s+/;function Ka(){let e,t,s=0,r="";for(;s<arguments.length;)(e=arguments[s++])&&(t=Ya(e))&&(r&&(r+=" "),r+=t);return r}const Ya=e=>{if("string"==typeof e)return e;let t,s="";for(let r=0;r<e.length;r++)e[r]&&(t=Ya(e[r]))&&(s&&(s+=" "),s+=t);return s};function Qa(e,...t){let s,r,a,i=function(o){const l=t.reduce(((e,t)=>t(e)),e());return s=(e=>({cache:Ga(e.cacheSize),parseClassName:Wa(e),...Ma(e)}))(l),r=s.cache.get,a=s.cache.set,i=n,n(o)};function n(e){const t=r(e);if(t)return t;const i=((e,t)=>{const{parseClassName:s,getClassGroupId:r,getConflictingClassGroupIds:a}=t,i=[],n=e.trim().split(Ha);let o="";for(let l=n.length-1;l>=0;l-=1){const e=n[l],{modifiers:t,hasImportantModifier:c,baseClassName:d,maybePostfixModifierPosition:u}=s(e);let h=Boolean(u),m=r(h?d.substring(0,u):d);if(!m){if(!h){o=e+(o.length>0?" "+o:o);continue}if(m=r(d),!m){o=e+(o.length>0?" "+o:o);continue}h=!1}const p=Ja(t).join(":"),x=c?p+"!":p,g=x+m;if(i.includes(g))continue;i.push(g);const f=a(m,h);for(let s=0;s<f.length;++s){const e=f[s];i.push(x+e)}o=e+(o.length>0?" "+o:o)}return o})(e,s);return a(e,i),i}return function(){return i(Ka.apply(null,arguments))}}const Xa=e=>{const t=t=>t[e]||[];return t.isThemeGetter=!0,t},ei=/^\[(?:([a-z-]+):)?(.+)\]$/i,ti=/^\d+\/\d+$/,si=new Set(["px","full","screen"]),ri=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,ai=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,ii=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,ni=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,oi=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,li=e=>di(e)||si.has(e)||ti.test(e),ci=e=>Ni(e,"length",_i),di=e=>Boolean(e)&&!Number.isNaN(Number(e)),ui=e=>Ni(e,"number",di),hi=e=>Boolean(e)&&Number.isInteger(Number(e)),mi=e=>e.endsWith("%")&&di(e.slice(0,-1)),pi=e=>ei.test(e),xi=e=>ri.test(e),gi=new Set(["length","size","percentage"]),fi=e=>Ni(e,gi,ki),vi=e=>Ni(e,"position",ki),yi=new Set(["image","url"]),ji=e=>Ni(e,yi,Ci),bi=e=>Ni(e,"",Si),wi=()=>!0,Ni=(e,t,s)=>{const r=ei.exec(e);return!!r&&(r[1]?"string"==typeof t?r[1]===t:t.has(r[1]):s(r[2]))},_i=e=>ai.test(e)&&!ii.test(e),ki=()=>!1,Si=e=>ni.test(e),Ci=e=>oi.test(e),Ti=Qa((()=>{const e=Xa("colors"),t=Xa("spacing"),s=Xa("blur"),r=Xa("brightness"),a=Xa("borderColor"),i=Xa("borderRadius"),n=Xa("borderSpacing"),o=Xa("borderWidth"),l=Xa("contrast"),c=Xa("grayscale"),d=Xa("hueRotate"),u=Xa("invert"),h=Xa("gap"),m=Xa("gradientColorStops"),p=Xa("gradientColorStopPositions"),x=Xa("inset"),g=Xa("margin"),f=Xa("opacity"),v=Xa("padding"),y=Xa("saturate"),j=Xa("scale"),b=Xa("sepia"),w=Xa("skew"),N=Xa("space"),_=Xa("translate"),k=()=>["auto",pi,t],S=()=>[pi,t],C=()=>["",li,ci],T=()=>["auto",di,pi],A=()=>["","0",pi],P=()=>[di,pi];return{cacheSize:500,separator:":",theme:{colors:[wi],spacing:[li,ci],blur:["none","",xi,pi],brightness:P(),borderColor:[e],borderRadius:["none","","full",xi,pi],borderSpacing:S(),borderWidth:C(),contrast:P(),grayscale:A(),hueRotate:P(),invert:A(),gap:S(),gradientColorStops:[e],gradientColorStopPositions:[mi,ci],inset:k(),margin:k(),opacity:P(),padding:S(),saturate:P(),scale:P(),sepia:A(),skew:P(),space:S(),translate:S()},classGroups:{aspect:[{aspect:["auto","square","video",pi]}],container:["container"],columns:[{columns:[xi]}],"break-after":[{"break-after":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-before":[{"break-before":["auto","avoid","all","avoid-page","page","left","right","column"]}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",pi]}],overflow:[{overflow:["auto","hidden","clip","visible","scroll"]}],"overflow-x":[{"overflow-x":["auto","hidden","clip","visible","scroll"]}],"overflow-y":[{"overflow-y":["auto","hidden","clip","visible","scroll"]}],overscroll:[{overscroll:["auto","contain","none"]}],"overscroll-x":[{"overscroll-x":["auto","contain","none"]}],"overscroll-y":[{"overscroll-y":["auto","contain","none"]}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[x]}],"inset-x":[{"inset-x":[x]}],"inset-y":[{"inset-y":[x]}],start:[{start:[x]}],end:[{end:[x]}],top:[{top:[x]}],right:[{right:[x]}],bottom:[{bottom:[x]}],left:[{left:[x]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",hi,pi]}],basis:[{basis:k()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",pi]}],grow:[{grow:A()}],shrink:[{shrink:A()}],order:[{order:["first","last","none",hi,pi]}],"grid-cols":[{"grid-cols":[wi]}],"col-start-end":[{col:["auto",{span:["full",hi,pi]},pi]}],"col-start":[{"col-start":T()}],"col-end":[{"col-end":T()}],"grid-rows":[{"grid-rows":[wi]}],"row-start-end":[{row:["auto",{span:[hi,pi]},pi]}],"row-start":[{"row-start":T()}],"row-end":[{"row-end":T()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",pi]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",pi]}],gap:[{gap:[h]}],"gap-x":[{"gap-x":[h]}],"gap-y":[{"gap-y":[h]}],"justify-content":[{justify:["normal","start","end","center","between","around","evenly","stretch"]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal","start","end","center","between","around","evenly","stretch","baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":["start","end","center","between","around","evenly","stretch","baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[v]}],px:[{px:[v]}],py:[{py:[v]}],ps:[{ps:[v]}],pe:[{pe:[v]}],pt:[{pt:[v]}],pr:[{pr:[v]}],pb:[{pb:[v]}],pl:[{pl:[v]}],m:[{m:[g]}],mx:[{mx:[g]}],my:[{my:[g]}],ms:[{ms:[g]}],me:[{me:[g]}],mt:[{mt:[g]}],mr:[{mr:[g]}],mb:[{mb:[g]}],ml:[{ml:[g]}],"space-x":[{"space-x":[N]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[N]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",pi,t]}],"min-w":[{"min-w":[pi,t,"min","max","fit"]}],"max-w":[{"max-w":[pi,t,"none","full","min","max","fit","prose",{screen:[xi]},xi]}],h:[{h:[pi,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[pi,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[pi,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[pi,t,"auto","min","max","fit"]}],"font-size":[{text:["base",xi,ci]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",ui]}],"font-family":[{font:[wi]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",pi]}],"line-clamp":[{"line-clamp":["none",di,ui]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",li,pi]}],"list-image":[{"list-image":["none",pi]}],"list-style-type":[{list:["none","disc","decimal",pi]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[e]}],"placeholder-opacity":[{"placeholder-opacity":[f]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[e]}],"text-opacity":[{"text-opacity":[f]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:["solid","dashed","dotted","double","none","wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",li,ci]}],"underline-offset":[{"underline-offset":["auto",li,pi]}],"text-decoration-color":[{decoration:[e]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:S()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",pi]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",pi]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[f]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top",vi]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",fi]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},ji]}],"bg-color":[{bg:[e]}],"gradient-from-pos":[{from:[p]}],"gradient-via-pos":[{via:[p]}],"gradient-to-pos":[{to:[p]}],"gradient-from":[{from:[m]}],"gradient-via":[{via:[m]}],"gradient-to":[{to:[m]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[f]}],"border-style":[{border:["solid","dashed","dotted","double","none","hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[f]}],"divide-style":[{divide:["solid","dashed","dotted","double","none"]}],"border-color":[{border:[a]}],"border-color-x":[{"border-x":[a]}],"border-color-y":[{"border-y":[a]}],"border-color-s":[{"border-s":[a]}],"border-color-e":[{"border-e":[a]}],"border-color-t":[{"border-t":[a]}],"border-color-r":[{"border-r":[a]}],"border-color-b":[{"border-b":[a]}],"border-color-l":[{"border-l":[a]}],"divide-color":[{divide:[a]}],"outline-style":[{outline:["","solid","dashed","dotted","double","none"]}],"outline-offset":[{"outline-offset":[li,pi]}],"outline-w":[{outline:[li,ci]}],"outline-color":[{outline:[e]}],"ring-w":[{ring:C()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[e]}],"ring-opacity":[{"ring-opacity":[f]}],"ring-offset-w":[{"ring-offset":[li,ci]}],"ring-offset-color":[{"ring-offset":[e]}],shadow:[{shadow:["","inner","none",xi,bi]}],"shadow-color":[{shadow:[wi]}],opacity:[{opacity:[f]}],"mix-blend":[{"mix-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity","plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"]}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[r]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",xi,pi]}],grayscale:[{grayscale:[c]}],"hue-rotate":[{"hue-rotate":[d]}],invert:[{invert:[u]}],saturate:[{saturate:[y]}],sepia:[{sepia:[b]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[c]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[d]}],"backdrop-invert":[{"backdrop-invert":[u]}],"backdrop-opacity":[{"backdrop-opacity":[f]}],"backdrop-saturate":[{"backdrop-saturate":[y]}],"backdrop-sepia":[{"backdrop-sepia":[b]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[n]}],"border-spacing-x":[{"border-spacing-x":[n]}],"border-spacing-y":[{"border-spacing-y":[n]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",pi]}],duration:[{duration:P()}],ease:[{ease:["linear","in","out","in-out",pi]}],delay:[{delay:P()}],animate:[{animate:["none","spin","ping","pulse","bounce",pi]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[j]}],"scale-x":[{"scale-x":[j]}],"scale-y":[{"scale-y":[j]}],rotate:[{rotate:[hi,pi]}],"translate-x":[{"translate-x":[_]}],"translate-y":[{"translate-y":[_]}],"skew-x":[{"skew-x":[w]}],"skew-y":[{"skew-y":[w]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",pi]}],accent:[{accent:["auto",e]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",pi]}],"caret-color":[{caret:[e]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":S()}],"scroll-mx":[{"scroll-mx":S()}],"scroll-my":[{"scroll-my":S()}],"scroll-ms":[{"scroll-ms":S()}],"scroll-me":[{"scroll-me":S()}],"scroll-mt":[{"scroll-mt":S()}],"scroll-mr":[{"scroll-mr":S()}],"scroll-mb":[{"scroll-mb":S()}],"scroll-ml":[{"scroll-ml":S()}],"scroll-p":[{"scroll-p":S()}],"scroll-px":[{"scroll-px":S()}],"scroll-py":[{"scroll-py":S()}],"scroll-ps":[{"scroll-ps":S()}],"scroll-pe":[{"scroll-pe":S()}],"scroll-pt":[{"scroll-pt":S()}],"scroll-pr":[{"scroll-pr":S()}],"scroll-pb":[{"scroll-pb":S()}],"scroll-pl":[{"scroll-pl":S()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",pi]}],fill:[{fill:[e,"none"]}],"stroke-w":[{stroke:[li,ci,ui]}],stroke:[{stroke:[e,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}}));function Ai(...e){return Ti(Ia(e))}const Pi=e=>"boolean"==typeof e?`${e}`:0===e?"0":e,Ei=Ia,Oi=(e,t)=>s=>{var r;if(null==(null==t?void 0:t.variants))return Ei(e,null==s?void 0:s.class,null==s?void 0:s.className);const{variants:a,defaultVariants:i}=t,n=Object.keys(a).map((e=>{const t=null==s?void 0:s[e],r=null==i?void 0:i[e];if(null===t)return null;const n=Pi(t)||Pi(r);return a[e][n]})),o=s&&Object.entries(s).reduce(((e,t)=>{let[s,r]=t;return void 0===r||(e[s]=r),e}),{}),l=null==t||null===(r=t.compoundVariants)||void 0===r?void 0:r.reduce(((e,t)=>{let{class:s,className:r,...a}=t;return Object.entries(a).every((e=>{let[t,s]=e;return Array.isArray(s)?s.includes({...i,...o}[t]):{...i,...o}[t]===s}))?[...e,s,r]:e}),[]);return Ei(e,n,l,null==s?void 0:s.class,null==s?void 0:s.className)},$i=Oi("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),Ri=te.forwardRef((({className:s,variant:r,size:a,asChild:i=!1,...n},o)=>{const l=i?t:"button";return e.jsx(l,{className:Ai($i({variant:r,size:a,className:s})),ref:o,...n})}));function Di({onClose:t}){const[s,r]=te.useState(!1),a=[{icon:da,label:"Home",to:"/"},{icon:Ea,label:"Allocations",to:"/allocations"},{icon:_a,label:"API Console",to:"/api"},{icon:na,label:"Queries",to:"/queries"},{icon:ja,label:"Settings",to:"/settings"}];return e.jsxs("div",{className:Ai("h-screen bg-sidebar flex flex-col transition-all duration-300",s?"w-16":"w-64"),children:[e.jsxs("div",{className:"flex items-center justify-between p-4 border-b border-gray-700",children:[!s&&e.jsx("span",{className:"font-medium text-white",children:"Offset Development"}),e.jsxs("div",{className:"flex items-center gap-2",children:[t&&e.jsx(Ri,{variant:"ghost",size:"icon",className:"lg:hidden text-white hover:bg-gray-700",onClick:t,children:e.jsx(Ra,{size:20})}),e.jsx(Ri,{variant:"ghost",size:"icon",className:"hidden lg:flex text-white hover:bg-gray-700",onClick:()=>r(!s),children:s?e.jsx(Qr,{size:20}):e.jsx(Yr,{size:20})})]})]}),e.jsx("nav",{className:"flex-1 p-2",children:a.map((r=>e.jsxs(se,{to:r.to,onClick:t,className:({isActive:e})=>Ai("flex items-center gap-3 px-3 py-2 rounded-lg transition-colors text-gray-300 hover:text-white","hover:bg-gray-700/50",e?"bg-gray-700/50 text-white font-medium":"text-gray-300",s&&"justify-center"),children:[e.jsx(r.icon,{size:20}),!s&&e.jsx("span",{children:r.label})]},r.to)))}),!s&&e.jsxs("div",{className:"p-4 border-t border-gray-700 space-y-2",children:[e.jsx("div",{className:"text-sm text-gray-400",children:" 2025"}),e.jsxs("div",{className:"space-y-1",children:[e.jsx("a",{href:"#",className:"block text-sm text-gray-400 hover:text-white",children:"Terms & Conditions"}),e.jsx("a",{href:"#",className:"block text-sm text-gray-400 hover:text-white",children:"Privacy Policy"}),e.jsx("a",{href:"#",className:"block text-sm text-gray-400 hover:text-white",children:"Support"})]})]})]})}Ri.displayName="Button";const Ii=h,Mi=m;te.forwardRef((({className:t,inset:r,children:a,...i},n)=>e.jsxs(s,{ref:n,className:Ai("flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none focus:bg-accent data-[state=open]:bg-accent",r&&"pl-8",t),...i,children:[a,e.jsx(Qr,{className:"ml-auto h-4 w-4"})]}))).displayName=s.displayName;te.forwardRef((({className:t,...s},a)=>e.jsx(r,{ref:a,className:Ai("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-lg data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...s}))).displayName=r.displayName;const qi=te.forwardRef((({className:t,sideOffset:s=4,...r},n)=>e.jsx(a,{children:e.jsx(i,{ref:n,sideOffset:s,className:Ai("z-50 min-w-[8rem] overflow-hidden rounded-md border bg-popover p-1 text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",t),...r})})));qi.displayName=i.displayName;const Li=te.forwardRef((({className:t,inset:s,...r},a)=>e.jsx(n,{ref:a,className:Ai("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s&&"pl-8",t),...r})));Li.displayName=n.displayName;te.forwardRef((({className:t,children:s,checked:r,...a},i)=>e.jsxs(o,{ref:i,className:Ai("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),checked:r,...a,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(l,{children:e.jsx(Hr,{className:"h-4 w-4"})})}),s]}))).displayName=o.displayName;te.forwardRef((({className:t,children:s,...r},a)=>e.jsxs(c,{ref:a,className:Ai("relative flex cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none transition-colors focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(l,{children:e.jsx(ea,{className:"h-2 w-2 fill-current"})})}),s]}))).displayName=c.displayName;const Fi=te.forwardRef((({className:t,inset:s,...r},a)=>e.jsx(d,{ref:a,className:Ai("px-2 py-1.5 text-sm font-semibold",s&&"pl-8",t),...r})));Fi.displayName=d.displayName;const zi=te.forwardRef((({className:t,...s},r)=>e.jsx(u,{ref:r,className:Ai("-mx-1 my-1 h-px bg-muted",t),...s})));function Vi({children:t}){var s;const{user:r,signOut:a}=qr();return e.jsxs("div",{className:"h-16 bg-sidebar border-b border-gray-700 flex items-center px-4 gap-4",children:[t,e.jsxs("div",{className:"flex-1 flex items-center justify-end gap-4",children:[e.jsxs("div",{className:"relative hidden md:block w-80",children:[e.jsx(ya,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"search",placeholder:"Search orders, customers, and products",className:"w-full pl-10 pr-4 py-2 bg-gray-700 text-white rounded-lg \n                     placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs(Ii,{children:[e.jsx(Mi,{asChild:!0,children:e.jsxs("button",{className:"flex items-center gap-2 text-white hover:text-gray-200",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-green-500 flex items-center justify-center",children:e.jsx("span",{className:"text-white font-medium",children:null==(s=null==r?void 0:r.email)?void 0:s[0].toUpperCase()})}),e.jsx("span",{className:"hidden md:block",children:null==r?void 0:r.email}),e.jsx(Kr,{className:"hidden md:block w-4 h-4"})]})}),e.jsxs(qi,{align:"end",className:"w-56",children:[e.jsx(Fi,{children:"My Account"}),e.jsx(zi,{}),e.jsx(Li,{className:"text-sm",children:"Profile Settings"}),e.jsx(Li,{className:"text-sm",children:"Preferences"}),e.jsx(zi,{}),e.jsx(Li,{className:"text-sm text-red-600 focus:text-red-600",onClick:()=>a(),children:"Sign out"})]})]})]})]})}function Ui(){const[t,s]=te.useState(!1);return e.jsxs("div",{className:"flex h-screen",children:[t&&e.jsx("div",{className:"fixed inset-0 bg-black/50 z-40 lg:hidden",onClick:()=>s(!1)}),e.jsx("div",{className:`\n        fixed inset-y-0 left-0 z-50 transform lg:relative lg:translate-x-0 transition-transform duration-200 ease-in-out\n        ${t?"translate-x-0":"-translate-x-full"}\n      `,children:e.jsx(Di,{onClose:()=>s(!1)})}),e.jsxs("div",{className:"flex-1 flex flex-col min-w-0 relative",children:[e.jsx(Vi,{children:e.jsx(Ri,{variant:"ghost",size:"icon",className:"lg:hidden",onClick:()=>s(!0),children:e.jsx(pa,{className:"h-5 w-5"})})}),e.jsx("main",{className:"flex-1 bg-white p-4 md:p-6 overflow-auto",children:e.jsx(re,{})})]})]})}function Zi({icon:t,name:s,description:r,enabled:a,href:i,comingSoon:n}){const o=ae();return e.jsxs("div",{className:`\n        relative group rounded-lg border bg-white p-6 transition-all duration-200\n        ${a?"cursor-pointer hover:shadow-md hover:border-blue-200":"opacity-75"}\n      `,onClick:()=>{a&&i&&o(i)},children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx("div",{className:"p-3 rounded-lg "+(a?"bg-blue-50 text-blue-600":"bg-gray-100 text-gray-500"),children:e.jsx(t,{className:"w-6 h-6"})}),a&&!n&&e.jsx("span",{className:"text-xs font-medium text-green-600 bg-green-50 px-2.5 py-0.5 rounded-full",children:"Enabled"}),n&&e.jsx("span",{className:"text-xs font-medium text-purple-600 bg-purple-50 px-2.5 py-0.5 rounded-full",children:"Coming Soon"})]}),e.jsx("h3",{className:"mt-4 text-lg font-semibold "+(a?"text-gray-900":"text-gray-600"),children:s}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:r}),a&&!n&&e.jsxs("div",{className:"mt-4 flex items-center text-sm text-blue-600",children:[e.jsx("span",{children:"Open app"}),e.jsx(ia,{className:"ml-1 w-4 h-4"})]})]})}function Bi(){const t=[{icon:Ea,name:"Allocations",description:"Manage wine allocations and customer tiers",enabled:!0,href:"/allocations"},{icon:na,name:"Queries",description:"Run custom queries and generate reports",enabled:!0,href:"/queries"},{icon:Oa,name:"Clubs",description:"Manage wine club memberships and benefits",enabled:!1,comingSoon:!0},{icon:ma,name:"MailChimp",description:"Email marketing and automation",enabled:!1,comingSoon:!0},{icon:Ca,name:"PODE",description:"Post Order Delivery Experience",enabled:!1,comingSoon:!0},{icon:$a,name:"Workflows",description:"Automate business processes",enabled:!1,comingSoon:!0},{icon:Br,name:"Analytics",description:"Business intelligence and insights",enabled:!1,comingSoon:!0},{icon:oa,name:"Reporting",description:"Generate and schedule reports",enabled:!1,comingSoon:!0}];return e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:"Apps"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Access your enabled applications and discover new features"})]}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:t.map((t=>e.jsx(Zi,{...t},t.name)))}),e.jsxs("div",{className:"mt-12 bg-gray-50 rounded-lg p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Need more apps?"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Contact your account manager to enable additional applications or request new features."})]})]})}zi.displayName=u.displayName;const Gi=te.forwardRef((({className:t,type:s,...r},a)=>e.jsx("input",{type:s,className:Ai("flex h-9 w-full rounded-md border border-input bg-transparent px-3 py-1 text-sm shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:a,...r})));Gi.displayName="Input";const Wi=S,Ji=C,Hi=te.forwardRef((({className:t,children:s,...r},a)=>e.jsxs(p,{ref:a,className:Ai("flex h-9 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-1 focus:ring-ring disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...r,children:[s,e.jsx(x,{asChild:!0,children:e.jsx(Kr,{className:"h-4 w-4 opacity-50"})})]})));Hi.displayName=p.displayName;const Ki=te.forwardRef((({className:t,...s},r)=>e.jsx(g,{ref:r,className:Ai("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Xr,{className:"h-4 w-4"})})));Ki.displayName=g.displayName;const Yi=te.forwardRef((({className:t,...s},r)=>e.jsx(f,{ref:r,className:Ai("flex cursor-default items-center justify-center py-1",t),...s,children:e.jsx(Kr,{className:"h-4 w-4"})})));Yi.displayName=f.displayName;const Qi=te.forwardRef((({className:t,children:s,position:r="popper",...a},i)=>e.jsx(v,{children:e.jsxs(y,{ref:i,className:Ai("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2","popper"===r&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:r,...a,children:[e.jsx(Ki,{}),e.jsx(j,{className:Ai("p-1","popper"===r&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:s}),e.jsx(Yi,{})]})})));Qi.displayName=y.displayName;te.forwardRef((({className:t,...s},r)=>e.jsx(b,{ref:r,className:Ai("px-2 py-1.5 text-sm font-semibold",t),...s}))).displayName=b.displayName;const Xi=te.forwardRef((({className:t,children:s,...r},a)=>e.jsxs(w,{ref:a,className:Ai("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-2 pr-8 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...r,children:[e.jsx("span",{className:"absolute right-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(N,{children:e.jsx(Hr,{className:"h-4 w-4"})})}),e.jsx(_,{children:s})]})));Xi.displayName=w.displayName;te.forwardRef((({className:t,...s},r)=>e.jsx(k,{ref:r,className:Ai("-mx-1 my-1 h-px bg-muted",t),...s}))).displayName=k.displayName;const en=e=>{let t;const s=new Set,r=(e,r)=>{const a="function"==typeof e?e(t):e;if(!Object.is(a,t)){const e=t;t=(null!=r?r:"object"!=typeof a||null===a)?a:Object.assign({},t,a),s.forEach((s=>s(t,e)))}},a=()=>t,i={setState:r,getState:a,getInitialState:()=>n,subscribe:e=>(s.add(e),()=>s.delete(e)),destroy:()=>{s.clear()}},n=t=e(r,a,i);return i};var tn={exports:{}},sn={},rn={exports:{}},an={},nn=te;var on="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},ln=nn.useState,cn=nn.useEffect,dn=nn.useLayoutEffect,un=nn.useDebugValue;function hn(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!on(e,s)}catch(r){return!0}}var mn="undefined"==typeof window||void 0===window.document||void 0===window.document.createElement?function(e,t){return t()}:function(e,t){var s=t(),r=ln({inst:{value:s,getSnapshot:t}}),a=r[0].inst,i=r[1];return dn((function(){a.value=s,a.getSnapshot=t,hn(a)&&i({inst:a})}),[e,s,t]),cn((function(){return hn(a)&&i({inst:a}),e((function(){hn(a)&&i({inst:a})}))}),[e]),un(s),s};an.useSyncExternalStore=void 0!==nn.useSyncExternalStore?nn.useSyncExternalStore:mn,rn.exports=an;var pn=rn.exports,xn=te,gn=pn;
/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fn="function"==typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e==1/t)||e!=e&&t!=t},vn=gn.useSyncExternalStore,yn=xn.useRef,jn=xn.useEffect,bn=xn.useMemo,wn=xn.useDebugValue;sn.useSyncExternalStoreWithSelector=function(e,t,s,r,a){var i=yn(null);if(null===i.current){var n={hasValue:!1,value:null};i.current=n}else n=i.current;i=bn((function(){function e(e){if(!l){if(l=!0,i=e,e=r(e),void 0!==a&&n.hasValue){var t=n.value;if(a(t,e))return o=t}return o=e}if(t=o,fn(i,e))return t;var s=r(e);return void 0!==a&&a(t,s)?(i=e,t):(i=e,o=s)}var i,o,l=!1,c=void 0===s?null:s;return[function(){return e(t())},null===c?void 0:function(){return e(c())}]}),[t,s,r,a]);var o=vn(e,i[0],i[1]);return jn((function(){n.hasValue=!0,n.value=o}),[o]),wn(o),o},tn.exports=sn;const Nn=ie(tn.exports),_n={BASE_URL:"/",DEV:!1,MODE:"production",PROD:!0,SSR:!1,VITE_OFFSET_API_TOKEN:"fF8UirKdbsElpLj6MPesBG6Dck7TjjWQZkrfWx9dkd",VITE_SUPABASE_ANON_KEY:"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJib2xjbG9rand5c3NremtqZ290Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDAwNzU2MDcsImV4cCI6MjA1NTY1MTYwN30.1O8aQYdBptKnCo4JdwcWxARAk3s38AFCSeJ0PphhntI",VITE_SUPABASE_URL:"https://bbolclokjwysskzkjgot.supabase.co"},{useDebugValue:kn}=ne,{useSyncExternalStoreWithSelector:Sn}=Nn;let Cn=!1;const Tn=e=>e;const An=e=>{const t="function"==typeof e?(e=>e?en(e):en)(e):e,s=(e,s)=>function(e,t=Tn,s){"production"!==(_n?"production":void 0)&&s&&!Cn&&(Cn=!0);const r=Sn(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,s);return kn(r),r}(t,e,s);return Object.assign(s,t),s},Pn=(En=(e,t)=>({allocations:[],stats:{totalAllocations:0,activeAllocations:0,totalRevenue:0,revenueChange:0,totalCustomers:0,avgDuration:0},filters:{status:"all",product:"",date:""},loading:!1,error:null,fetchAllocations:async()=>{e({loading:!0});try{const{filters:s}=t();let r=Rr.from("allocations").select("\n          *,\n          allocation_products (\n            product_id,\n            total_inventory,\n            remaining_inventory\n          )\n        ").order("created_at",{ascending:!1});"all"!==s.status&&(r=r.eq("status",s.status)),s.date&&(r=r.gte("start_date",s.date));const{data:a,error:i}=await r;if(i)throw i;const n={totalAllocations:(null==a?void 0:a.length)||0,activeAllocations:(null==a?void 0:a.filter((e=>"active"===e.status)).length)||0,totalRevenue:(null==a?void 0:a.reduce(((e,t)=>e+(t.current_revenue||0)),0))||0,revenueChange:12.3,totalCustomers:(null==a?void 0:a.reduce(((e,t)=>e+(t.total_customers||0)),0))||0,avgDuration:30};e({allocations:a||[],stats:n,error:null})}catch(s){e({error:s})}finally{e({loading:!1})}},setFilters:s=>{e((e=>({filters:{...e.filters,...s}}))),t().fetchAllocations()}}))?An(En):An;var En;const On=Oi("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),$n=te.forwardRef((({className:t,...s},r)=>e.jsx(T,{ref:r,className:Ai(On(),t),...s})));$n.displayName=T.displayName;const Rn=te.forwardRef((({className:t,...s},r)=>e.jsx(A,{ref:r,className:Ai("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...s,children:e.jsx(P,{className:Ai("flex items-center justify-center text-current"),children:e.jsx(Hr,{className:"h-4 w-4"})})})));function Dn({allocation:t,onClose:s,isOpen:r}){const a=ae(),[i,n]=ne.useState(t?`Copy of ${t.name}`:""),[o,l]=ne.useState(!1),[c,d]=ne.useState({duplicateProducts:!0,duplicateTiers:!0,duplicateCustomers:!1,duplicateDiscounts:!0,duplicateMessages:!0});if(!r)return null;return e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm",children:e.jsxs("div",{className:"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(sa,{className:"w-5 h-5"}),e.jsx("h2",{className:"text-lg font-semibold",children:"Duplicate Allocation"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"name",children:"New Allocation Name"}),e.jsx(Gi,{id:"name",value:i,onChange:e=>n(e.target.value),placeholder:"Enter allocation name"})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsx($n,{children:"What to duplicate?"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rn,{id:"products",checked:c.duplicateProducts,onCheckedChange:e=>d((t=>({...t,duplicateProducts:e})))}),e.jsx($n,{htmlFor:"products",children:"Products and configurations"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rn,{id:"tiers",checked:c.duplicateTiers,onCheckedChange:e=>d((t=>({...t,duplicateTiers:e})))}),e.jsx($n,{htmlFor:"tiers",children:"Tiers and tier settings"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rn,{id:"customers",checked:c.duplicateCustomers,onCheckedChange:e=>d((t=>({...t,duplicateCustomers:e})))}),e.jsx($n,{htmlFor:"customers",children:"Customer assignments"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rn,{id:"discounts",checked:c.duplicateDiscounts,onCheckedChange:e=>d((t=>({...t,duplicateDiscounts:e})))}),e.jsx($n,{htmlFor:"discounts",children:"Discounts and pricing"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rn,{id:"messages",checked:c.duplicateMessages,onCheckedChange:e=>d((t=>({...t,duplicateMessages:e})))}),e.jsx($n,{htmlFor:"messages",children:"Messages and notifications"})]})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx(Ri,{variant:"outline",onClick:s,children:"Cancel"}),e.jsx(Ri,{onClick:async()=>{try{l(!0);const{data:e,error:s}=await Rr.from("allocations").insert({name:i,status:"draft",start_date:null==t?void 0:t.start_date,end_date:null==t?void 0:t.end_date,allocation_type:null==t?void 0:t.allocation_type,title:c.duplicateMessages?null==t?void 0:t.title:null,message:c.duplicateMessages?null==t?void 0:t.message:null,confirmation_message:c.duplicateMessages?null==t?void 0:t.confirmation_message:null,cart_min:null==t?void 0:t.cart_min,cart_max:null==t?void 0:t.cart_max,min_amount:null==t?void 0:t.min_amount,order_discount_type:c.duplicateDiscounts?null==t?void 0:t.order_discount_type:null,order_discount_amount:c.duplicateDiscounts?null==t?void 0:t.order_discount_amount:null,shipping_discount_type:c.duplicateDiscounts?null==t?void 0:t.shipping_discount_type:null,shipping_discount_amount:c.duplicateDiscounts?null==t?void 0:t.shipping_discount_amount:null,shipping_discount_method:c.duplicateDiscounts?null==t?void 0:t.shipping_discount_method:null}).select().single();if(s)throw s;if(c.duplicateProducts&&t){const{data:s}=await Rr.from("allocation_products").select("*").eq("allocation_id",t.id);if(s&&s.length>0){const t=s.map((t=>({...t,id:void 0,allocation_id:e.id,created_at:void 0,updated_at:void 0}))),{error:r}=await Rr.from("allocation_products").insert(t);if(r)throw r}}if(c.duplicateTiers&&t&&"tier"===t.allocation_type){const{data:s}=await Rr.from("allocation_tiers").select("*").eq("allocation_id",t.id);if(s&&s.length>0){const r=s.map((t=>({...t,id:void 0,allocation_id:e.id,created_at:void 0}))),{error:a}=await Rr.from("allocation_tiers").insert(r);if(a)throw a;if(c.duplicateCustomers){const{data:s}=await Rr.from("customer_tiers").select("*").eq("allocation_id",t.id);if(s&&s.length>0){const t=s.map((t=>({...t,id:void 0,allocation_id:e.id,created_at:void 0}))),{error:r}=await Rr.from("customer_tiers").insert(t);if(r)throw r}}}}a(`/allocations/${e.id}`)}catch(e){}finally{l(!1),s()}},disabled:!i.trim()||o,children:o?"Duplicating...":"Duplicate Allocation"})]})]})})}function In(){const t=ae(),{allocations:s,stats:r,filters:a,loading:i,fetchAllocations:n,setFilters:o}=Pn(),[l,c]=te.useState(!1),[d,u]=te.useState(null);te.useEffect((()=>{n()}),[n]);return i?e.jsx("div",{className:"flex items-center justify-center h-96",children:"Loading..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:"Allocations"}),e.jsx("p",{className:"mt-1 text-gray-500",children:"Manage your wine allocations"})]}),e.jsx(Ri,{size:"lg",onClick:()=>t("/allocations/new"),children:"Create Allocation"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Oa,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Total Allocations"})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-2xl font-semibold",children:r.totalAllocations}),e.jsxs("span",{className:"text-sm text-gray-500",children:[r.activeAllocations," active"]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(aa,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Total Revenue"})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-2xl font-semibold",children:["$",(r.totalRevenue/1e6).toFixed(1),"M"]}),e.jsxs("span",{className:"text-sm text-green-600",children:["+",r.revenueChange,"% from last year"]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Ea,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Total Customers"})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-2xl font-semibold",children:r.totalCustomers.toLocaleString()}),e.jsx("span",{className:"text-sm text-gray-500",children:"Across all allocations"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Jr,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Avg. Duration"})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-2xl font-semibold",children:[r.avgDuration," days"]}),e.jsx("span",{className:"text-sm text-gray-500",children:"Per allocation"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Filters"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs(Wi,{value:a.status,onValueChange:e=>o({status:e}),children:[e.jsx(Hi,{children:e.jsx(Ji,{placeholder:"Select status"})}),e.jsxs(Qi,{children:[e.jsx(Xi,{value:"all",children:"All Statuses"}),e.jsx(Xi,{value:"open",children:"Open"}),e.jsx(Xi,{value:"upcoming",children:"Upcoming"}),e.jsx(Xi,{value:"previous",children:"Previous"})]})]}),e.jsx(Gi,{placeholder:"Filter by product",value:a.product,onChange:e=>o({product:e.target.value})}),e.jsx(Gi,{type:"date",value:a.date,onChange:e=>o({date:e.target.value})})]})]}),e.jsxs("div",{className:"space-y-4",children:[s.map((t=>e.jsx(qn,{id:t.id,name:t.name,status:t.status,dateRange:`${new Date(t.start_date).toLocaleDateString()} - ${new Date(t.end_date).toLocaleDateString()}`,progress:Mn(t),customers:t.total_customers,revenue:t.current_revenue,products:t.allocation_products.map((e=>e.product_id)),type:t.allocation_type,onDuplicate:()=>(e=>{u(e),c(!0)})(t)},t.id))),0===s.length&&e.jsx("div",{className:"text-center py-12 bg-white rounded-lg border",children:e.jsx("p",{className:"text-gray-500",children:"No allocations found"})})]}),e.jsx(Dn,{allocation:d,isOpen:l,onClose:()=>{c(!1),u(null)}})]})}function Mn(e){const t=new Date(e.start_date).getTime(),s=new Date(e.end_date).getTime(),r=Date.now();if(r<t)return 0;if(r>s)return 100;const a=s-t,i=r-t;return Math.round(i/a*100)}function qn({id:t,name:s,status:r,dateRange:a,progress:i,customers:n,revenue:o,products:l,type:c,onDuplicate:d}){const u=ae();return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("h3",{className:"text-xl font-semibold",children:s}),e.jsx("span",{className:`inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ${{upcoming:"bg-yellow-100 text-yellow-800",open:"bg-green-100 text-green-800",previous:"bg-blue-100 text-blue-800"}[r]}`,children:r.charAt(0).toUpperCase()+r.slice(1)})]}),e.jsx("p",{className:"text-sm text-gray-500 mt-1",children:a})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(Ri,{variant:"outline",size:"sm",onClick:d,children:[e.jsx(sa,{className:"w-4 h-4 mr-2"}),"Duplicate"]}),e.jsx(Ri,{variant:"outline",onClick:()=>{switch(r){case"open":u(`/allocations/${t}/open`);break;case"previous":u(`/allocations/${t}/previous`);break;default:u(`/allocations/${t}`)}},children:"View Details"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Allocation Progress"}),e.jsxs("span",{className:"text-sm font-medium",children:[i,"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-600 rounded-full",style:{width:`${i}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Customers"}),e.jsx("p",{className:"text-lg font-medium",children:(null==n?void 0:n.toLocaleString())||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Revenue"}),e.jsxs("p",{className:"text-lg font-medium",children:["$",(o||0).toLocaleString(void 0,{minimumFractionDigits:2})]})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Products"}),e.jsx("div",{className:"mt-1 flex flex-wrap gap-2",children:l.map((t=>e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:t},t)))})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Type"}),e.jsx("p",{className:"text-sm font-medium mt-1",children:c.charAt(0).toUpperCase()+c.slice(1)})]})]})]})}Rn.displayName=A.displayName;const Ln=te.forwardRef((({className:t,...s},r)=>e.jsx(E,{className:Ai("grid gap-2",t),...s,ref:r})));Ln.displayName=E.displayName;const Fn=te.forwardRef((({className:t,...s},r)=>e.jsx(O,{ref:r,className:Ai("aspect-square h-4 w-4 rounded-full border border-primary text-primary ring-offset-background focus:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),...s,children:e.jsx($,{className:"flex items-center justify-center",children:e.jsx(ea,{className:"h-2.5 w-2.5 fill-current text-current"})})})));function zn({data:t,onUpdate:s}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium",children:"Basic Information"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Set up the fundamental details of your allocation."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"name",children:"Allocation Name"}),e.jsx(Gi,{id:"name",value:t.name||"",onChange:e=>s({...t,name:e.target.value}),placeholder:"Fall 2024 Release"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"startDate",children:"Start Date"}),e.jsx(Gi,{type:"datetime-local",id:"startDate",value:t.startDate||"",onChange:e=>s({...t,startDate:e.target.value})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"endDate",children:"End Date"}),e.jsx(Gi,{type:"datetime-local",id:"endDate",value:t.endDate||"",onChange:e=>s({...t,endDate:e.target.value})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx($n,{children:"Allocation Type"}),e.jsxs(Ln,{value:t.allocationType,onValueChange:e=>s({...t,allocationType:e}),className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx(Fn,{value:"individual",id:"individual",className:"mt-1"}),e.jsxs("div",{children:[e.jsx($n,{htmlFor:"individual",className:"font-medium",children:"Individual"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Customize allocations for each customer individually"})]})]}),e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx(Fn,{value:"tier",id:"tier",className:"mt-1"}),e.jsxs("div",{children:[e.jsx($n,{htmlFor:"tier",className:"font-medium",children:"Tier-based"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Group customers into tiers with shared allocation settings"})]})]})]})]})]})]})}Fn.displayName=O.displayName;const Vn=te.forwardRef((({className:t,...s},r)=>e.jsx("textarea",{className:Ai("flex min-h-[60px] w-full rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...s})));function Un({data:t,onUpdate:s}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium",children:"Allocation Messaging"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Configure the messages your customers will see during the allocation."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"title",children:"Allocation Title"}),e.jsx(Gi,{id:"title",value:t.title||"",onChange:e=>s({...t,title:e.target.value}),placeholder:"Fall 2024 Wine Release"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"message",children:"Allocation Message"}),e.jsx(Vn,{id:"message",rows:4,value:t.message||"",onChange:e=>s({...t,message:e.target.value}),placeholder:"Welcome to our Fall 2024 allocation..."})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"confirmationMessage",children:"Purchase Confirmation Message"}),e.jsx(Vn,{id:"confirmationMessage",rows:4,value:t.confirmationMessage||"",onChange:e=>s({...t,confirmationMessage:e.target.value}),placeholder:"Thank you for your purchase..."})]})]})]})}function Zn({data:t,onUpdate:s}){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium",children:"Purchase Requirements"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Set the purchase limits and requirements for this allocation."}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-md",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Note: These settings can be customized at the tier level later."})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"cartMin",children:"Cart Minimum (bottles)"}),e.jsx(Gi,{type:"number",id:"cartMin",min:"0",value:t.cartMin||"",onChange:e=>s({...t,cartMin:parseInt(e.target.value)})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"cartMax",children:"Cart Maximum (bottles)"}),e.jsx(Gi,{type:"number",id:"cartMax",min:"0",value:t.cartMax||"",onChange:e=>s({...t,cartMax:parseInt(e.target.value)})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"minAmount",children:"Minimum Dollar Amount"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),e.jsx(Gi,{type:"number",id:"minAmount",min:"0",step:"0.01",value:t.minAmount||"",onChange:e=>s({...t,minAmount:parseFloat(e.target.value)}),className:"pl-7",placeholder:"0.00"})]})]})]})]})}Vn.displayName="Textarea";const Bn=[{id:"ground",name:"Ground Shipping"},{id:"2day",name:"2-Day Air"},{id:"overnight",name:"Overnight"}];function Gn({data:t,onUpdate:s}){var r,a,i,n,o,l,c,d,u,h,m,p,x;const[g,f]=te.useState(!!t.orderDiscount),[v,y]=te.useState(!!t.shippingDiscount);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium",children:"Discount Settings"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Configure order and shipping discounts for this allocation."}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-md",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Note: These settings can be customized at the tier level later."})})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rn,{id:"hasOrderDiscount",checked:g,onCheckedChange:e=>{f(e),e||s({...t,orderDiscount:void 0})}}),e.jsx($n,{htmlFor:"hasOrderDiscount",children:"Enable Order Discount"})]}),g&&e.jsxs("div",{className:"ml-6 space-y-4",children:[e.jsxs(Ln,{value:null==(r=t.orderDiscount)?void 0:r.type,onValueChange:e=>{var r;return s({...t,orderDiscount:{type:e,amount:(null==(r=t.orderDiscount)?void 0:r.amount)||0}})},className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fn,{value:"percentage",id:"orderDiscountPercentage"}),e.jsx($n,{htmlFor:"orderDiscountPercentage",children:"Percentage"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fn,{value:"fixed",id:"orderDiscountFixed"}),e.jsx($n,{htmlFor:"orderDiscountFixed",children:"Fixed Amount"})]})]}),e.jsxs("div",{className:"relative w-48",children:["fixed"===(null==(a=t.orderDiscount)?void 0:a.type)&&e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),e.jsx(Gi,{type:"number",value:(null==(i=t.orderDiscount)?void 0:i.amount)||"",onChange:e=>{var r;return s({...t,orderDiscount:{type:(null==(r=t.orderDiscount)?void 0:r.type)||"percentage",amount:parseFloat(e.target.value)}})},className:"fixed"===(null==(n=t.orderDiscount)?void 0:n.type)?"pl-7":"",placeholder:"0",min:"0",step:"percentage"===(null==(o=t.orderDiscount)?void 0:o.type)?"1":"0.01"}),"percentage"===(null==(l=t.orderDiscount)?void 0:l.type)&&e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"%"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rn,{id:"hasShippingDiscount",checked:v,onCheckedChange:e=>{y(e),e||s({...t,shippingDiscount:void 0})}}),e.jsx($n,{htmlFor:"hasShippingDiscount",children:"Enable Shipping Discount"})]}),v&&e.jsxs("div",{className:"ml-6 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"shippingMethod",children:"Shipping Method"}),e.jsxs(Wi,{value:(null==(c=t.shippingDiscount)?void 0:c.method)||"",onValueChange:e=>{var r,a;return s({...t,shippingDiscount:{type:(null==(r=t.shippingDiscount)?void 0:r.type)||"percentage",amount:(null==(a=t.shippingDiscount)?void 0:a.amount)||0,method:e}})},children:[e.jsx(Hi,{className:"w-full",children:e.jsx(Ji,{placeholder:"Select a shipping method"})}),e.jsx(Qi,{children:Bn.map((t=>e.jsx(Xi,{value:t.id,children:t.name},t.id)))})]})]}),e.jsxs(Ln,{value:null==(d=t.shippingDiscount)?void 0:d.type,onValueChange:e=>{var r,a;return s({...t,shippingDiscount:{type:e,amount:(null==(r=t.shippingDiscount)?void 0:r.amount)||0,method:(null==(a=t.shippingDiscount)?void 0:a.method)||""}})},className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fn,{value:"percentage",id:"shippingDiscountPercentage"}),e.jsx($n,{htmlFor:"shippingDiscountPercentage",children:"Percentage"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fn,{value:"fixed",id:"shippingDiscountFixed"}),e.jsx($n,{htmlFor:"shippingDiscountFixed",children:"Fixed Amount"})]})]}),e.jsxs("div",{className:"relative w-48",children:["fixed"===(null==(u=t.shippingDiscount)?void 0:u.type)&&e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),e.jsx(Gi,{type:"number",value:(null==(h=t.shippingDiscount)?void 0:h.amount)||"",onChange:e=>{var r,a;return s({...t,shippingDiscount:{type:(null==(r=t.shippingDiscount)?void 0:r.type)||"percentage",amount:parseFloat(e.target.value),method:(null==(a=t.shippingDiscount)?void 0:a.method)||""}})},className:"fixed"===(null==(m=t.shippingDiscount)?void 0:m.type)?"pl-7":"",placeholder:"0",min:"0",step:"percentage"===(null==(p=t.shippingDiscount)?void 0:p.type)?"1":"0.01"}),"percentage"===(null==(x=t.shippingDiscount)?void 0:x.type)&&e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"%"})]})]})]})]})]})}class Wn extends Error{constructor(e,t,s){super(e),this.status=t,this.statusText=s,this.name="ApiError"}}class Jn{constructor(e){this.authToken=e}async request(e,t={}){const s={"X-Auth-Token":this.authToken,...t.headers};return async function(e,t={}){var s,r;try{const a=`https://cors-anywhere.herokuapp.com/https://api.securecheckout.com/v1/reporting${e.startsWith("/")?e:`/${e}`}`,i=await fetch(a,{...t,headers:{"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",Origin:window.location.origin,"X-Auth-Token":null==(s=t.headers)?void 0:s["X-Auth-Token"],...t.headers},mode:"cors",credentials:"omit"});if(403===i.status&&(await i.text()).includes("cors-anywhere"))throw new Wn("CORS proxy access not enabled. Please visit https://cors-anywhere.herokuapp.com/corsdemo to enable temporary access.",403,"Forbidden");if(!i.ok){const e=i.headers.get("content-type");let t=i.statusText;if(null==e?void 0:e.includes("application/json"))try{const e=await i.json();t=(null==(r=e.error)?void 0:r.message)||e.message||t}catch{}throw new Wn(`API request failed: ${t}`,i.status,i.statusText)}const n=i.headers.get("content-type");if(null==n?void 0:n.includes("application/json")){const e=await i.json();if(e.error)throw new Wn(e.error.message||"API Error",e.error.code||i.status);return e}return null}catch(a){if(a instanceof TypeError&&"Failed to fetch"===a.message)throw new Wn("Network error - unable to reach API. Please check your internet connection and try again.",0,"Network Error");if(a instanceof Wn)throw a;throw new Wn(a instanceof Error?a.message:"An unknown error occurred",500,"Internal Error")}}(e,{...t,headers:s})}async getAddress(e){return this.request(`/addresses/${e}`)}async getAddresses(e,t){return this.request(`/addresses/${e}/${t}`)}async getCategory(e){return this.request(`/categories/${e}`)}async getCategories(){return this.request("/categories")}async getCategoryProducts(e){return this.request(`/categories/${e}/products`)}async getClubMembers(){return this.request("/club-members")}async getClubMember(e){return this.request(`/club-members/${e}`)}async getClub(e){return this.request(`/clubs/${e}`)}async getClubs(){return this.request("/clubs")}async getCustomer(e){return this.request(`/customers/${e}`)}async getCustomersByLastUpdate(e,t,s,r){return this.request(`/customers/last-update/${e}/${t}/${s}/${r}`)}async getCustomersBySignup(e,t,s,r){return this.request(`/customers/created/${e}/${t}/${s}/${r}`)}async getCustomersInGroup(e){return this.request(`/customers/groups/${e}`)}async getGroups(){return this.request("/groups")}async getGroup(e){return this.request(`/groups/${e}`)}async getInventoryLevels(){return this.request("/inventory")}async getInventoryMovements(e,t){return this.request(`/inventory/transactions/${e}/${t}`)}async getUnshippedInventory(){return this.request("/inventory/allocated")}async getOrder(e){return this.request(`/orders/${e}`)}async getOrderPackages(e){return this.request(`/orders/${e}/packages`)}async getOrdersByCreation(e,t){return this.request(`/orders/created/${e}/${t}`)}async getOrdersByLastUpdate(e,t,s,r){return this.request(`/orders/last-update/${e}/${t}/${s}/${r}`)}async getOrdersByType(e,t,s){return this.request(`/orders/type/${e}/${t}/${s}`)}async getOrdersForAccounting(e,t){return this.request(`/orders/nav/${e}/${t}`)}async getProductTransactions(e,t){return this.request(`/orders/product-transactions/${e}/${t}`)}async getPaymentTransactions(e,t){return this.request(`/orders/payment-transactions/${e}/${t}`)}async getProduct(e){return this.request(`/products/${e}`)}async getArchivedProducts(){return this.request("/products/archived")}async getAvailableProducts(){return this.request("/products")}async getActiveWishes(){return this.request("/wishes")}}const Hn={reportingApiKey:"",managementUsername:"",managementAccount:"",managementAccountName:"",managementAuthToken:""};function Kn(){const[e,t]=te.useState((()=>{const e=localStorage.getItem("apiSettings");return e?JSON.parse(e):Hn}));te.useEffect((()=>{const e=localStorage.getItem("apiSettings");e&&t(JSON.parse(e))}),[]);return{settings:e,updateSettings:e=>{t((t=>({...t,...e})))},saveSettings:()=>{localStorage.setItem("apiSettings",JSON.stringify(e))},clearSettings:()=>{localStorage.removeItem("apiSettings"),t(Hn)}}}const Yn=3e5;function Qn(){const{settings:e}=Kn(),[t,s]=te.useState(!1),[r,a]=te.useState(null),i=te.useRef(null),n=te.useRef(new Map),o=(l=e.reportingApiKey||"",new Jn(l));var l;te.useEffect((()=>()=>{i.current&&i.current.abort()}),[]);const c=te.useCallback((e=>{n.current.delete(e)}),[]),d=te.useCallback((()=>{n.current.clear()}),[]),u=te.useCallback((async(t,r={})=>{const{cacheKey:l,cacheDuration:c=Yn,forceRefresh:d=!1}=r;if(l&&!d){const e=n.current.get(l);if(e&&Date.now()-e.timestamp<c)return e.data}i.current&&i.current.abort(),i.current=new AbortController,s(!0),a(null);try{if(!e.reportingApiKey)throw new Error("API token is missing. Please configure it in the API Settings.");const s=await t(o);return l&&n.current.set(l,{data:s,timestamp:Date.now()}),s}catch(u){return u instanceof Wn?a({message:u.message,status:u.status,statusText:u.statusText,details:u}):u instanceof Error?a({message:u.message,details:u}):a({message:"An unknown error occurred",details:u}),null}finally{s(!1),i.current=null}}),[o,e.reportingApiKey]),h=te.useCallback((()=>{a(null)}),[]);return{client:o,loading:t,error:r,request:u,clearError:h,invalidateCache:c,clearCache:d}}function Xn({data:t,onUpdate:s}){const{request:r,loading:a,error:i}=Qn(),[n,o]=te.useState([]),[l,c]=te.useState(""),[d,u]=te.useState(!0),[h,m]=te.useState(null),p=te.useRef(!1);te.useEffect((()=>{if(p.current)return;(async()=>{try{u(!0),m(null);const e=await r((e=>e.getAvailableProducts()),{cacheKey:"available-products",cacheDuration:3e5});if(e){const t=Array.isArray(e)?e:Object.values(e);o(t)}else m("No products returned from API")}catch(e){m(e instanceof Error?e.message:"Failed to fetch products")}finally{u(!1),p.current=!0}})()}),[]);const x=(e,r)=>{const a=[...t.products||[]];a[e]={...a[e],...r},s({products:a})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium",children:"Product Selection"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Select products and configure their purchase limits."}),e.jsx("div",{className:"mt-2 p-4 bg-muted/50 rounded-md",children:e.jsx("p",{className:"text-sm text-muted-foreground",children:"Note: These settings can be customized at the tier level later."})})]}),e.jsx("div",{className:"space-y-4",children:d?e.jsxs("div",{className:"flex items-center justify-center p-6 border rounded-lg",children:[e.jsx(ha,{className:"h-6 w-6 text-blue-600 animate-spin mr-2"}),e.jsx("span",{children:"Loading products..."})]}):h?e.jsxs("div",{className:"flex items-center p-6 border rounded-lg bg-red-50 text-red-700",children:[e.jsx(zr,{className:"h-6 w-6 mr-2"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Failed to load products"}),e.jsx("p",{className:"text-sm",children:h})]})]}):e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(Wi,{value:l,onValueChange:c,children:[e.jsx(Hi,{className:"flex-1",children:e.jsx(Ji,{placeholder:"Select a product"})}),e.jsx(Qi,{children:n.length>0?n.map((t=>e.jsxs(Xi,{value:t.id,children:[t.name," - $",parseFloat(t.price).toFixed(2)]},t.id))):e.jsx("div",{className:"py-2 px-2 text-sm text-muted-foreground text-center",children:"No products available"})})]}),e.jsx(Ri,{onClick:()=>{if(!l)return;const e=n.find((e=>e.id===l));if(!e)return;const r={id:e.id,name:e.name,price:parseFloat(e.price)||0,allowWishRequests:!1};s({products:[...t.products||[],r]}),c("")},disabled:!l,children:"Add Product"})]})}),e.jsxs("div",{className:"space-y-6",children:[(t.products||[]).map(((r,a)=>e.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:r.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Base Price: $",r.price.toFixed(2)]})]}),e.jsx(Ri,{variant:"ghost",onClick:()=>(e=>{const r=[...t.products||[]];r.splice(e,1),s({products:r})})(a),className:"text-destructive hover:text-destructive/90 hover:bg-destructive/10",children:"Remove"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Override Price"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),e.jsx(Gi,{type:"number",value:r.overridePrice||"",onChange:e=>x(a,{overridePrice:e.target.value?parseFloat(e.target.value):void 0}),className:"pl-7",placeholder:r.price.toString(),min:"0",step:"0.01"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Min Purchase"}),e.jsx(Gi,{type:"number",value:r.minPurchase||"",onChange:e=>x(a,{minPurchase:e.target.value?parseInt(e.target.value):void 0}),min:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Max Purchase"}),e.jsx(Gi,{type:"number",value:r.maxPurchase||"",onChange:e=>x(a,{maxPurchase:e.target.value?parseInt(e.target.value):void 0}),min:"0"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rn,{id:`wishRequests-${a}`,checked:r.allowWishRequests,onCheckedChange:e=>x(a,{allowWishRequests:e})}),e.jsx($n,{htmlFor:`wishRequests-${a}`,children:"Allow Wish Requests"})]}),r.allowWishRequests&&e.jsxs("div",{className:"ml-6 grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Min Wish Request"}),e.jsx(Gi,{type:"number",value:r.wishRequestMin||"",onChange:e=>x(a,{wishRequestMin:e.target.value?parseInt(e.target.value):void 0}),min:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Max Wish Request"}),e.jsx(Gi,{type:"number",value:r.wishRequestMax||"",onChange:e=>x(a,{wishRequestMax:e.target.value?parseInt(e.target.value):void 0}),min:"0"})]})]})]})]},`${r.id}-${a}`))),0===(t.products||[]).length&&!d&&e.jsx("div",{className:"text-center py-8 border rounded-lg",children:e.jsx("p",{className:"text-gray-500",children:"No products added yet. Select a product from the dropdown above."})})]})]})}const eo=[{title:"Basic Information",description:"Set allocation name and schedule",subtitle:"Configure the fundamental details of your allocation"},{title:"Messaging",description:"Configure customer communications",subtitle:"Set up the messages your customers will see"},{title:"Purchase Requirements",description:"Define purchase limits",subtitle:"Set minimum and maximum purchase requirements"},{title:"Discounts",description:"Set up pricing discounts",subtitle:"Configure order and shipping discounts"},{title:"Products",description:"Select available products",subtitle:"Choose and configure available products"}];function to(){const[t,s]=te.useState(0),[r,a]=te.useState({basicInfo:{name:"",startDate:"",endDate:"",allocationType:"individual"},messaging:{title:"",message:"",confirmationMessage:""},requirements:{cartMin:0,cartMax:0,minAmount:0},discounts:{orderDiscount:{type:"percentage",amount:0},shippingDiscount:{type:"percentage",amount:0,method:""}},products:[]}),i=ae(),n=(e,t)=>{a((s=>({...s,[e]:t})))};return e.jsxs("div",{className:"bg-card rounded-lg shadow-sm border",children:[e.jsx("div",{className:"border-b overflow-x-auto",children:e.jsx("div",{className:"px-4 md:px-6 py-4 min-w-[600px]",children:e.jsx("div",{className:"flex justify-between",children:eo.map(((s,r)=>e.jsxs("div",{className:"flex flex-col items-center flex-1",children:[e.jsx("div",{className:`\n                  w-8 h-8 rounded-full flex items-center justify-center\n                  ${r<=t?"bg-primary text-primary-foreground":"bg-muted text-muted-foreground"}\n                `,children:r+1}),e.jsx("div",{className:"mt-2 text-sm font-medium text-center",children:s.title}),e.jsx("div",{className:"text-xs text-muted-foreground text-center",children:s.description})]},s.title)))})})}),e.jsxs("div",{className:"p-4 md:p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h2",{className:"text-2xl font-semibold",children:eo[t].title}),e.jsx("p",{className:"mt-1 text-muted-foreground",children:eo[t].subtitle})]}),(()=>{switch(t){case 0:return e.jsx(zn,{data:r.basicInfo,onUpdate:e=>n("basicInfo",e)});case 1:return e.jsx(Un,{data:r.messaging,onUpdate:e=>n("messaging",e)});case 2:return e.jsx(Zn,{data:r.requirements,onUpdate:e=>n("requirements",e)});case 3:return e.jsx(Gn,{data:r.discounts,onUpdate:e=>n("discounts",e)});case 4:return e.jsx(Xn,{data:r.products,onUpdate:e=>n("products",e)});default:return null}})()]}),e.jsxs("div",{className:"border-t px-4 md:px-6 py-4 flex justify-between",children:[e.jsx(Ri,{variant:"outline",onClick:()=>{t>0&&(s((e=>e-1)),window.scrollTo(0,0))},disabled:0===t,children:"Back"}),t===eo.length-1?e.jsx(Ri,{onClick:async()=>{var e,t,s,a,n;try{const{data:o,error:l}=await Rr.from("allocations").insert([{name:r.basicInfo.name,start_date:r.basicInfo.startDate,end_date:r.basicInfo.endDate,allocation_type:r.basicInfo.allocationType,status:"draft",title:r.messaging.title,message:r.messaging.message,confirmation_message:r.messaging.confirmationMessage,cart_min:r.requirements.cartMin,cart_max:r.requirements.cartMax,min_amount:r.requirements.minAmount,order_discount_type:null==(e=r.discounts.orderDiscount)?void 0:e.type,order_discount_amount:null==(t=r.discounts.orderDiscount)?void 0:t.amount,shipping_discount_type:null==(s=r.discounts.shippingDiscount)?void 0:s.type,shipping_discount_amount:null==(a=r.discounts.shippingDiscount)?void 0:a.amount,shipping_discount_method:null==(n=r.discounts.shippingDiscount)?void 0:n.method}]).select().single();if(l)throw l;if(r.products.length>0){const{error:e}=await Rr.from("allocation_products").insert(r.products.map((e=>({allocation_id:o.id,product_id:e.id,override_price:e.overridePrice,min_purchase:e.minPurchase,max_purchase:e.maxPurchase,allow_wish_requests:e.allowWishRequests,wish_request_min:e.wishRequestMin,wish_request_max:e.wishRequestMax,total_inventory:0,remaining_inventory:0}))));if(e)throw e}i(`/allocations/${o.id}`)}catch(o){}},children:"Create Allocation"}):e.jsx(Ri,{onClick:()=>{t<eo.length-1&&(s((e=>e+1)),window.scrollTo(0,0))},children:"Continue"})]})]})}function so(){const t=ae();return e.jsxs("div",{className:"max-w-4xl mx-auto space-y-6",children:[e.jsx("div",{className:"flex items-center gap-4 mb-8",children:e.jsxs("button",{onClick:()=>t("/allocations"),className:"text-gray-600 hover:text-gray-900 flex items-center gap-1",children:[e.jsx(Ur,{size:16}),"Back to Allocations"]})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:"Create New Allocation"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Configure your allocation settings through this step-by-step wizard."})]}),e.jsx(to,{})]})}function ro(){const{id:e}=oe(),[t,s]=te.useState(null),[r,a]=te.useState(!0),[i,n]=te.useState(null);return te.useEffect((()=>{let t=!0;return async function(){try{if(a(!0),n(null),!e)throw new Error("Allocation ID is required");const{data:r,error:i}=await Rr.from("allocations").select("\n            *,\n            allocation_products (\n              id,\n              product_id,\n              total_inventory,\n              remaining_inventory\n            ),\n            allocation_tiers (\n              id,\n              name,\n              level,\n              customer_count\n            )\n          ").eq("id",e).single();if(i)throw i;if(!r)throw new Error("Allocation not found");t&&(s(r),n(null))}catch(r){t&&(n(r instanceof Error?r:new Error("Failed to fetch allocation")),s(null))}finally{t&&a(!1)}}(),()=>{t=!1}}),[e]),{allocation:t,loading:r,error:i}}var ao=e=>"checkbox"===e.type,io=e=>e instanceof Date,no=e=>null==e;const oo=e=>"object"==typeof e;var lo=e=>!no(e)&&!Array.isArray(e)&&oo(e)&&!io(e),co="undefined"!=typeof window&&void 0!==window.HTMLElement&&"undefined"!=typeof document;function uo(e){let t;const s=Array.isArray(e),r="undefined"!=typeof FileList&&e instanceof FileList;if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else{if(co&&(e instanceof Blob||r)||!s&&!lo(e))return e;if(t=s?[]:{},s||(e=>{const t=e.constructor&&e.constructor.prototype;return lo(t)&&t.hasOwnProperty("isPrototypeOf")})(e))for(const s in e)e.hasOwnProperty(s)&&(t[s]=uo(e[s]));else t=e}return t}var ho=e=>Array.isArray(e)?e.filter(Boolean):[],mo=e=>void 0===e,po=(e,t,s)=>{if(!t||!lo(e))return s;const r=ho(t.split(/[,[\].]+?/)).reduce(((e,t)=>no(e)?e:e[t]),e);return mo(r)||r===e?mo(e[t])?s:e[t]:r},xo=e=>"boolean"==typeof e,go=e=>/^\w*$/.test(e),fo=e=>ho(e.replace(/["|']|\]/g,"").split(/\.|\[/)),vo=(e,t,s)=>{let r=-1;const a=go(t)?[t]:fo(t),i=a.length,n=i-1;for(;++r<i;){const t=a[r];let i=s;if(r!==n){const s=e[t];i=lo(s)||Array.isArray(s)?s:isNaN(+a[r+1])?{}:[]}if("__proto__"===t||"constructor"===t||"prototype"===t)return;e[t]=i,e=e[t]}return e};const yo="blur",jo="focusout",bo="onBlur",wo="onChange",No="onSubmit",_o="onTouched",ko="all",So="max",Co="min",To="maxLength",Ao="minLength",Po="pattern",Eo="required",Oo="validate";ne.createContext(null);var $o=e=>lo(e)&&!Object.keys(e).length,Ro=e=>Array.isArray(e)?e:[e];var Do=e=>"string"==typeof e,Io=(e,t,s,r,a)=>t?{...s[e],types:{...s[e]&&s[e].types?s[e].types:{},[r]:a||!0}}:{},Mo=e=>({isOnSubmit:!e||e===No,isOnBlur:e===bo,isOnChange:e===wo,isOnAll:e===ko,isOnTouch:e===_o}),qo=(e,t,s)=>!s&&(t.watchAll||t.watch.has(e)||[...t.watch].some((t=>e.startsWith(t)&&/^\.\w+/.test(e.slice(t.length)))));const Lo=(e,t,s,r)=>{for(const a of s||Object.keys(e)){const s=po(e,a);if(s){const{_f:e,...i}=s;if(e){if(e.refs&&e.refs[0]&&t(e.refs[0],a)&&!r)return!0;if(e.ref&&t(e.ref,e.name)&&!r)return!0;if(Lo(i,t))break}else if(lo(i)&&Lo(i,t))break}}};var Fo=(e,t,s)=>{const r=Ro(po(e,s));return vo(r,"root",t[s]),vo(e,s,r),e},zo=e=>"file"===e.type,Vo=e=>"function"==typeof e,Uo=e=>{if(!co)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},Zo=e=>Do(e),Bo=e=>"radio"===e.type,Go=e=>e instanceof RegExp;const Wo={value:!1,isValid:!1},Jo={value:!0,isValid:!0};var Ho=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter((e=>e&&e.checked&&!e.disabled)).map((e=>e.value));return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!mo(e[0].attributes.value)?mo(e[0].value)||""===e[0].value?Jo:{value:e[0].value,isValid:!0}:Jo:Wo}return Wo};const Ko={isValid:!1,value:null};var Yo=e=>Array.isArray(e)?e.reduce(((e,t)=>t&&t.checked&&!t.disabled?{isValid:!0,value:t.value}:e),Ko):Ko;function Qo(e,t,s="validate"){if(Zo(e)||Array.isArray(e)&&e.every(Zo)||xo(e)&&!e)return{type:s,message:Zo(e)?e:"",ref:t}}var Xo=e=>lo(e)&&!Go(e)?e:{value:e,message:""},el=async(e,t,s,r,a,i)=>{const{ref:n,refs:o,required:l,maxLength:c,minLength:d,min:u,max:h,pattern:m,validate:p,name:x,valueAsNumber:g,mount:f}=e._f,v=po(s,x);if(!f||t.has(x))return{};const y=o?o[0]:n,j=e=>{a&&y.reportValidity&&(y.setCustomValidity(xo(e)?"":e||""),y.reportValidity())},b={},w=Bo(n),N=ao(n),_=w||N,k=(g||zo(n))&&mo(n.value)&&mo(v)||Uo(n)&&""===n.value||""===v||Array.isArray(v)&&!v.length,S=Io.bind(null,x,r,b),C=(e,t,s,r=To,a=Ao)=>{const i=e?t:s;b[x]={type:e?r:a,message:i,ref:n,...S(e?r:a,i)}};if(i?!Array.isArray(v)||!v.length:l&&(!_&&(k||no(v))||xo(v)&&!v||N&&!Ho(o).isValid||w&&!Yo(o).isValid)){const{value:e,message:t}=Zo(l)?{value:!!l,message:l}:Xo(l);if(e&&(b[x]={type:Eo,message:t,ref:y,...S(Eo,t)},!r))return j(t),b}if(!(k||no(u)&&no(h))){let e,t;const s=Xo(h),a=Xo(u);if(no(v)||isNaN(v)){const r=n.valueAsDate||new Date(v),i=e=>new Date((new Date).toDateString()+" "+e),o="time"==n.type,l="week"==n.type;Do(s.value)&&v&&(e=o?i(v)>i(s.value):l?v>s.value:r>new Date(s.value)),Do(a.value)&&v&&(t=o?i(v)<i(a.value):l?v<a.value:r<new Date(a.value))}else{const r=n.valueAsNumber||(v?+v:v);no(s.value)||(e=r>s.value),no(a.value)||(t=r<a.value)}if((e||t)&&(C(!!e,s.message,a.message,So,Co),!r))return j(b[x].message),b}if((c||d)&&!k&&(Do(v)||i&&Array.isArray(v))){const e=Xo(c),t=Xo(d),s=!no(e.value)&&v.length>+e.value,a=!no(t.value)&&v.length<+t.value;if((s||a)&&(C(s,e.message,t.message),!r))return j(b[x].message),b}if(m&&!k&&Do(v)){const{value:e,message:t}=Xo(m);if(Go(e)&&!v.match(e)&&(b[x]={type:Po,message:t,ref:n,...S(Po,t)},!r))return j(t),b}if(p)if(Vo(p)){const e=Qo(await p(v,s),y);if(e&&(b[x]={...e,...S(Oo,e.message)},!r))return j(e.message),b}else if(lo(p)){let e={};for(const t in p){if(!$o(e)&&!r)break;const a=Qo(await p[t](v,s),y,t);a&&(e={...a,...S(t,a.message)},j(a.message),r&&(b[x]=e))}if(!$o(e)&&(b[x]={ref:y,...e},!r))return b}return j(!0),b};function tl(e,t){const s=Array.isArray(t)?t:go(t)?[t]:fo(t),r=1===s.length?e:function(e,t){const s=t.slice(0,-1).length;let r=0;for(;r<s;)e=mo(e)?r++:e[t[r++]];return e}(e,s),a=s.length-1,i=s[a];return r&&delete r[i],0!==a&&(lo(r)&&$o(r)||Array.isArray(r)&&function(e){for(const t in e)if(e.hasOwnProperty(t)&&!mo(e[t]))return!1;return!0}(r))&&tl(e,s.slice(0,-1)),e}var sl=()=>{let e=[];return{get observers(){return e},next:t=>{for(const s of e)s.next&&s.next(t)},subscribe:t=>(e.push(t),{unsubscribe:()=>{e=e.filter((e=>e!==t))}}),unsubscribe:()=>{e=[]}}},rl=e=>no(e)||!oo(e);function al(e,t){if(rl(e)||rl(t))return e===t;if(io(e)&&io(t))return e.getTime()===t.getTime();const s=Object.keys(e),r=Object.keys(t);if(s.length!==r.length)return!1;for(const a of s){const s=e[a];if(!r.includes(a))return!1;if("ref"!==a){const e=t[a];if(io(s)&&io(e)||lo(s)&&lo(e)||Array.isArray(s)&&Array.isArray(e)?!al(s,e):s!==e)return!1}}return!0}var il=e=>"select-multiple"===e.type,nl=e=>Uo(e)&&e.isConnected,ol=e=>{for(const t in e)if(Vo(e[t]))return!0;return!1};function ll(e,t={}){const s=Array.isArray(e);if(lo(e)||s)for(const r in e)Array.isArray(e[r])||lo(e[r])&&!ol(e[r])?(t[r]=Array.isArray(e[r])?[]:{},ll(e[r],t[r])):no(e[r])||(t[r]=!0);return t}function cl(e,t,s){const r=Array.isArray(e);if(lo(e)||r)for(const a in e)Array.isArray(e[a])||lo(e[a])&&!ol(e[a])?mo(t)||rl(s[a])?s[a]=Array.isArray(e[a])?ll(e[a],[]):{...ll(e[a])}:cl(e[a],no(t)?{}:t[a],s[a]):s[a]=!al(e[a],t[a]);return s}var dl=(e,t)=>cl(e,t,ll(t)),ul=(e,{valueAsNumber:t,valueAsDate:s,setValueAs:r})=>mo(e)?e:t?""===e?NaN:e?+e:e:s&&Do(e)?new Date(e):r?r(e):e;function hl(e){const t=e.ref;return zo(t)?t.files:Bo(t)?Yo(e.refs).value:il(t)?[...t.selectedOptions].map((({value:e})=>e)):ao(t)?Ho(e.refs).value:ul(mo(t.value)?e.ref.value:t.value,e)}var ml=e=>mo(e)?e:Go(e)?e.source:lo(e)?Go(e.value)?e.value.source:e.value:e;const pl="AsyncFunction";function xl(e,t,s){const r=po(e,s);if(r||go(s))return{error:r,name:s};const a=s.split(".");for(;a.length;){const r=a.join("."),i=po(t,r),n=po(e,r);if(i&&!Array.isArray(i)&&s!==r)return{name:s};if(n&&n.type)return{name:r,error:n};a.pop()}return{name:s}}const gl={mode:No,reValidateMode:wo,shouldFocusError:!0};function fl(e={}){let t,s={...gl,...e},r={submitCount:0,isDirty:!1,isLoading:Vo(s.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},validatingFields:{},errors:s.errors||{},disabled:s.disabled||!1},a={},i=(lo(s.defaultValues)||lo(s.values))&&uo(s.defaultValues||s.values)||{},n=s.shouldUnregister?{}:uo(i),o={action:!1,mount:!1,watch:!1},l={mount:new Set,disabled:new Set,unMount:new Set,array:new Set,watch:new Set},c=0;const d={isDirty:!1,dirtyFields:!1,validatingFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},u={values:sl(),array:sl(),state:sl()},h=Mo(s.mode),m=Mo(s.reValidateMode),p=s.criteriaMode===ko,x=async e=>{if(!s.disabled&&(d.isValid||e)){const e=s.resolver?$o((await j()).errors):await b(a,!0);e!==r.isValid&&u.state.next({isValid:e})}},g=(e,t)=>{s.disabled||!d.isValidating&&!d.validatingFields||((e||Array.from(l.mount)).forEach((e=>{e&&(t?vo(r.validatingFields,e,t):tl(r.validatingFields,e))})),u.state.next({validatingFields:r.validatingFields,isValidating:!$o(r.validatingFields)}))},f=(e,t,s,r)=>{const l=po(a,e);if(l){const a=po(n,e,mo(s)?po(i,e):s);mo(a)||r&&r.defaultChecked||t?vo(n,e,t?a:hl(l._f)):_(e,a),o.mount&&x()}},v=(e,t,n,o,l)=>{let c=!1,h=!1;const m={name:e};if(!s.disabled){const s=!!(po(a,e)&&po(a,e)._f&&po(a,e)._f.disabled);if(!n||o){d.isDirty&&(h=r.isDirty,r.isDirty=m.isDirty=w(),c=h!==m.isDirty);const a=s||al(po(i,e),t);h=!(s||!po(r.dirtyFields,e)),a||s?tl(r.dirtyFields,e):vo(r.dirtyFields,e,!0),m.dirtyFields=r.dirtyFields,c=c||d.dirtyFields&&h!==!a}if(n){const t=po(r.touchedFields,e);t||(vo(r.touchedFields,e,n),m.touchedFields=r.touchedFields,c=c||d.touchedFields&&t!==n)}c&&l&&u.state.next(m)}return c?m:{}},y=(e,a,i,n)=>{const o=po(r.errors,e),l=d.isValid&&xo(a)&&r.isValid!==a;var h;if(s.delayError&&i?(h=()=>((e,t)=>{vo(r.errors,e,t),u.state.next({errors:r.errors})})(e,i),t=e=>{clearTimeout(c),c=setTimeout(h,e)},t(s.delayError)):(clearTimeout(c),t=null,i?vo(r.errors,e,i):tl(r.errors,e)),(i?!al(o,i):o)||!$o(n)||l){const t={...n,...l&&xo(a)?{isValid:a}:{},errors:r.errors,name:e};r={...r,...t},u.state.next(t)}},j=async e=>{g(e,!0);const t=await s.resolver(n,s.context,((e,t,s,r)=>{const a={};for(const i of e){const e=po(t,i);e&&vo(a,i,e._f)}return{criteriaMode:s,names:[...e],fields:a,shouldUseNativeValidation:r}})(e||l.mount,a,s.criteriaMode,s.shouldUseNativeValidation));return g(e),t},b=async(e,t,a={valid:!0})=>{for(const o in e){const c=e[o];if(c){const{_f:e,...u}=c;if(e){const u=l.array.has(e.name),h=c._f&&(!!(i=c._f)&&!!i.validate&&!!(Vo(i.validate)&&i.validate.constructor.name===pl||lo(i.validate)&&Object.values(i.validate).find((e=>e.constructor.name===pl))));h&&d.validatingFields&&g([o],!0);const m=await el(c,l.disabled,n,p,s.shouldUseNativeValidation&&!t,u);if(h&&d.validatingFields&&g([o]),m[e.name]&&(a.valid=!1,t))break;!t&&(po(m,e.name)?u?Fo(r.errors,m,e.name):vo(r.errors,e.name,m[e.name]):tl(r.errors,e.name))}!$o(u)&&await b(u,t,a)}}var i;return a.valid},w=(e,t)=>!s.disabled&&(e&&t&&vo(n,e,t),!al(P(),i)),N=(e,t,s)=>((e,t,s,r,a)=>Do(e)?(r&&t.watch.add(e),po(s,e,a)):Array.isArray(e)?e.map((e=>(r&&t.watch.add(e),po(s,e)))):(r&&(t.watchAll=!0),s))(e,l,{...o.mount?n:mo(t)?i:Do(e)?{[e]:t}:t},s,t),_=(e,t,s={})=>{const r=po(a,e);let i=t;if(r){const s=r._f;s&&(!s.disabled&&vo(n,e,ul(t,s)),i=Uo(s.ref)&&no(t)?"":t,il(s.ref)?[...s.ref.options].forEach((e=>e.selected=i.includes(e.value))):s.refs?ao(s.ref)?s.refs.length>1?s.refs.forEach((e=>(!e.defaultChecked||!e.disabled)&&(e.checked=Array.isArray(i)?!!i.find((t=>t===e.value)):i===e.value))):s.refs[0]&&(s.refs[0].checked=!!i):s.refs.forEach((e=>e.checked=e.value===i)):zo(s.ref)?s.ref.value="":(s.ref.value=i,s.ref.type||u.values.next({name:e,values:{...n}})))}(s.shouldDirty||s.shouldTouch)&&v(e,i,s.shouldTouch,s.shouldDirty,!0),s.shouldValidate&&A(e)},k=(e,t,s)=>{for(const r in t){const i=t[r],n=`${e}.${r}`,o=po(a,n);(l.array.has(e)||lo(i)||o&&!o._f)&&!io(i)?k(n,i,s):_(n,i,s)}},S=(e,t,s={})=>{const c=po(a,e),h=l.array.has(e),m=uo(t);vo(n,e,m),h?(u.array.next({name:e,values:{...n}}),(d.isDirty||d.dirtyFields)&&s.shouldDirty&&u.state.next({name:e,dirtyFields:dl(i,n),isDirty:w(e,m)})):!c||c._f||no(m)?_(e,m,s):k(e,m,s),qo(e,l)&&u.state.next({...r}),u.values.next({name:o.mount?e:void 0,values:{...n}})},C=async e=>{o.mount=!0;const i=e.target;let c=i.name,f=!0;const w=po(a,c),N=()=>i.type?hl(w._f):(e=>lo(e)&&e.target?ao(e.target)?e.target.checked:e.target.value:e)(e),_=e=>{f=Number.isNaN(e)||io(e)&&isNaN(e.getTime())||al(e,po(n,c,e))};if(w){let i,o;const k=N(),S=e.type===yo||e.type===jo,C=!(e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate))(w._f)&&!s.resolver&&!po(r.errors,c)&&!w._f.deps||((e,t,s,r,a)=>!a.isOnAll&&(!s&&a.isOnTouch?!(t||e):(s?r.isOnBlur:a.isOnBlur)?!e:!(s?r.isOnChange:a.isOnChange)||e))(S,po(r.touchedFields,c),r.isSubmitted,m,h),T=qo(c,l,S);vo(n,c,k),S?(w._f.onBlur&&w._f.onBlur(e),t&&t(0)):w._f.onChange&&w._f.onChange(e);const P=v(c,k,S,!1),E=!$o(P)||T;if(!S&&u.values.next({name:c,type:e.type,values:{...n}}),C)return d.isValid&&("onBlur"===s.mode&&S?x():S||x()),E&&u.state.next({name:c,...T?{}:P});if(!S&&T&&u.state.next({...r}),s.resolver){const{errors:e}=await j([c]);if(_(k),f){const t=xl(r.errors,a,c),s=xl(e,a,t.name||c);i=s.error,c=s.name,o=$o(e)}}else g([c],!0),i=(await el(w,l.disabled,n,p,s.shouldUseNativeValidation))[c],g([c]),_(k),f&&(i?o=!1:d.isValid&&(o=await b(a,!0)));f&&(w._f.deps&&A(w._f.deps),y(c,o,i,P))}},T=(e,t)=>{if(po(r.errors,t)&&e.focus)return e.focus(),1},A=async(e,t={})=>{let i,n;const o=Ro(e);if(s.resolver){const t=await(async e=>{const{errors:t}=await j(e);if(e)for(const s of e){const e=po(t,s);e?vo(r.errors,s,e):tl(r.errors,s)}else r.errors=t;return t})(mo(e)?e:o);i=$o(t),n=e?!o.some((e=>po(t,e))):i}else e?(n=(await Promise.all(o.map((async e=>{const t=po(a,e);return await b(t&&t._f?{[e]:t}:t)})))).every(Boolean),(n||r.isValid)&&x()):n=i=await b(a);return u.state.next({...!Do(e)||d.isValid&&i!==r.isValid?{}:{name:e},...s.resolver||!e?{isValid:i}:{},errors:r.errors}),t.shouldFocus&&!n&&Lo(a,T,e?o:l.mount),n},P=e=>{const t={...o.mount?n:i};return mo(e)?t:Do(e)?po(t,e):e.map((e=>po(t,e)))},E=(e,t)=>({invalid:!!po((t||r).errors,e),isDirty:!!po((t||r).dirtyFields,e),error:po((t||r).errors,e),isValidating:!!po(r.validatingFields,e),isTouched:!!po((t||r).touchedFields,e)}),O=(e,t,s)=>{const i=(po(a,e,{_f:{}})._f||{}).ref,n=po(r.errors,e)||{},{ref:o,message:l,type:c,...d}=n;vo(r.errors,e,{...d,...t,ref:i}),u.state.next({name:e,errors:r.errors,isValid:!1}),s&&s.shouldFocus&&i&&i.focus&&i.focus()},$=(e,t={})=>{for(const o of e?Ro(e):l.mount)l.mount.delete(o),l.array.delete(o),t.keepValue||(tl(a,o),tl(n,o)),!t.keepError&&tl(r.errors,o),!t.keepDirty&&tl(r.dirtyFields,o),!t.keepTouched&&tl(r.touchedFields,o),!t.keepIsValidating&&tl(r.validatingFields,o),!s.shouldUnregister&&!t.keepDefaultValue&&tl(i,o);u.values.next({values:{...n}}),u.state.next({...r,...t.keepDirty?{isDirty:w()}:{}}),!t.keepIsValid&&x()},R=({disabled:e,name:t,field:s,fields:r})=>{(xo(e)&&o.mount||e||l.disabled.has(t))&&(e?l.disabled.add(t):l.disabled.delete(t),v(t,hl(s?s._f:po(r,t)._f),!1,!1,!0))},D=(e,t={})=>{let r=po(a,e);const n=xo(t.disabled)||xo(s.disabled);return vo(a,e,{...r||{},_f:{...r&&r._f?r._f:{ref:{name:e}},name:e,mount:!0,...t}}),l.mount.add(e),r?R({field:r,disabled:xo(t.disabled)?t.disabled:s.disabled,name:e}):f(e,!0,t.value),{...n?{disabled:t.disabled||s.disabled}:{},...s.progressive?{required:!!t.required,min:ml(t.min),max:ml(t.max),minLength:ml(t.minLength),maxLength:ml(t.maxLength),pattern:ml(t.pattern)}:{},name:e,onChange:C,onBlur:C,ref:n=>{if(n){D(e,t),r=po(a,e);const s=mo(n.value)&&n.querySelectorAll&&n.querySelectorAll("input,select,textarea")[0]||n,o=(e=>Bo(e)||ao(e))(s),l=r._f.refs||[];if(o?l.find((e=>e===s)):s===r._f.ref)return;vo(a,e,{_f:{...r._f,...o?{refs:[...l.filter(nl),s,...Array.isArray(po(i,e))?[{}]:[]],ref:{type:s.type,name:e}}:{ref:s}}}),f(e,!1,void 0,s)}else r=po(a,e,{}),r._f&&(r._f.mount=!1),(s.shouldUnregister||t.shouldUnregister)&&(!((e,t)=>e.has((e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e)(t)))(l.array,e)||!o.action)&&l.unMount.add(e)}}},I=()=>s.shouldFocusError&&Lo(a,T,l.mount),M=(e,t)=>async i=>{let o;i&&(i.preventDefault&&i.preventDefault(),i.persist&&i.persist());let c=uo(n);if(l.disabled.size)for(const e of l.disabled)vo(c,e,void 0);if(u.state.next({isSubmitting:!0}),s.resolver){const{errors:e,values:t}=await j();r.errors=e,c=t}else await b(a);if(tl(r.errors,"root"),$o(r.errors)){u.state.next({errors:{}});try{await e(c,i)}catch(d){o=d}}else t&&await t({...r.errors},i),I(),setTimeout(I);if(u.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:$o(r.errors)&&!o,submitCount:r.submitCount+1,errors:r.errors}),o)throw o},q=(e,t={})=>{const c=e?uo(e):i,h=uo(c),m=$o(e),p=m?i:h;if(t.keepDefaultValues||(i=c),!t.keepValues){if(t.keepDirtyValues){const e=new Set([...l.mount,...Object.keys(dl(i,n))]);for(const t of Array.from(e))po(r.dirtyFields,t)?vo(p,t,po(n,t)):S(t,po(p,t))}else{if(co&&mo(e))for(const e of l.mount){const t=po(a,e);if(t&&t._f){const e=Array.isArray(t._f.refs)?t._f.refs[0]:t._f.ref;if(Uo(e)){const t=e.closest("form");if(t){t.reset();break}}}}a={}}n=s.shouldUnregister?t.keepDefaultValues?uo(i):{}:uo(p),u.array.next({values:{...p}}),u.values.next({values:{...p}})}l={mount:t.keepDirtyValues?l.mount:new Set,unMount:new Set,array:new Set,disabled:new Set,watch:new Set,watchAll:!1,focus:""},o.mount=!d.isValid||!!t.keepIsValid||!!t.keepDirtyValues,o.watch=!!s.shouldUnregister,u.state.next({submitCount:t.keepSubmitCount?r.submitCount:0,isDirty:!m&&(t.keepDirty?r.isDirty:!(!t.keepDefaultValues||al(e,i))),isSubmitted:!!t.keepIsSubmitted&&r.isSubmitted,dirtyFields:m?{}:t.keepDirtyValues?t.keepDefaultValues&&n?dl(i,n):r.dirtyFields:t.keepDefaultValues&&e?dl(i,e):t.keepDirty?r.dirtyFields:{},touchedFields:t.keepTouched?r.touchedFields:{},errors:t.keepErrors?r.errors:{},isSubmitSuccessful:!!t.keepIsSubmitSuccessful&&r.isSubmitSuccessful,isSubmitting:!1})},L=(e,t)=>q(Vo(e)?e(n):e,t);return{control:{register:D,unregister:$,getFieldState:E,handleSubmit:M,setError:O,_executeSchema:j,_getWatch:N,_getDirty:w,_updateValid:x,_removeUnmounted:()=>{for(const e of l.unMount){const t=po(a,e);t&&(t._f.refs?t._f.refs.every((e=>!nl(e))):!nl(t._f.ref))&&$(e)}l.unMount=new Set},_updateFieldArray:(e,t=[],l,c,h=!0,m=!0)=>{if(c&&l&&!s.disabled){if(o.action=!0,m&&Array.isArray(po(a,e))){const t=l(po(a,e),c.argA,c.argB);h&&vo(a,e,t)}if(m&&Array.isArray(po(r.errors,e))){const t=l(po(r.errors,e),c.argA,c.argB);h&&vo(r.errors,e,t),((e,t)=>{!ho(po(e,t)).length&&tl(e,t)})(r.errors,e)}if(d.touchedFields&&m&&Array.isArray(po(r.touchedFields,e))){const t=l(po(r.touchedFields,e),c.argA,c.argB);h&&vo(r.touchedFields,e,t)}d.dirtyFields&&(r.dirtyFields=dl(i,n)),u.state.next({name:e,isDirty:w(e,t),dirtyFields:r.dirtyFields,errors:r.errors,isValid:r.isValid})}else vo(n,e,t)},_updateDisabledField:R,_getFieldArray:e=>ho(po(o.mount?n:i,e,s.shouldUnregister?po(i,e,[]):[])),_reset:q,_resetDefaultValues:()=>Vo(s.defaultValues)&&s.defaultValues().then((e=>{L(e,s.resetOptions),u.state.next({isLoading:!1})})),_updateFormState:e=>{r={...r,...e}},_disableForm:e=>{xo(e)&&(u.state.next({disabled:e}),Lo(a,((t,s)=>{const r=po(a,s);r&&(t.disabled=r._f.disabled||e,Array.isArray(r._f.refs)&&r._f.refs.forEach((t=>{t.disabled=r._f.disabled||e})))}),0,!1))},_subjects:u,_proxyFormState:d,_setErrors:e=>{r.errors=e,u.state.next({errors:r.errors,isValid:!1})},get _fields(){return a},get _formValues(){return n},get _state(){return o},set _state(e){o=e},get _defaultValues(){return i},get _names(){return l},set _names(e){l=e},get _formState(){return r},set _formState(e){r=e},get _options(){return s},set _options(e){s={...s,...e}}},trigger:A,register:D,handleSubmit:M,watch:(e,t)=>Vo(e)?u.values.subscribe({next:s=>e(N(void 0,t),s)}):N(e,t,!0),setValue:S,getValues:P,reset:L,resetField:(e,t={})=>{po(a,e)&&(mo(t.defaultValue)?S(e,uo(po(i,e))):(S(e,t.defaultValue),vo(i,e,uo(t.defaultValue))),t.keepTouched||tl(r.touchedFields,e),t.keepDirty||(tl(r.dirtyFields,e),r.isDirty=t.defaultValue?w(e,uo(po(i,e))):w()),t.keepError||(tl(r.errors,e),d.isValid&&x()),u.state.next({...r}))},clearErrors:e=>{e&&Ro(e).forEach((e=>tl(r.errors,e))),u.state.next({errors:e?r.errors:{}})},unregister:$,setError:O,setFocus:(e,t={})=>{const s=po(a,e),r=s&&s._f;if(r){const e=r.refs?r.refs[0]:r.ref;e.focus&&(e.focus(),t.shouldSelect&&Vo(e.select)&&e.select())}},getFieldState:E}}function vl(e={}){const t=ne.useRef(void 0),s=ne.useRef(void 0),[r,a]=ne.useState({isDirty:!1,isValidating:!1,isLoading:Vo(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},validatingFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:Vo(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...fl(e),formState:r});const i=t.current.control;return i._options=e,function(e){const t=ne.useRef(e);t.current=e,ne.useEffect((()=>{const s=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{s&&s.unsubscribe()}}),[e.disabled])}({subject:i._subjects.state,next:e=>{((e,t,s)=>{s(e);const{name:r,...a}=e;return $o(a)||Object.keys(a).length>=Object.keys(t).length||Object.keys(a).find((e=>t[e]===ko))})(e,i._proxyFormState,i._updateFormState)&&a({...i._formState})}}),ne.useEffect((()=>i._disableForm(e.disabled)),[i,e.disabled]),ne.useEffect((()=>{if(i._proxyFormState.isDirty){const e=i._getDirty();e!==r.isDirty&&i._subjects.state.next({isDirty:e})}}),[i,r.isDirty]),ne.useEffect((()=>{e.values&&!al(e.values,s.current)?(i._reset(e.values,i._options.resetOptions),s.current=e.values,a((e=>({...e})))):i._resetDefaultValues()}),[e.values,i]),ne.useEffect((()=>{e.errors&&i._setErrors(e.errors)}),[e.errors,i]),ne.useEffect((()=>{i._state.mount||(i._updateValid(),i._state.mount=!0),i._state.watch&&(i._state.watch=!1,i._subjects.state.next({...i._formState})),i._removeUnmounted()})),ne.useEffect((()=>{e.shouldUnregister&&i._subjects.values.next({values:i._getWatch()})}),[e.shouldUnregister,i]),t.current.formState=((e,t,s,r=!0)=>{const a={defaultValues:t._defaultValues};for(const i in e)Object.defineProperty(a,i,{get:()=>{const s=i;return t._proxyFormState[s]!==ko&&(t._proxyFormState[s]=!r||ko),e[s]}});return a})(r,i),t.current}const yl=(e,t,s)=>{if(e&&"reportValidity"in e){const r=po(s,t);e.setCustomValidity(r&&r.message||""),e.reportValidity()}},jl=(e,t)=>{for(const s in t.fields){const r=t.fields[s];r&&r.ref&&"reportValidity"in r.ref?yl(r.ref,s,e):r.refs&&r.refs.forEach((t=>yl(t,s,e)))}},bl=(e,t)=>{t.shouldUseNativeValidation&&jl(e,t);const s={};for(const r in e){const a=po(t.fields,r),i=Object.assign(e[r]||{},{ref:a&&a.ref});if(wl(t.names||Object.keys(e),r)){const e=Object.assign({},po(s,r));vo(e,"root",i),vo(s,r,e)}else vo(s,r,i)}return s},wl=(e,t)=>e.some((e=>e.startsWith(t+".")));var Nl,_l,kl,Sl=function(e,t){for(var s={};e.length;){var r=e[0],a=r.code,i=r.message,n=r.path.join(".");if(!s[n])if("unionErrors"in r){var o=r.unionErrors[0].errors[0];s[n]={message:o.message,type:o.code}}else s[n]={message:i,type:a};if("unionErrors"in r&&r.unionErrors.forEach((function(t){return t.errors.forEach((function(t){return e.push(t)}))})),t){var l=s[n].types,c=l&&l[r.code];s[n]=Io(n,t,s,a,c?[].concat(c,r.message):r.message)}e.shift()}return s};(_l=Nl||(Nl={})).assertEqual=e=>e,_l.assertIs=function(e){},_l.assertNever=function(e){throw new Error},_l.arrayToEnum=e=>{const t={};for(const s of e)t[s]=s;return t},_l.getValidEnumValues=e=>{const t=_l.objectKeys(e).filter((t=>"number"!=typeof e[e[t]])),s={};for(const r of t)s[r]=e[r];return _l.objectValues(s)},_l.objectValues=e=>_l.objectKeys(e).map((function(t){return e[t]})),_l.objectKeys="function"==typeof Object.keys?e=>Object.keys(e):e=>{const t=[];for(const s in e)Object.prototype.hasOwnProperty.call(e,s)&&t.push(s);return t},_l.find=(e,t)=>{for(const s of e)if(t(s))return s},_l.isInteger="function"==typeof Number.isInteger?e=>Number.isInteger(e):e=>"number"==typeof e&&isFinite(e)&&Math.floor(e)===e,_l.joinValues=function(e,t=" | "){return e.map((e=>"string"==typeof e?`'${e}'`:e)).join(t)},_l.jsonStringifyReplacer=(e,t)=>"bigint"==typeof t?t.toString():t,(kl||(kl={})).mergeShapes=(e,t)=>({...e,...t});const Cl=Nl.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Tl=e=>{switch(typeof e){case"undefined":return Cl.undefined;case"string":return Cl.string;case"number":return isNaN(e)?Cl.nan:Cl.number;case"boolean":return Cl.boolean;case"function":return Cl.function;case"bigint":return Cl.bigint;case"symbol":return Cl.symbol;case"object":return Array.isArray(e)?Cl.array:null===e?Cl.null:e.then&&"function"==typeof e.then&&e.catch&&"function"==typeof e.catch?Cl.promise:"undefined"!=typeof Map&&e instanceof Map?Cl.map:"undefined"!=typeof Set&&e instanceof Set?Cl.set:"undefined"!=typeof Date&&e instanceof Date?Cl.date:Cl.object;default:return Cl.unknown}},Al=Nl.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Pl extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=e=>{this.issues=[...this.issues,e]},this.addIssues=(e=[])=>{this.issues=[...this.issues,...e]};const t=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,t):this.__proto__=t,this.name="ZodError",this.issues=e}format(e){const t=e||function(e){return e.message},s={_errors:[]},r=e=>{for(const a of e.issues)if("invalid_union"===a.code)a.unionErrors.map(r);else if("invalid_return_type"===a.code)r(a.returnTypeError);else if("invalid_arguments"===a.code)r(a.argumentsError);else if(0===a.path.length)s._errors.push(t(a));else{let e=s,r=0;for(;r<a.path.length;){const s=a.path[r];r===a.path.length-1?(e[s]=e[s]||{_errors:[]},e[s]._errors.push(t(a))):e[s]=e[s]||{_errors:[]},e=e[s],r++}}};return r(this),s}static assert(e){if(!(e instanceof Pl))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,Nl.jsonStringifyReplacer,2)}get isEmpty(){return 0===this.issues.length}flatten(e=e=>e.message){const t={},s=[];for(const r of this.issues)r.path.length>0?(t[r.path[0]]=t[r.path[0]]||[],t[r.path[0]].push(e(r))):s.push(e(r));return{formErrors:s,fieldErrors:t}}get formErrors(){return this.flatten()}}Pl.create=e=>new Pl(e);const El=(e,t)=>{let s;switch(e.code){case Al.invalid_type:s=e.received===Cl.undefined?"Required":`Expected ${e.expected}, received ${e.received}`;break;case Al.invalid_literal:s=`Invalid literal value, expected ${JSON.stringify(e.expected,Nl.jsonStringifyReplacer)}`;break;case Al.unrecognized_keys:s=`Unrecognized key(s) in object: ${Nl.joinValues(e.keys,", ")}`;break;case Al.invalid_union:s="Invalid input";break;case Al.invalid_union_discriminator:s=`Invalid discriminator value. Expected ${Nl.joinValues(e.options)}`;break;case Al.invalid_enum_value:s=`Invalid enum value. Expected ${Nl.joinValues(e.options)}, received '${e.received}'`;break;case Al.invalid_arguments:s="Invalid function arguments";break;case Al.invalid_return_type:s="Invalid function return type";break;case Al.invalid_date:s="Invalid date";break;case Al.invalid_string:"object"==typeof e.validation?"includes"in e.validation?(s=`Invalid input: must include "${e.validation.includes}"`,"number"==typeof e.validation.position&&(s=`${s} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?s=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?s=`Invalid input: must end with "${e.validation.endsWith}"`:Nl.assertNever(e.validation):s="regex"!==e.validation?`Invalid ${e.validation}`:"Invalid";break;case Al.too_small:s="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:"date"===e.type?`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:"Invalid input";break;case Al.too_big:s="array"===e.type?`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:"string"===e.type?`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:"number"===e.type?`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"bigint"===e.type?`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:"date"===e.type?`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:"Invalid input";break;case Al.custom:s="Invalid input";break;case Al.invalid_intersection_types:s="Intersection results could not be merged";break;case Al.not_multiple_of:s=`Number must be a multiple of ${e.multipleOf}`;break;case Al.not_finite:s="Number must be finite";break;default:s=t.defaultError,Nl.assertNever(e)}return{message:s}};let Ol=El;function $l(){return Ol}const Rl=e=>{const{data:t,path:s,errorMaps:r,issueData:a}=e,i=[...s,...a.path||[]],n={...a,path:i};if(void 0!==a.message)return{...a,path:i,message:a.message};let o="";const l=r.filter((e=>!!e)).slice().reverse();for(const c of l)o=c(n,{data:t,defaultError:o}).message;return{...a,path:i,message:o}};function Dl(e,t){const s=$l(),r=Rl({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,s,s===El?void 0:El].filter((e=>!!e))});e.common.issues.push(r)}class Il{constructor(){this.value="valid"}dirty(){"valid"===this.value&&(this.value="dirty")}abort(){"aborted"!==this.value&&(this.value="aborted")}static mergeArray(e,t){const s=[];for(const r of t){if("aborted"===r.status)return Ml;"dirty"===r.status&&e.dirty(),s.push(r.value)}return{status:e.value,value:s}}static async mergeObjectAsync(e,t){const s=[];for(const r of t){const e=await r.key,t=await r.value;s.push({key:e,value:t})}return Il.mergeObjectSync(e,s)}static mergeObjectSync(e,t){const s={};for(const r of t){const{key:t,value:a}=r;if("aborted"===t.status)return Ml;if("aborted"===a.status)return Ml;"dirty"===t.status&&e.dirty(),"dirty"===a.status&&e.dirty(),"__proto__"===t.value||void 0===a.value&&!r.alwaysSet||(s[t.value]=a.value)}return{status:e.value,value:s}}}const Ml=Object.freeze({status:"aborted"}),ql=e=>({status:"dirty",value:e}),Ll=e=>({status:"valid",value:e}),Fl=e=>"aborted"===e.status,zl=e=>"dirty"===e.status,Vl=e=>"valid"===e.status,Ul=e=>"undefined"!=typeof Promise&&e instanceof Promise;function Zl(e,t,s,r){if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return t.get(e)}function Bl(e,t,s,r,a){if("function"==typeof t?e!==t||!a:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return t.set(e,s),s}var Gl,Wl,Jl,Hl;"function"==typeof SuppressedError&&SuppressedError,(Wl=Gl||(Gl={})).errToObj=e=>"string"==typeof e?{message:e}:e||{},Wl.toString=e=>"string"==typeof e?e:null==e?void 0:e.message;class Kl{constructor(e,t,s,r){this._cachedPath=[],this.parent=e,this.data=t,this._path=s,this._key=r}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const Yl=(e,t)=>{if(Vl(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const t=new Pl(e.common.issues);return this._error=t,this._error}}};function Ql(e){if(!e)return{};const{errorMap:t,invalid_type_error:s,required_error:r,description:a}=e;if(t&&(s||r))throw new Error('Can\'t use "invalid_type_error" or "required_error" in conjunction with custom error map.');if(t)return{errorMap:t,description:a};return{errorMap:(t,a)=>{var i,n;const{message:o}=e;return"invalid_enum_value"===t.code?{message:null!=o?o:a.defaultError}:void 0===a.data?{message:null!==(i=null!=o?o:r)&&void 0!==i?i:a.defaultError}:"invalid_type"!==t.code?{message:a.defaultError}:{message:null!==(n=null!=o?o:s)&&void 0!==n?n:a.defaultError}},description:a}}class Xl{get description(){return this._def.description}_getType(e){return Tl(e.data)}_getOrReturnCtx(e,t){return t||{common:e.parent.common,data:e.data,parsedType:Tl(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Il,ctx:{common:e.parent.common,data:e.data,parsedType:Tl(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const t=this._parse(e);if(Ul(t))throw new Error("Synchronous parse encountered promise.");return t}_parseAsync(e){const t=this._parse(e);return Promise.resolve(t)}parse(e,t){const s=this.safeParse(e,t);if(s.success)return s.data;throw s.error}safeParse(e,t){var s;const r={common:{issues:[],async:null!==(s=null==t?void 0:t.async)&&void 0!==s&&s,contextualErrorMap:null==t?void 0:t.errorMap},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Tl(e)},a=this._parseSync({data:e,path:r.path,parent:r});return Yl(r,a)}"~validate"(e){var t,s;const r={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Tl(e)};if(!this["~standard"].async)try{const t=this._parseSync({data:e,path:[],parent:r});return Vl(t)?{value:t.value}:{issues:r.common.issues}}catch(a){(null===(s=null===(t=null==a?void 0:a.message)||void 0===t?void 0:t.toLowerCase())||void 0===s?void 0:s.includes("encountered"))&&(this["~standard"].async=!0),r.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:r}).then((e=>Vl(e)?{value:e.value}:{issues:r.common.issues}))}async parseAsync(e,t){const s=await this.safeParseAsync(e,t);if(s.success)return s.data;throw s.error}async safeParseAsync(e,t){const s={common:{issues:[],contextualErrorMap:null==t?void 0:t.errorMap,async:!0},path:(null==t?void 0:t.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Tl(e)},r=this._parse({data:e,path:s.path,parent:s}),a=await(Ul(r)?r:Promise.resolve(r));return Yl(s,a)}refine(e,t){const s=e=>"string"==typeof t||void 0===t?{message:t}:"function"==typeof t?t(e):t;return this._refinement(((t,r)=>{const a=e(t),i=()=>r.addIssue({code:Al.custom,...s(t)});return"undefined"!=typeof Promise&&a instanceof Promise?a.then((e=>!!e||(i(),!1))):!!a||(i(),!1)}))}refinement(e,t){return this._refinement(((s,r)=>!!e(s)||(r.addIssue("function"==typeof t?t(s,r):t),!1)))}_refinement(e){return new Xc({schema:this,typeName:hd.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:e=>this["~validate"](e)}}optional(){return ed.create(this,this._def)}nullable(){return td.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Rc.create(this)}promise(){return Qc.create(this,this._def)}or(e){return Mc.create([this,e],this._def)}and(e){return zc.create(this,e,this._def)}transform(e){return new Xc({...Ql(this._def),schema:this,typeName:hd.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const t="function"==typeof e?e:()=>e;return new sd({...Ql(this._def),innerType:this,defaultValue:t,typeName:hd.ZodDefault})}brand(){return new nd({typeName:hd.ZodBranded,type:this,...Ql(this._def)})}catch(e){const t="function"==typeof e?e:()=>e;return new rd({...Ql(this._def),innerType:this,catchValue:t,typeName:hd.ZodCatch})}describe(e){return new(0,this.constructor)({...this._def,description:e})}pipe(e){return od.create(this,e)}readonly(){return ld.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const ec=/^c[^\s-]{8,}$/i,tc=/^[0-9a-z]+$/,sc=/^[0-9A-HJKMNP-TV-Z]{26}$/i,rc=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,ac=/^[a-z0-9_-]{21}$/i,ic=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,nc=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,oc=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i;let lc;const cc=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,dc=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,uc=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,hc=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,mc=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,pc=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,xc="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",gc=new RegExp(`^${xc}$`);function fc(e){let t="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return e.precision?t=`${t}\\.\\d{${e.precision}}`:null==e.precision&&(t=`${t}(\\.\\d+)?`),t}function vc(e){let t=`${xc}T${fc(e)}`;const s=[];return s.push(e.local?"Z?":"Z"),e.offset&&s.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${s.join("|")})`,new RegExp(`^${t}$`)}function yc(e,t){if(!ic.test(e))return!1;try{const[s]=e.split("."),r=s.replace(/-/g,"+").replace(/_/g,"/").padEnd(s.length+(4-s.length%4)%4,"="),a=JSON.parse(atob(r));return"object"==typeof a&&null!==a&&(!(!a.typ||!a.alg)&&(!t||a.alg===t))}catch(s){return!1}}function jc(e,t){return!("v4"!==t&&t||!dc.test(e))||!("v6"!==t&&t||!hc.test(e))}class bc extends Xl{_parse(e){this._def.coerce&&(e.data=String(e.data));if(this._getType(e)!==Cl.string){const t=this._getOrReturnCtx(e);return Dl(t,{code:Al.invalid_type,expected:Cl.string,received:t.parsedType}),Ml}const t=new Il;let s;for(const n of this._def.checks)if("min"===n.kind)e.data.length<n.value&&(s=this._getOrReturnCtx(e,s),Dl(s,{code:Al.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),t.dirty());else if("max"===n.kind)e.data.length>n.value&&(s=this._getOrReturnCtx(e,s),Dl(s,{code:Al.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!1,message:n.message}),t.dirty());else if("length"===n.kind){const r=e.data.length>n.value,a=e.data.length<n.value;(r||a)&&(s=this._getOrReturnCtx(e,s),r?Dl(s,{code:Al.too_big,maximum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}):a&&Dl(s,{code:Al.too_small,minimum:n.value,type:"string",inclusive:!0,exact:!0,message:n.message}),t.dirty())}else if("email"===n.kind)oc.test(e.data)||(s=this._getOrReturnCtx(e,s),Dl(s,{validation:"email",code:Al.invalid_string,message:n.message}),t.dirty());else if("emoji"===n.kind)lc||(lc=new RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),lc.test(e.data)||(s=this._getOrReturnCtx(e,s),Dl(s,{validation:"emoji",code:Al.invalid_string,message:n.message}),t.dirty());else if("uuid"===n.kind)rc.test(e.data)||(s=this._getOrReturnCtx(e,s),Dl(s,{validation:"uuid",code:Al.invalid_string,message:n.message}),t.dirty());else if("nanoid"===n.kind)ac.test(e.data)||(s=this._getOrReturnCtx(e,s),Dl(s,{validation:"nanoid",code:Al.invalid_string,message:n.message}),t.dirty());else if("cuid"===n.kind)ec.test(e.data)||(s=this._getOrReturnCtx(e,s),Dl(s,{validation:"cuid",code:Al.invalid_string,message:n.message}),t.dirty());else if("cuid2"===n.kind)tc.test(e.data)||(s=this._getOrReturnCtx(e,s),Dl(s,{validation:"cuid2",code:Al.invalid_string,message:n.message}),t.dirty());else if("ulid"===n.kind)sc.test(e.data)||(s=this._getOrReturnCtx(e,s),Dl(s,{validation:"ulid",code:Al.invalid_string,message:n.message}),t.dirty());else if("url"===n.kind)try{new URL(e.data)}catch(i){s=this._getOrReturnCtx(e,s),Dl(s,{validation:"url",code:Al.invalid_string,message:n.message}),t.dirty()}else if("regex"===n.kind){n.regex.lastIndex=0;n.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),Dl(s,{validation:"regex",code:Al.invalid_string,message:n.message}),t.dirty())}else if("trim"===n.kind)e.data=e.data.trim();else if("includes"===n.kind)e.data.includes(n.value,n.position)||(s=this._getOrReturnCtx(e,s),Dl(s,{code:Al.invalid_string,validation:{includes:n.value,position:n.position},message:n.message}),t.dirty());else if("toLowerCase"===n.kind)e.data=e.data.toLowerCase();else if("toUpperCase"===n.kind)e.data=e.data.toUpperCase();else if("startsWith"===n.kind)e.data.startsWith(n.value)||(s=this._getOrReturnCtx(e,s),Dl(s,{code:Al.invalid_string,validation:{startsWith:n.value},message:n.message}),t.dirty());else if("endsWith"===n.kind)e.data.endsWith(n.value)||(s=this._getOrReturnCtx(e,s),Dl(s,{code:Al.invalid_string,validation:{endsWith:n.value},message:n.message}),t.dirty());else if("datetime"===n.kind){vc(n).test(e.data)||(s=this._getOrReturnCtx(e,s),Dl(s,{code:Al.invalid_string,validation:"datetime",message:n.message}),t.dirty())}else if("date"===n.kind){gc.test(e.data)||(s=this._getOrReturnCtx(e,s),Dl(s,{code:Al.invalid_string,validation:"date",message:n.message}),t.dirty())}else if("time"===n.kind){new RegExp(`^${fc(n)}$`).test(e.data)||(s=this._getOrReturnCtx(e,s),Dl(s,{code:Al.invalid_string,validation:"time",message:n.message}),t.dirty())}else"duration"===n.kind?nc.test(e.data)||(s=this._getOrReturnCtx(e,s),Dl(s,{validation:"duration",code:Al.invalid_string,message:n.message}),t.dirty()):"ip"===n.kind?(r=e.data,("v4"!==(a=n.version)&&a||!cc.test(r))&&("v6"!==a&&a||!uc.test(r))&&(s=this._getOrReturnCtx(e,s),Dl(s,{validation:"ip",code:Al.invalid_string,message:n.message}),t.dirty())):"jwt"===n.kind?yc(e.data,n.alg)||(s=this._getOrReturnCtx(e,s),Dl(s,{validation:"jwt",code:Al.invalid_string,message:n.message}),t.dirty()):"cidr"===n.kind?jc(e.data,n.version)||(s=this._getOrReturnCtx(e,s),Dl(s,{validation:"cidr",code:Al.invalid_string,message:n.message}),t.dirty()):"base64"===n.kind?mc.test(e.data)||(s=this._getOrReturnCtx(e,s),Dl(s,{validation:"base64",code:Al.invalid_string,message:n.message}),t.dirty()):"base64url"===n.kind?pc.test(e.data)||(s=this._getOrReturnCtx(e,s),Dl(s,{validation:"base64url",code:Al.invalid_string,message:n.message}),t.dirty()):Nl.assertNever(n);var r,a;return{status:t.value,value:e.data}}_regex(e,t,s){return this.refinement((t=>e.test(t)),{validation:t,code:Al.invalid_string,...Gl.errToObj(s)})}_addCheck(e){return new bc({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...Gl.errToObj(e)})}url(e){return this._addCheck({kind:"url",...Gl.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...Gl.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...Gl.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...Gl.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...Gl.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...Gl.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...Gl.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...Gl.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...Gl.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...Gl.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...Gl.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...Gl.errToObj(e)})}datetime(e){var t,s;return"string"==typeof e?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,offset:null!==(t=null==e?void 0:e.offset)&&void 0!==t&&t,local:null!==(s=null==e?void 0:e.local)&&void 0!==s&&s,...Gl.errToObj(null==e?void 0:e.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return"string"==typeof e?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:void 0===(null==e?void 0:e.precision)?null:null==e?void 0:e.precision,...Gl.errToObj(null==e?void 0:e.message)})}duration(e){return this._addCheck({kind:"duration",...Gl.errToObj(e)})}regex(e,t){return this._addCheck({kind:"regex",regex:e,...Gl.errToObj(t)})}includes(e,t){return this._addCheck({kind:"includes",value:e,position:null==t?void 0:t.position,...Gl.errToObj(null==t?void 0:t.message)})}startsWith(e,t){return this._addCheck({kind:"startsWith",value:e,...Gl.errToObj(t)})}endsWith(e,t){return this._addCheck({kind:"endsWith",value:e,...Gl.errToObj(t)})}min(e,t){return this._addCheck({kind:"min",value:e,...Gl.errToObj(t)})}max(e,t){return this._addCheck({kind:"max",value:e,...Gl.errToObj(t)})}length(e,t){return this._addCheck({kind:"length",value:e,...Gl.errToObj(t)})}nonempty(e){return this.min(1,Gl.errToObj(e))}trim(){return new bc({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new bc({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new bc({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find((e=>"datetime"===e.kind))}get isDate(){return!!this._def.checks.find((e=>"date"===e.kind))}get isTime(){return!!this._def.checks.find((e=>"time"===e.kind))}get isDuration(){return!!this._def.checks.find((e=>"duration"===e.kind))}get isEmail(){return!!this._def.checks.find((e=>"email"===e.kind))}get isURL(){return!!this._def.checks.find((e=>"url"===e.kind))}get isEmoji(){return!!this._def.checks.find((e=>"emoji"===e.kind))}get isUUID(){return!!this._def.checks.find((e=>"uuid"===e.kind))}get isNANOID(){return!!this._def.checks.find((e=>"nanoid"===e.kind))}get isCUID(){return!!this._def.checks.find((e=>"cuid"===e.kind))}get isCUID2(){return!!this._def.checks.find((e=>"cuid2"===e.kind))}get isULID(){return!!this._def.checks.find((e=>"ulid"===e.kind))}get isIP(){return!!this._def.checks.find((e=>"ip"===e.kind))}get isCIDR(){return!!this._def.checks.find((e=>"cidr"===e.kind))}get isBase64(){return!!this._def.checks.find((e=>"base64"===e.kind))}get isBase64url(){return!!this._def.checks.find((e=>"base64url"===e.kind))}get minLength(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxLength(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}function wc(e,t){const s=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,a=s>r?s:r;return parseInt(e.toFixed(a).replace(".",""))%parseInt(t.toFixed(a).replace(".",""))/Math.pow(10,a)}bc.create=e=>{var t;return new bc({checks:[],typeName:hd.ZodString,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...Ql(e)})};class Nc extends Xl{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){this._def.coerce&&(e.data=Number(e.data));if(this._getType(e)!==Cl.number){const t=this._getOrReturnCtx(e);return Dl(t,{code:Al.invalid_type,expected:Cl.number,received:t.parsedType}),Ml}let t;const s=new Il;for(const r of this._def.checks)if("int"===r.kind)Nl.isInteger(e.data)||(t=this._getOrReturnCtx(e,t),Dl(t,{code:Al.invalid_type,expected:"integer",received:"float",message:r.message}),s.dirty());else if("min"===r.kind){(r.inclusive?e.data<r.value:e.data<=r.value)&&(t=this._getOrReturnCtx(e,t),Dl(t,{code:Al.too_small,minimum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),s.dirty())}else if("max"===r.kind){(r.inclusive?e.data>r.value:e.data>=r.value)&&(t=this._getOrReturnCtx(e,t),Dl(t,{code:Al.too_big,maximum:r.value,type:"number",inclusive:r.inclusive,exact:!1,message:r.message}),s.dirty())}else"multipleOf"===r.kind?0!==wc(e.data,r.value)&&(t=this._getOrReturnCtx(e,t),Dl(t,{code:Al.not_multiple_of,multipleOf:r.value,message:r.message}),s.dirty()):"finite"===r.kind?Number.isFinite(e.data)||(t=this._getOrReturnCtx(e,t),Dl(t,{code:Al.not_finite,message:r.message}),s.dirty()):Nl.assertNever(r);return{status:s.value,value:e.data}}gte(e,t){return this.setLimit("min",e,!0,Gl.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Gl.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Gl.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Gl.toString(t))}setLimit(e,t,s,r){return new Nc({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:Gl.toString(r)}]})}_addCheck(e){return new Nc({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:Gl.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Gl.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Gl.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Gl.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Gl.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Gl.toString(t)})}finite(e){return this._addCheck({kind:"finite",message:Gl.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Gl.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Gl.toString(e)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}get isInt(){return!!this._def.checks.find((e=>"int"===e.kind||"multipleOf"===e.kind&&Nl.isInteger(e.value)))}get isFinite(){let e=null,t=null;for(const s of this._def.checks){if("finite"===s.kind||"int"===s.kind||"multipleOf"===s.kind)return!0;"min"===s.kind?(null===t||s.value>t)&&(t=s.value):"max"===s.kind&&(null===e||s.value<e)&&(e=s.value)}return Number.isFinite(t)&&Number.isFinite(e)}}Nc.create=e=>new Nc({checks:[],typeName:hd.ZodNumber,coerce:(null==e?void 0:e.coerce)||!1,...Ql(e)});class _c extends Xl{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch(r){return this._getInvalidInput(e)}if(this._getType(e)!==Cl.bigint)return this._getInvalidInput(e);let t;const s=new Il;for(const a of this._def.checks)if("min"===a.kind){(a.inclusive?e.data<a.value:e.data<=a.value)&&(t=this._getOrReturnCtx(e,t),Dl(t,{code:Al.too_small,type:"bigint",minimum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty())}else if("max"===a.kind){(a.inclusive?e.data>a.value:e.data>=a.value)&&(t=this._getOrReturnCtx(e,t),Dl(t,{code:Al.too_big,type:"bigint",maximum:a.value,inclusive:a.inclusive,message:a.message}),s.dirty())}else"multipleOf"===a.kind?e.data%a.value!==BigInt(0)&&(t=this._getOrReturnCtx(e,t),Dl(t,{code:Al.not_multiple_of,multipleOf:a.value,message:a.message}),s.dirty()):Nl.assertNever(a);return{status:s.value,value:e.data}}_getInvalidInput(e){const t=this._getOrReturnCtx(e);return Dl(t,{code:Al.invalid_type,expected:Cl.bigint,received:t.parsedType}),Ml}gte(e,t){return this.setLimit("min",e,!0,Gl.toString(t))}gt(e,t){return this.setLimit("min",e,!1,Gl.toString(t))}lte(e,t){return this.setLimit("max",e,!0,Gl.toString(t))}lt(e,t){return this.setLimit("max",e,!1,Gl.toString(t))}setLimit(e,t,s,r){return new _c({...this._def,checks:[...this._def.checks,{kind:e,value:t,inclusive:s,message:Gl.toString(r)}]})}_addCheck(e){return new _c({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Gl.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Gl.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Gl.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Gl.toString(e)})}multipleOf(e,t){return this._addCheck({kind:"multipleOf",value:e,message:Gl.toString(t)})}get minValue(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return e}get maxValue(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return e}}_c.create=e=>{var t;return new _c({checks:[],typeName:hd.ZodBigInt,coerce:null!==(t=null==e?void 0:e.coerce)&&void 0!==t&&t,...Ql(e)})};class kc extends Xl{_parse(e){this._def.coerce&&(e.data=Boolean(e.data));if(this._getType(e)!==Cl.boolean){const t=this._getOrReturnCtx(e);return Dl(t,{code:Al.invalid_type,expected:Cl.boolean,received:t.parsedType}),Ml}return Ll(e.data)}}kc.create=e=>new kc({typeName:hd.ZodBoolean,coerce:(null==e?void 0:e.coerce)||!1,...Ql(e)});class Sc extends Xl{_parse(e){this._def.coerce&&(e.data=new Date(e.data));if(this._getType(e)!==Cl.date){const t=this._getOrReturnCtx(e);return Dl(t,{code:Al.invalid_type,expected:Cl.date,received:t.parsedType}),Ml}if(isNaN(e.data.getTime())){return Dl(this._getOrReturnCtx(e),{code:Al.invalid_date}),Ml}const t=new Il;let s;for(const r of this._def.checks)"min"===r.kind?e.data.getTime()<r.value&&(s=this._getOrReturnCtx(e,s),Dl(s,{code:Al.too_small,message:r.message,inclusive:!0,exact:!1,minimum:r.value,type:"date"}),t.dirty()):"max"===r.kind?e.data.getTime()>r.value&&(s=this._getOrReturnCtx(e,s),Dl(s,{code:Al.too_big,message:r.message,inclusive:!0,exact:!1,maximum:r.value,type:"date"}),t.dirty()):Nl.assertNever(r);return{status:t.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Sc({...this._def,checks:[...this._def.checks,e]})}min(e,t){return this._addCheck({kind:"min",value:e.getTime(),message:Gl.toString(t)})}max(e,t){return this._addCheck({kind:"max",value:e.getTime(),message:Gl.toString(t)})}get minDate(){let e=null;for(const t of this._def.checks)"min"===t.kind&&(null===e||t.value>e)&&(e=t.value);return null!=e?new Date(e):null}get maxDate(){let e=null;for(const t of this._def.checks)"max"===t.kind&&(null===e||t.value<e)&&(e=t.value);return null!=e?new Date(e):null}}Sc.create=e=>new Sc({checks:[],coerce:(null==e?void 0:e.coerce)||!1,typeName:hd.ZodDate,...Ql(e)});class Cc extends Xl{_parse(e){if(this._getType(e)!==Cl.symbol){const t=this._getOrReturnCtx(e);return Dl(t,{code:Al.invalid_type,expected:Cl.symbol,received:t.parsedType}),Ml}return Ll(e.data)}}Cc.create=e=>new Cc({typeName:hd.ZodSymbol,...Ql(e)});class Tc extends Xl{_parse(e){if(this._getType(e)!==Cl.undefined){const t=this._getOrReturnCtx(e);return Dl(t,{code:Al.invalid_type,expected:Cl.undefined,received:t.parsedType}),Ml}return Ll(e.data)}}Tc.create=e=>new Tc({typeName:hd.ZodUndefined,...Ql(e)});class Ac extends Xl{_parse(e){if(this._getType(e)!==Cl.null){const t=this._getOrReturnCtx(e);return Dl(t,{code:Al.invalid_type,expected:Cl.null,received:t.parsedType}),Ml}return Ll(e.data)}}Ac.create=e=>new Ac({typeName:hd.ZodNull,...Ql(e)});class Pc extends Xl{constructor(){super(...arguments),this._any=!0}_parse(e){return Ll(e.data)}}Pc.create=e=>new Pc({typeName:hd.ZodAny,...Ql(e)});class Ec extends Xl{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Ll(e.data)}}Ec.create=e=>new Ec({typeName:hd.ZodUnknown,...Ql(e)});class Oc extends Xl{_parse(e){const t=this._getOrReturnCtx(e);return Dl(t,{code:Al.invalid_type,expected:Cl.never,received:t.parsedType}),Ml}}Oc.create=e=>new Oc({typeName:hd.ZodNever,...Ql(e)});class $c extends Xl{_parse(e){if(this._getType(e)!==Cl.undefined){const t=this._getOrReturnCtx(e);return Dl(t,{code:Al.invalid_type,expected:Cl.void,received:t.parsedType}),Ml}return Ll(e.data)}}$c.create=e=>new $c({typeName:hd.ZodVoid,...Ql(e)});class Rc extends Xl{_parse(e){const{ctx:t,status:s}=this._processInputParams(e),r=this._def;if(t.parsedType!==Cl.array)return Dl(t,{code:Al.invalid_type,expected:Cl.array,received:t.parsedType}),Ml;if(null!==r.exactLength){const e=t.data.length>r.exactLength.value,a=t.data.length<r.exactLength.value;(e||a)&&(Dl(t,{code:e?Al.too_big:Al.too_small,minimum:a?r.exactLength.value:void 0,maximum:e?r.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:r.exactLength.message}),s.dirty())}if(null!==r.minLength&&t.data.length<r.minLength.value&&(Dl(t,{code:Al.too_small,minimum:r.minLength.value,type:"array",inclusive:!0,exact:!1,message:r.minLength.message}),s.dirty()),null!==r.maxLength&&t.data.length>r.maxLength.value&&(Dl(t,{code:Al.too_big,maximum:r.maxLength.value,type:"array",inclusive:!0,exact:!1,message:r.maxLength.message}),s.dirty()),t.common.async)return Promise.all([...t.data].map(((e,s)=>r.type._parseAsync(new Kl(t,e,t.path,s))))).then((e=>Il.mergeArray(s,e)));const a=[...t.data].map(((e,s)=>r.type._parseSync(new Kl(t,e,t.path,s))));return Il.mergeArray(s,a)}get element(){return this._def.type}min(e,t){return new Rc({...this._def,minLength:{value:e,message:Gl.toString(t)}})}max(e,t){return new Rc({...this._def,maxLength:{value:e,message:Gl.toString(t)}})}length(e,t){return new Rc({...this._def,exactLength:{value:e,message:Gl.toString(t)}})}nonempty(e){return this.min(1,e)}}function Dc(e){if(e instanceof Ic){const t={};for(const s in e.shape){const r=e.shape[s];t[s]=ed.create(Dc(r))}return new Ic({...e._def,shape:()=>t})}return e instanceof Rc?new Rc({...e._def,type:Dc(e.element)}):e instanceof ed?ed.create(Dc(e.unwrap())):e instanceof td?td.create(Dc(e.unwrap())):e instanceof Vc?Vc.create(e.items.map((e=>Dc(e)))):e}Rc.create=(e,t)=>new Rc({type:e,minLength:null,maxLength:null,exactLength:null,typeName:hd.ZodArray,...Ql(t)});class Ic extends Xl{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(null!==this._cached)return this._cached;const e=this._def.shape(),t=Nl.objectKeys(e);return this._cached={shape:e,keys:t}}_parse(e){if(this._getType(e)!==Cl.object){const t=this._getOrReturnCtx(e);return Dl(t,{code:Al.invalid_type,expected:Cl.object,received:t.parsedType}),Ml}const{status:t,ctx:s}=this._processInputParams(e),{shape:r,keys:a}=this._getCached(),i=[];if(!(this._def.catchall instanceof Oc&&"strip"===this._def.unknownKeys))for(const o in s.data)a.includes(o)||i.push(o);const n=[];for(const o of a){const e=r[o],t=s.data[o];n.push({key:{status:"valid",value:o},value:e._parse(new Kl(s,t,s.path,o)),alwaysSet:o in s.data})}if(this._def.catchall instanceof Oc){const e=this._def.unknownKeys;if("passthrough"===e)for(const t of i)n.push({key:{status:"valid",value:t},value:{status:"valid",value:s.data[t]}});else if("strict"===e)i.length>0&&(Dl(s,{code:Al.unrecognized_keys,keys:i}),t.dirty());else if("strip"!==e)throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const e=this._def.catchall;for(const t of i){const r=s.data[t];n.push({key:{status:"valid",value:t},value:e._parse(new Kl(s,r,s.path,t)),alwaysSet:t in s.data})}}return s.common.async?Promise.resolve().then((async()=>{const e=[];for(const t of n){const s=await t.key,r=await t.value;e.push({key:s,value:r,alwaysSet:t.alwaysSet})}return e})).then((e=>Il.mergeObjectSync(t,e))):Il.mergeObjectSync(t,n)}get shape(){return this._def.shape()}strict(e){return Gl.errToObj,new Ic({...this._def,unknownKeys:"strict",...void 0!==e?{errorMap:(t,s)=>{var r,a,i,n;const o=null!==(i=null===(a=(r=this._def).errorMap)||void 0===a?void 0:a.call(r,t,s).message)&&void 0!==i?i:s.defaultError;return"unrecognized_keys"===t.code?{message:null!==(n=Gl.errToObj(e).message)&&void 0!==n?n:o}:{message:o}}}:{}})}strip(){return new Ic({...this._def,unknownKeys:"strip"})}passthrough(){return new Ic({...this._def,unknownKeys:"passthrough"})}extend(e){return new Ic({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Ic({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:hd.ZodObject})}setKey(e,t){return this.augment({[e]:t})}catchall(e){return new Ic({...this._def,catchall:e})}pick(e){const t={};return Nl.objectKeys(e).forEach((s=>{e[s]&&this.shape[s]&&(t[s]=this.shape[s])})),new Ic({...this._def,shape:()=>t})}omit(e){const t={};return Nl.objectKeys(this.shape).forEach((s=>{e[s]||(t[s]=this.shape[s])})),new Ic({...this._def,shape:()=>t})}deepPartial(){return Dc(this)}partial(e){const t={};return Nl.objectKeys(this.shape).forEach((s=>{const r=this.shape[s];e&&!e[s]?t[s]=r:t[s]=r.optional()})),new Ic({...this._def,shape:()=>t})}required(e){const t={};return Nl.objectKeys(this.shape).forEach((s=>{if(e&&!e[s])t[s]=this.shape[s];else{let e=this.shape[s];for(;e instanceof ed;)e=e._def.innerType;t[s]=e}})),new Ic({...this._def,shape:()=>t})}keyof(){return Hc(Nl.objectKeys(this.shape))}}Ic.create=(e,t)=>new Ic({shape:()=>e,unknownKeys:"strip",catchall:Oc.create(),typeName:hd.ZodObject,...Ql(t)}),Ic.strictCreate=(e,t)=>new Ic({shape:()=>e,unknownKeys:"strict",catchall:Oc.create(),typeName:hd.ZodObject,...Ql(t)}),Ic.lazycreate=(e,t)=>new Ic({shape:e,unknownKeys:"strip",catchall:Oc.create(),typeName:hd.ZodObject,...Ql(t)});class Mc extends Xl{_parse(e){const{ctx:t}=this._processInputParams(e),s=this._def.options;if(t.common.async)return Promise.all(s.map((async e=>{const s={...t,common:{...t.common,issues:[]},parent:null};return{result:await e._parseAsync({data:t.data,path:t.path,parent:s}),ctx:s}}))).then((function(e){for(const t of e)if("valid"===t.result.status)return t.result;for(const r of e)if("dirty"===r.result.status)return t.common.issues.push(...r.ctx.common.issues),r.result;const s=e.map((e=>new Pl(e.ctx.common.issues)));return Dl(t,{code:Al.invalid_union,unionErrors:s}),Ml}));{let e;const r=[];for(const i of s){const s={...t,common:{...t.common,issues:[]},parent:null},a=i._parseSync({data:t.data,path:t.path,parent:s});if("valid"===a.status)return a;"dirty"!==a.status||e||(e={result:a,ctx:s}),s.common.issues.length&&r.push(s.common.issues)}if(e)return t.common.issues.push(...e.ctx.common.issues),e.result;const a=r.map((e=>new Pl(e)));return Dl(t,{code:Al.invalid_union,unionErrors:a}),Ml}}get options(){return this._def.options}}Mc.create=(e,t)=>new Mc({options:e,typeName:hd.ZodUnion,...Ql(t)});const qc=e=>e instanceof Wc?qc(e.schema):e instanceof Xc?qc(e.innerType()):e instanceof Jc?[e.value]:e instanceof Kc?e.options:e instanceof Yc?Nl.objectValues(e.enum):e instanceof sd?qc(e._def.innerType):e instanceof Tc?[void 0]:e instanceof Ac?[null]:e instanceof ed?[void 0,...qc(e.unwrap())]:e instanceof td?[null,...qc(e.unwrap())]:e instanceof nd||e instanceof ld?qc(e.unwrap()):e instanceof rd?qc(e._def.innerType):[];class Lc extends Xl{_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Cl.object)return Dl(t,{code:Al.invalid_type,expected:Cl.object,received:t.parsedType}),Ml;const s=this.discriminator,r=t.data[s],a=this.optionsMap.get(r);return a?t.common.async?a._parseAsync({data:t.data,path:t.path,parent:t}):a._parseSync({data:t.data,path:t.path,parent:t}):(Dl(t,{code:Al.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[s]}),Ml)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,t,s){const r=new Map;for(const a of t){const t=qc(a.shape[e]);if(!t.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const s of t){if(r.has(s))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(s)}`);r.set(s,a)}}return new Lc({typeName:hd.ZodDiscriminatedUnion,discriminator:e,options:t,optionsMap:r,...Ql(s)})}}function Fc(e,t){const s=Tl(e),r=Tl(t);if(e===t)return{valid:!0,data:e};if(s===Cl.object&&r===Cl.object){const s=Nl.objectKeys(t),r=Nl.objectKeys(e).filter((e=>-1!==s.indexOf(e))),a={...e,...t};for(const i of r){const s=Fc(e[i],t[i]);if(!s.valid)return{valid:!1};a[i]=s.data}return{valid:!0,data:a}}if(s===Cl.array&&r===Cl.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let r=0;r<e.length;r++){const a=Fc(e[r],t[r]);if(!a.valid)return{valid:!1};s.push(a.data)}return{valid:!0,data:s}}return s===Cl.date&&r===Cl.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class zc extends Xl{_parse(e){const{status:t,ctx:s}=this._processInputParams(e),r=(e,r)=>{if(Fl(e)||Fl(r))return Ml;const a=Fc(e.value,r.value);return a.valid?((zl(e)||zl(r))&&t.dirty(),{status:t.value,value:a.data}):(Dl(s,{code:Al.invalid_intersection_types}),Ml)};return s.common.async?Promise.all([this._def.left._parseAsync({data:s.data,path:s.path,parent:s}),this._def.right._parseAsync({data:s.data,path:s.path,parent:s})]).then((([e,t])=>r(e,t))):r(this._def.left._parseSync({data:s.data,path:s.path,parent:s}),this._def.right._parseSync({data:s.data,path:s.path,parent:s}))}}zc.create=(e,t,s)=>new zc({left:e,right:t,typeName:hd.ZodIntersection,...Ql(s)});class Vc extends Xl{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==Cl.array)return Dl(s,{code:Al.invalid_type,expected:Cl.array,received:s.parsedType}),Ml;if(s.data.length<this._def.items.length)return Dl(s,{code:Al.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),Ml;!this._def.rest&&s.data.length>this._def.items.length&&(Dl(s,{code:Al.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),t.dirty());const r=[...s.data].map(((e,t)=>{const r=this._def.items[t]||this._def.rest;return r?r._parse(new Kl(s,e,s.path,t)):null})).filter((e=>!!e));return s.common.async?Promise.all(r).then((e=>Il.mergeArray(t,e))):Il.mergeArray(t,r)}get items(){return this._def.items}rest(e){return new Vc({...this._def,rest:e})}}Vc.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Vc({items:e,typeName:hd.ZodTuple,rest:null,...Ql(t)})};class Uc extends Xl{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==Cl.object)return Dl(s,{code:Al.invalid_type,expected:Cl.object,received:s.parsedType}),Ml;const r=[],a=this._def.keyType,i=this._def.valueType;for(const n in s.data)r.push({key:a._parse(new Kl(s,n,s.path,n)),value:i._parse(new Kl(s,s.data[n],s.path,n)),alwaysSet:n in s.data});return s.common.async?Il.mergeObjectAsync(t,r):Il.mergeObjectSync(t,r)}get element(){return this._def.valueType}static create(e,t,s){return new Uc(t instanceof Xl?{keyType:e,valueType:t,typeName:hd.ZodRecord,...Ql(s)}:{keyType:bc.create(),valueType:e,typeName:hd.ZodRecord,...Ql(t)})}}class Zc extends Xl{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==Cl.map)return Dl(s,{code:Al.invalid_type,expected:Cl.map,received:s.parsedType}),Ml;const r=this._def.keyType,a=this._def.valueType,i=[...s.data.entries()].map((([e,t],i)=>({key:r._parse(new Kl(s,e,s.path,[i,"key"])),value:a._parse(new Kl(s,t,s.path,[i,"value"]))})));if(s.common.async){const e=new Map;return Promise.resolve().then((async()=>{for(const s of i){const r=await s.key,a=await s.value;if("aborted"===r.status||"aborted"===a.status)return Ml;"dirty"!==r.status&&"dirty"!==a.status||t.dirty(),e.set(r.value,a.value)}return{status:t.value,value:e}}))}{const e=new Map;for(const s of i){const r=s.key,a=s.value;if("aborted"===r.status||"aborted"===a.status)return Ml;"dirty"!==r.status&&"dirty"!==a.status||t.dirty(),e.set(r.value,a.value)}return{status:t.value,value:e}}}}Zc.create=(e,t,s)=>new Zc({valueType:t,keyType:e,typeName:hd.ZodMap,...Ql(s)});class Bc extends Xl{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.parsedType!==Cl.set)return Dl(s,{code:Al.invalid_type,expected:Cl.set,received:s.parsedType}),Ml;const r=this._def;null!==r.minSize&&s.data.size<r.minSize.value&&(Dl(s,{code:Al.too_small,minimum:r.minSize.value,type:"set",inclusive:!0,exact:!1,message:r.minSize.message}),t.dirty()),null!==r.maxSize&&s.data.size>r.maxSize.value&&(Dl(s,{code:Al.too_big,maximum:r.maxSize.value,type:"set",inclusive:!0,exact:!1,message:r.maxSize.message}),t.dirty());const a=this._def.valueType;function i(e){const s=new Set;for(const r of e){if("aborted"===r.status)return Ml;"dirty"===r.status&&t.dirty(),s.add(r.value)}return{status:t.value,value:s}}const n=[...s.data.values()].map(((e,t)=>a._parse(new Kl(s,e,s.path,t))));return s.common.async?Promise.all(n).then((e=>i(e))):i(n)}min(e,t){return new Bc({...this._def,minSize:{value:e,message:Gl.toString(t)}})}max(e,t){return new Bc({...this._def,maxSize:{value:e,message:Gl.toString(t)}})}size(e,t){return this.min(e,t).max(e,t)}nonempty(e){return this.min(1,e)}}Bc.create=(e,t)=>new Bc({valueType:e,minSize:null,maxSize:null,typeName:hd.ZodSet,...Ql(t)});class Gc extends Xl{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Cl.function)return Dl(t,{code:Al.invalid_type,expected:Cl.function,received:t.parsedType}),Ml;function s(e,s){return Rl({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,$l(),El].filter((e=>!!e)),issueData:{code:Al.invalid_arguments,argumentsError:s}})}function r(e,s){return Rl({data:e,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,$l(),El].filter((e=>!!e)),issueData:{code:Al.invalid_return_type,returnTypeError:s}})}const a={errorMap:t.common.contextualErrorMap},i=t.data;if(this._def.returns instanceof Qc){const e=this;return Ll((async function(...t){const n=new Pl([]),o=await e._def.args.parseAsync(t,a).catch((e=>{throw n.addIssue(s(t,e)),n})),l=await Reflect.apply(i,this,o);return await e._def.returns._def.type.parseAsync(l,a).catch((e=>{throw n.addIssue(r(l,e)),n}))}))}{const e=this;return Ll((function(...t){const n=e._def.args.safeParse(t,a);if(!n.success)throw new Pl([s(t,n.error)]);const o=Reflect.apply(i,this,n.data),l=e._def.returns.safeParse(o,a);if(!l.success)throw new Pl([r(o,l.error)]);return l.data}))}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Gc({...this._def,args:Vc.create(e).rest(Ec.create())})}returns(e){return new Gc({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,t,s){return new Gc({args:e||Vc.create([]).rest(Ec.create()),returns:t||Ec.create(),typeName:hd.ZodFunction,...Ql(s)})}}class Wc extends Xl{get schema(){return this._def.getter()}_parse(e){const{ctx:t}=this._processInputParams(e);return this._def.getter()._parse({data:t.data,path:t.path,parent:t})}}Wc.create=(e,t)=>new Wc({getter:e,typeName:hd.ZodLazy,...Ql(t)});class Jc extends Xl{_parse(e){if(e.data!==this._def.value){const t=this._getOrReturnCtx(e);return Dl(t,{received:t.data,code:Al.invalid_literal,expected:this._def.value}),Ml}return{status:"valid",value:e.data}}get value(){return this._def.value}}function Hc(e,t){return new Kc({values:e,typeName:hd.ZodEnum,...Ql(t)})}Jc.create=(e,t)=>new Jc({value:e,typeName:hd.ZodLiteral,...Ql(t)});class Kc extends Xl{constructor(){super(...arguments),Jl.set(this,void 0)}_parse(e){if("string"!=typeof e.data){const t=this._getOrReturnCtx(e),s=this._def.values;return Dl(t,{expected:Nl.joinValues(s),received:t.parsedType,code:Al.invalid_type}),Ml}if(Zl(this,Jl)||Bl(this,Jl,new Set(this._def.values)),!Zl(this,Jl).has(e.data)){const t=this._getOrReturnCtx(e),s=this._def.values;return Dl(t,{received:t.data,code:Al.invalid_enum_value,options:s}),Ml}return Ll(e.data)}get options(){return this._def.values}get enum(){const e={};for(const t of this._def.values)e[t]=t;return e}get Values(){const e={};for(const t of this._def.values)e[t]=t;return e}get Enum(){const e={};for(const t of this._def.values)e[t]=t;return e}extract(e,t=this._def){return Kc.create(e,{...this._def,...t})}exclude(e,t=this._def){return Kc.create(this.options.filter((t=>!e.includes(t))),{...this._def,...t})}}Jl=new WeakMap,Kc.create=Hc;class Yc extends Xl{constructor(){super(...arguments),Hl.set(this,void 0)}_parse(e){const t=Nl.getValidEnumValues(this._def.values),s=this._getOrReturnCtx(e);if(s.parsedType!==Cl.string&&s.parsedType!==Cl.number){const e=Nl.objectValues(t);return Dl(s,{expected:Nl.joinValues(e),received:s.parsedType,code:Al.invalid_type}),Ml}if(Zl(this,Hl)||Bl(this,Hl,new Set(Nl.getValidEnumValues(this._def.values))),!Zl(this,Hl).has(e.data)){const e=Nl.objectValues(t);return Dl(s,{received:s.data,code:Al.invalid_enum_value,options:e}),Ml}return Ll(e.data)}get enum(){return this._def.values}}Hl=new WeakMap,Yc.create=(e,t)=>new Yc({values:e,typeName:hd.ZodNativeEnum,...Ql(t)});class Qc extends Xl{unwrap(){return this._def.type}_parse(e){const{ctx:t}=this._processInputParams(e);if(t.parsedType!==Cl.promise&&!1===t.common.async)return Dl(t,{code:Al.invalid_type,expected:Cl.promise,received:t.parsedType}),Ml;const s=t.parsedType===Cl.promise?t.data:Promise.resolve(t.data);return Ll(s.then((e=>this._def.type.parseAsync(e,{path:t.path,errorMap:t.common.contextualErrorMap}))))}}Qc.create=(e,t)=>new Qc({type:e,typeName:hd.ZodPromise,...Ql(t)});class Xc extends Xl{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===hd.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:t,ctx:s}=this._processInputParams(e),r=this._def.effect||null,a={addIssue:e=>{Dl(s,e),e.fatal?t.abort():t.dirty()},get path(){return s.path}};if(a.addIssue=a.addIssue.bind(a),"preprocess"===r.type){const e=r.transform(s.data,a);if(s.common.async)return Promise.resolve(e).then((async e=>{if("aborted"===t.value)return Ml;const r=await this._def.schema._parseAsync({data:e,path:s.path,parent:s});return"aborted"===r.status?Ml:"dirty"===r.status||"dirty"===t.value?ql(r.value):r}));{if("aborted"===t.value)return Ml;const r=this._def.schema._parseSync({data:e,path:s.path,parent:s});return"aborted"===r.status?Ml:"dirty"===r.status||"dirty"===t.value?ql(r.value):r}}if("refinement"===r.type){const e=e=>{const t=r.refinement(e,a);if(s.common.async)return Promise.resolve(t);if(t instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return e};if(!1===s.common.async){const r=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});return"aborted"===r.status?Ml:("dirty"===r.status&&t.dirty(),e(r.value),{status:t.value,value:r.value})}return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then((s=>"aborted"===s.status?Ml:("dirty"===s.status&&t.dirty(),e(s.value).then((()=>({status:t.value,value:s.value}))))))}if("transform"===r.type){if(!1===s.common.async){const e=this._def.schema._parseSync({data:s.data,path:s.path,parent:s});if(!Vl(e))return e;const i=r.transform(e.value,a);if(i instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:t.value,value:i}}return this._def.schema._parseAsync({data:s.data,path:s.path,parent:s}).then((e=>Vl(e)?Promise.resolve(r.transform(e.value,a)).then((e=>({status:t.value,value:e}))):e))}Nl.assertNever(r)}}Xc.create=(e,t,s)=>new Xc({schema:e,typeName:hd.ZodEffects,effect:t,...Ql(s)}),Xc.createWithPreprocess=(e,t,s)=>new Xc({schema:t,effect:{type:"preprocess",transform:e},typeName:hd.ZodEffects,...Ql(s)});class ed extends Xl{_parse(e){return this._getType(e)===Cl.undefined?Ll(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}ed.create=(e,t)=>new ed({innerType:e,typeName:hd.ZodOptional,...Ql(t)});class td extends Xl{_parse(e){return this._getType(e)===Cl.null?Ll(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}td.create=(e,t)=>new td({innerType:e,typeName:hd.ZodNullable,...Ql(t)});class sd extends Xl{_parse(e){const{ctx:t}=this._processInputParams(e);let s=t.data;return t.parsedType===Cl.undefined&&(s=this._def.defaultValue()),this._def.innerType._parse({data:s,path:t.path,parent:t})}removeDefault(){return this._def.innerType}}sd.create=(e,t)=>new sd({innerType:e,typeName:hd.ZodDefault,defaultValue:"function"==typeof t.default?t.default:()=>t.default,...Ql(t)});class rd extends Xl{_parse(e){const{ctx:t}=this._processInputParams(e),s={...t,common:{...t.common,issues:[]}},r=this._def.innerType._parse({data:s.data,path:s.path,parent:{...s}});return Ul(r)?r.then((e=>({status:"valid",value:"valid"===e.status?e.value:this._def.catchValue({get error(){return new Pl(s.common.issues)},input:s.data})}))):{status:"valid",value:"valid"===r.status?r.value:this._def.catchValue({get error(){return new Pl(s.common.issues)},input:s.data})}}removeCatch(){return this._def.innerType}}rd.create=(e,t)=>new rd({innerType:e,typeName:hd.ZodCatch,catchValue:"function"==typeof t.catch?t.catch:()=>t.catch,...Ql(t)});class ad extends Xl{_parse(e){if(this._getType(e)!==Cl.nan){const t=this._getOrReturnCtx(e);return Dl(t,{code:Al.invalid_type,expected:Cl.nan,received:t.parsedType}),Ml}return{status:"valid",value:e.data}}}ad.create=e=>new ad({typeName:hd.ZodNaN,...Ql(e)});const id=Symbol("zod_brand");class nd extends Xl{_parse(e){const{ctx:t}=this._processInputParams(e),s=t.data;return this._def.type._parse({data:s,path:t.path,parent:t})}unwrap(){return this._def.type}}class od extends Xl{_parse(e){const{status:t,ctx:s}=this._processInputParams(e);if(s.common.async){return(async()=>{const e=await this._def.in._parseAsync({data:s.data,path:s.path,parent:s});return"aborted"===e.status?Ml:"dirty"===e.status?(t.dirty(),ql(e.value)):this._def.out._parseAsync({data:e.value,path:s.path,parent:s})})()}{const e=this._def.in._parseSync({data:s.data,path:s.path,parent:s});return"aborted"===e.status?Ml:"dirty"===e.status?(t.dirty(),{status:"dirty",value:e.value}):this._def.out._parseSync({data:e.value,path:s.path,parent:s})}}static create(e,t){return new od({in:e,out:t,typeName:hd.ZodPipeline})}}class ld extends Xl{_parse(e){const t=this._def.innerType._parse(e),s=e=>(Vl(e)&&(e.value=Object.freeze(e.value)),e);return Ul(t)?t.then((e=>s(e))):s(t)}unwrap(){return this._def.innerType}}function cd(e,t){const s="function"==typeof e?e(t):"string"==typeof e?{message:e}:e;return"string"==typeof s?{message:s}:s}function dd(e,t={},s){return e?Pc.create().superRefine(((r,a)=>{var i,n;const o=e(r);if(o instanceof Promise)return o.then((e=>{var i,n;if(!e){const e=cd(t,r),o=null===(n=null!==(i=e.fatal)&&void 0!==i?i:s)||void 0===n||n;a.addIssue({code:"custom",...e,fatal:o})}}));if(!o){const e=cd(t,r),o=null===(n=null!==(i=e.fatal)&&void 0!==i?i:s)||void 0===n||n;a.addIssue({code:"custom",...e,fatal:o})}})):Pc.create()}ld.create=(e,t)=>new ld({innerType:e,typeName:hd.ZodReadonly,...Ql(t)});const ud={object:Ic.lazycreate};var hd,md;(md=hd||(hd={})).ZodString="ZodString",md.ZodNumber="ZodNumber",md.ZodNaN="ZodNaN",md.ZodBigInt="ZodBigInt",md.ZodBoolean="ZodBoolean",md.ZodDate="ZodDate",md.ZodSymbol="ZodSymbol",md.ZodUndefined="ZodUndefined",md.ZodNull="ZodNull",md.ZodAny="ZodAny",md.ZodUnknown="ZodUnknown",md.ZodNever="ZodNever",md.ZodVoid="ZodVoid",md.ZodArray="ZodArray",md.ZodObject="ZodObject",md.ZodUnion="ZodUnion",md.ZodDiscriminatedUnion="ZodDiscriminatedUnion",md.ZodIntersection="ZodIntersection",md.ZodTuple="ZodTuple",md.ZodRecord="ZodRecord",md.ZodMap="ZodMap",md.ZodSet="ZodSet",md.ZodFunction="ZodFunction",md.ZodLazy="ZodLazy",md.ZodLiteral="ZodLiteral",md.ZodEnum="ZodEnum",md.ZodEffects="ZodEffects",md.ZodNativeEnum="ZodNativeEnum",md.ZodOptional="ZodOptional",md.ZodNullable="ZodNullable",md.ZodDefault="ZodDefault",md.ZodCatch="ZodCatch",md.ZodPromise="ZodPromise",md.ZodBranded="ZodBranded",md.ZodPipeline="ZodPipeline",md.ZodReadonly="ZodReadonly";const pd=bc.create,xd=Nc.create,gd=ad.create,fd=_c.create,vd=kc.create,yd=Sc.create,jd=Cc.create,bd=Tc.create,wd=Ac.create,Nd=Pc.create,_d=Ec.create,kd=Oc.create,Sd=$c.create,Cd=Rc.create,Td=Ic.create,Ad=Ic.strictCreate,Pd=Mc.create,Ed=Lc.create,Od=zc.create,$d=Vc.create,Rd=Uc.create,Dd=Zc.create,Id=Bc.create,Md=Gc.create,qd=Wc.create,Ld=Jc.create,Fd=Kc.create,zd=Yc.create,Vd=Qc.create,Ud=Xc.create,Zd=ed.create,Bd=td.create,Gd=Xc.createWithPreprocess,Wd=od.create,Jd={string:e=>bc.create({...e,coerce:!0}),number:e=>Nc.create({...e,coerce:!0}),boolean:e=>kc.create({...e,coerce:!0}),bigint:e=>_c.create({...e,coerce:!0}),date:e=>Sc.create({...e,coerce:!0})},Hd=Ml;var Kd=Object.freeze({__proto__:null,defaultErrorMap:El,setErrorMap:function(e){Ol=e},getErrorMap:$l,makeIssue:Rl,EMPTY_PATH:[],addIssueToContext:Dl,ParseStatus:Il,INVALID:Ml,DIRTY:ql,OK:Ll,isAborted:Fl,isDirty:zl,isValid:Vl,isAsync:Ul,get util(){return Nl},get objectUtil(){return kl},ZodParsedType:Cl,getParsedType:Tl,ZodType:Xl,datetimeRegex:vc,ZodString:bc,ZodNumber:Nc,ZodBigInt:_c,ZodBoolean:kc,ZodDate:Sc,ZodSymbol:Cc,ZodUndefined:Tc,ZodNull:Ac,ZodAny:Pc,ZodUnknown:Ec,ZodNever:Oc,ZodVoid:$c,ZodArray:Rc,ZodObject:Ic,ZodUnion:Mc,ZodDiscriminatedUnion:Lc,ZodIntersection:zc,ZodTuple:Vc,ZodRecord:Uc,ZodMap:Zc,ZodSet:Bc,ZodFunction:Gc,ZodLazy:Wc,ZodLiteral:Jc,ZodEnum:Kc,ZodNativeEnum:Yc,ZodPromise:Qc,ZodEffects:Xc,ZodTransformer:Xc,ZodOptional:ed,ZodNullable:td,ZodDefault:sd,ZodCatch:rd,ZodNaN:ad,BRAND:id,ZodBranded:nd,ZodPipeline:od,ZodReadonly:ld,custom:dd,Schema:Xl,ZodSchema:Xl,late:ud,get ZodFirstPartyTypeKind(){return hd},coerce:Jd,any:Nd,array:Cd,bigint:fd,boolean:vd,date:yd,discriminatedUnion:Ed,effect:Ud,enum:Fd,function:Md,instanceof:(e,t={message:`Input not instance of ${e.name}`})=>dd((t=>t instanceof e),t),intersection:Od,lazy:qd,literal:Ld,map:Dd,nan:gd,nativeEnum:zd,never:kd,null:wd,nullable:Bd,number:xd,object:Td,oboolean:()=>vd().optional(),onumber:()=>xd().optional(),optional:Zd,ostring:()=>pd().optional(),pipeline:Wd,preprocess:Gd,promise:Vd,record:Rd,set:Id,strictObject:Ad,string:pd,symbol:jd,transformer:Ud,tuple:$d,undefined:bd,union:Pd,unknown:_d,void:Sd,NEVER:Hd,ZodIssueCode:Al,quotelessJson:e=>JSON.stringify(e,null,2).replace(/"([^"]+)":/g,"$1:"),ZodError:Pl});const Yd=Kd.object({name:Kd.string().min(1,"Name is required"),start_date:Kd.string().min(1,"Start date is required"),end_date:Kd.string().min(1,"End date is required"),allocation_type:Kd.enum(["individual","tier"]),title:Kd.string().optional(),message:Kd.string().optional(),confirmation_message:Kd.string().optional(),cart_min:Kd.number().min(0).optional(),cart_max:Kd.number().min(0).optional(),min_amount:Kd.number().min(0).optional(),order_discount_type:Kd.enum(["percentage","fixed"]).optional(),order_discount_amount:Kd.number().min(0).optional(),shipping_discount_type:Kd.enum(["percentage","fixed"]).optional(),shipping_discount_amount:Kd.number().min(0).optional(),shipping_discount_method:Kd.string().optional()});function Qd({allocation:t}){var s,r,a,i,n,o,l,c,d;const{register:u,handleSubmit:h,watch:m,setValue:p,formState:{errors:x}}=vl({resolver:(g=Yd,void 0===v&&(v={}),function(e,t,s){try{return Promise.resolve(function(t,r){try{var a=Promise.resolve(g["sync"===v.mode?"parse":"parseAsync"](e,f)).then((function(t){return s.shouldUseNativeValidation&&jl({},s),{errors:{},values:v.raw?e:t}}))}catch(i){return r(i)}return a&&a.then?a.then(void 0,r):a}(0,(function(e){if(t=e,Array.isArray(null==t?void 0:t.errors))return{values:{},errors:bl(Sl(e.errors,!s.shouldUseNativeValidation&&"all"===s.criteriaMode),s)};var t;throw e})))}catch(r){return Promise.reject(r)}}),defaultValues:{name:t.name,start_date:new Date(t.start_date).toISOString().slice(0,16),end_date:new Date(t.end_date).toISOString().slice(0,16),allocation_type:t.allocation_type||"individual",title:t.title||"",message:t.message||"",confirmation_message:t.confirmation_message||"",cart_min:t.cart_min||0,cart_max:t.cart_max||0,min_amount:t.min_amount||0,order_discount_type:t.order_discount_type||void 0,order_discount_amount:t.order_discount_amount||0,shipping_discount_type:t.shipping_discount_type||void 0,shipping_discount_amount:t.shipping_discount_amount||0,shipping_discount_method:t.shipping_discount_method||""}});var g,f,v;const y=m("allocation_type");return e.jsxs("form",{onSubmit:h((async e=>{try{const{error:s}=await Rr.from("allocations").update(e).eq("id",t.id);if(s)throw s}catch(s){}})),className:"space-y-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium",children:"Basic Information"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Configure the fundamental details of your allocation."})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"name",children:"Allocation Name"}),e.jsx(Gi,{id:"name",...u("name"),error:null==(s=x.name)?void 0:s.message})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"start_date",children:"Start Date"}),e.jsx(Gi,{type:"datetime-local",id:"start_date",...u("start_date"),error:null==(r=x.start_date)?void 0:r.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"end_date",children:"End Date"}),e.jsx(Gi,{type:"datetime-local",id:"end_date",...u("end_date"),error:null==(a=x.end_date)?void 0:a.message})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx($n,{children:"Allocation Type"}),e.jsxs(Ln,{value:y,onValueChange:e=>p("allocation_type",e),className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx(Fn,{value:"individual",id:"individual"}),e.jsxs("div",{children:[e.jsx($n,{htmlFor:"individual",className:"font-medium",children:"Individual"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Customize allocations for each customer individually"})]})]}),e.jsxs("div",{className:"flex items-start space-x-4",children:[e.jsx(Fn,{value:"tier",id:"tier"}),e.jsxs("div",{children:[e.jsx($n,{htmlFor:"tier",className:"font-medium",children:"Tier-based"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Group customers into tiers with shared allocation settings"})]})]})]})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium",children:"Messaging"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Configure the messages your customers will see."})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"title",children:"Allocation Title"}),e.jsx(Gi,{id:"title",...u("title"),error:null==(i=x.title)?void 0:i.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"message",children:"Allocation Message"}),e.jsx(Vn,{id:"message",rows:4,...u("message"),error:null==(n=x.message)?void 0:n.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"confirmation_message",children:"Confirmation Message"}),e.jsx(Vn,{id:"confirmation_message",rows:4,...u("confirmation_message"),error:null==(o=x.confirmation_message)?void 0:o.message})]})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium",children:"Purchase Requirements"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Set minimum and maximum purchase requirements."})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"cart_min",children:"Minimum Bottles"}),e.jsx(Gi,{type:"number",id:"cart_min",min:"0",...u("cart_min",{valueAsNumber:!0}),error:null==(l=x.cart_min)?void 0:l.message})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"cart_max",children:"Maximum Bottles"}),e.jsx(Gi,{type:"number",id:"cart_max",min:"0",...u("cart_max",{valueAsNumber:!0}),error:null==(c=x.cart_max)?void 0:c.message})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"min_amount",children:"Minimum Purchase Amount"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),e.jsx(Gi,{type:"number",id:"min_amount",className:"pl-7",min:"0",step:"0.01",...u("min_amount",{valueAsNumber:!0}),error:null==(d=x.min_amount)?void 0:d.message})]})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(Ri,{type:"submit",children:"Save Changes"})})]})}function Xd({allocation:t,onChange:s,value:r}){var a,i,n,o,l,c,d,u,h,m,p,x,g;const{request:f,loading:v}=Qn(),[y,j]=te.useState([]),[b,w]=te.useState(null);te.useEffect((()=>{(async()=>{try{w(null);const e=await f((e=>e.getAvailableProducts()));if(e){const t=Array.isArray(e)?e:Object.values(e);j(t)}}catch(e){w(e instanceof Error?e.message:"Failed to load products")}})()}),[f]);const N=(e,t)=>{s({...r,overrides:{...r.overrides,[e]:t?r.overrides[e]||{}:null}})},_=(e,t,a)=>{s({...r,overrides:{...r.overrides,[e]:{...r.overrides[e]||{},[t]:a}}})};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx($n,{className:"text-base",children:"Purchase Requirements"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rn,{id:"override-requirements",checked:!!(null==(a=r.overrides)?void 0:a.requirements),onCheckedChange:e=>N("requirements",!!e)}),e.jsx($n,{htmlFor:"override-requirements",className:"text-sm",children:"Override defaults"})]})]}),(null==(i=r.overrides)?void 0:i.requirements)&&e.jsxs("div",{className:"ml-6 grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Minimum Bottles"}),e.jsx(Gi,{type:"number",min:"0",value:r.overrides.requirements.cartMin||"",onChange:e=>_("requirements","cartMin",parseInt(e.target.value)),placeholder:null==(n=t.cart_min)?void 0:n.toString()})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Maximum Bottles"}),e.jsx(Gi,{type:"number",min:"0",value:r.overrides.requirements.cartMax||"",onChange:e=>_("requirements","cartMax",parseInt(e.target.value)),placeholder:null==(o=t.cart_max)?void 0:o.toString()})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Minimum Purchase Amount"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),e.jsx(Gi,{type:"number",min:"0",step:"0.01",className:"pl-7",value:r.overrides.requirements.minAmount||"",onChange:e=>_("requirements","minAmount",parseFloat(e.target.value)),placeholder:null==(l=t.min_amount)?void 0:l.toString()})]})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx($n,{className:"text-base",children:"Order Discounts"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rn,{id:"override-discounts",checked:!!(null==(c=r.overrides)?void 0:c.discounts),onCheckedChange:e=>N("discounts",!!e)}),e.jsx($n,{htmlFor:"override-discounts",className:"text-sm",children:"Override defaults"})]})]}),(null==(d=r.overrides)?void 0:d.discounts)&&e.jsxs("div",{className:"ml-6 space-y-4",children:[e.jsxs(Ln,{value:r.overrides.discounts.type||"percentage",onValueChange:e=>_("discounts","type",e),className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fn,{value:"percentage",id:"percentage"}),e.jsx($n,{htmlFor:"percentage",children:"Percentage"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fn,{value:"fixed",id:"fixed"}),e.jsx($n,{htmlFor:"fixed",children:"Fixed Amount"})]})]}),e.jsxs("div",{className:"relative",children:["fixed"===r.overrides.discounts.type&&e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),e.jsx(Gi,{type:"number",min:"0",step:"percentage"===r.overrides.discounts.type?"1":"0.01",className:"fixed"===r.overrides.discounts.type?"pl-7":"",value:r.overrides.discounts.amount||"",onChange:e=>_("discounts","amount",parseFloat(e.target.value)),placeholder:null==(u=t.order_discount_amount)?void 0:u.toString()}),"percentage"===r.overrides.discounts.type&&e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"%"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx($n,{className:"text-base",children:"Shipping Discounts"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rn,{id:"override-shipping",checked:!!(null==(h=r.overrides)?void 0:h.shipping),onCheckedChange:e=>N("shipping",!!e)}),e.jsx($n,{htmlFor:"override-shipping",className:"text-sm",children:"Override defaults"})]})]}),(null==(m=r.overrides)?void 0:m.shipping)&&e.jsxs("div",{className:"ml-6 space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Shipping Method"}),e.jsxs(Wi,{value:r.overrides.shipping.method||"",onValueChange:e=>_("shipping","method",e),children:[e.jsx(Hi,{children:e.jsx(Ji,{placeholder:"Select shipping method"})}),e.jsxs(Qi,{children:[e.jsx(Xi,{value:"ground",children:"Ground Shipping"}),e.jsx(Xi,{value:"2day",children:"2-Day Air"}),e.jsx(Xi,{value:"overnight",children:"Overnight"})]})]})]}),e.jsxs(Ln,{value:r.overrides.shipping.type||"percentage",onValueChange:e=>_("shipping","type",e),className:"flex items-center space-x-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fn,{value:"percentage",id:"shipping-percentage"}),e.jsx($n,{htmlFor:"shipping-percentage",children:"Percentage"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fn,{value:"fixed",id:"shipping-fixed"}),e.jsx($n,{htmlFor:"shipping-fixed",children:"Fixed Amount"})]})]}),e.jsxs("div",{className:"relative",children:["fixed"===r.overrides.shipping.type&&e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),e.jsx(Gi,{type:"number",min:"0",step:"percentage"===r.overrides.shipping.type?"1":"0.01",className:"fixed"===r.overrides.shipping.type?"pl-7":"",value:r.overrides.shipping.amount||"",onChange:e=>_("shipping","amount",parseFloat(e.target.value)),placeholder:null==(p=t.shipping_discount_amount)?void 0:p.toString()}),"percentage"===r.overrides.shipping.type&&e.jsx("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"%"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx($n,{className:"text-base",children:"Product Settings"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Rn,{id:"override-products",checked:!!(null==(x=r.overrides)?void 0:x.products),onCheckedChange:e=>N("products",!!e)}),e.jsx($n,{htmlFor:"override-products",className:"text-sm",children:"Override defaults"})]})]}),(null==(g=r.overrides)?void 0:g.products)&&e.jsx("div",{className:"ml-6 space-y-4",children:v?e.jsxs("div",{className:"flex items-center justify-center p-4",children:[e.jsx(ha,{className:"h-6 w-6 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-2 text-sm text-gray-500",children:"Loading available products..."})]}):b?e.jsx("div",{className:"p-4 text-red-600 text-sm bg-red-50 rounded-lg",children:b}):0===y.length?e.jsx("div",{className:"p-4 text-gray-500 text-sm bg-gray-50 rounded-lg",children:"No products available"}):e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Product Selection"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure product-specific overrides in the next step"}),e.jsxs("div",{className:"mt-2 text-sm text-blue-600",children:[y.length," products available for configuration"]})]})})]})]})}function eu({allocation:t,tierId:s,initialOverrides:r={},onSave:a,onClose:i}){const[n,o]=te.useState([]),[l,c]=te.useState(r),[d,u]=te.useState(!0);te.useEffect((()=>{(async()=>{try{const{data:e,error:r}=await Rr.from("allocation_products").select("*").eq("allocation_id",t.id);if(r)throw r;if(o(e||[]),s){const{data:e,error:t}=await Rr.from("tier_product_overrides").select("*").eq("tier_id",s);if(t)throw t;const r={};null==e||e.forEach((e=>{r[e.product_id]={productId:e.product_id,overridePrice:e.override_price,minPurchase:e.min_purchase,maxPurchase:e.max_purchase,allowWishRequests:e.allow_wish_requests,wishRequestMin:e.wish_request_min,wishRequestMax:e.wish_request_max}})),c(r)}}catch(e){}finally{u(!1)}})()}),[t.id,s]);const h=(e,t,s)=>{c((r=>({...r,[e]:{...r[e]||{productId:e,allowWishRequests:!1},[t]:s}})))};return d?e.jsx("div",{className:"text-center py-8",children:"Loading products..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Product Overrides"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Configure product-specific settings for this tier."})]}),e.jsx("div",{className:"space-y-6",children:n.map((t=>{var s,r,a,i,n,o,c;return e.jsxs("div",{className:"border rounded-lg p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:t.product_id}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Base Price: $",t.override_price||"Default"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Override Price"}),e.jsxs("div",{className:"relative",children:[e.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),e.jsx(Gi,{type:"number",value:(null==(s=l[t.id])?void 0:s.overridePrice)||"",onChange:e=>h(t.id,"overridePrice",e.target.value?parseFloat(e.target.value):void 0),className:"pl-7",placeholder:(t.override_price||"").toString(),min:"0",step:"0.01"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Min Purchase"}),e.jsx(Gi,{type:"number",value:(null==(r=l[t.id])?void 0:r.minPurchase)||"",onChange:e=>h(t.id,"minPurchase",e.target.value?parseInt(e.target.value):void 0),placeholder:(t.min_purchase||"").toString(),min:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Max Purchase"}),e.jsx(Gi,{type:"number",value:(null==(a=l[t.id])?void 0:a.maxPurchase)||"",onChange:e=>h(t.id,"maxPurchase",e.target.value?parseInt(e.target.value):void 0),placeholder:(t.max_purchase||"").toString(),min:"0"})]})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Rn,{id:`wishRequests-${t.id}`,checked:(null==(i=l[t.id])?void 0:i.allowWishRequests)??t.allow_wish_requests,onCheckedChange:e=>h(t.id,"allowWishRequests",e)}),e.jsx($n,{htmlFor:`wishRequests-${t.id}`,children:"Allow Wish Requests"})]}),((null==(n=l[t.id])?void 0:n.allowWishRequests)??t.allow_wish_requests)&&e.jsxs("div",{className:"ml-6 grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Min Wish Request"}),e.jsx(Gi,{type:"number",value:(null==(o=l[t.id])?void 0:o.wishRequestMin)||"",onChange:e=>h(t.id,"wishRequestMin",e.target.value?parseInt(e.target.value):void 0),placeholder:(t.wish_request_min||"").toString(),min:"0"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Max Wish Request"}),e.jsx(Gi,{type:"number",value:(null==(c=l[t.id])?void 0:c.wishRequestMax)||"",onChange:e=>h(t.id,"wishRequestMax",e.target.value?parseInt(e.target.value):void 0),placeholder:(t.wish_request_max||"").toString(),min:"0"})]})]})]})]},t.id)}))}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ri,{variant:"outline",onClick:i,children:"Cancel"}),e.jsx(Ri,{onClick:async()=>{if(a)a(l);else if(s)try{await Rr.from("tier_product_overrides").delete().eq("tier_id",s);const e=Object.values(l).map((e=>({tier_id:s,product_id:e.productId,override_price:e.overridePrice,min_purchase:e.minPurchase,max_purchase:e.maxPurchase,allow_wish_requests:e.allowWishRequests,wish_request_min:e.wishRequestMin,wish_request_max:e.wishRequestMax}))),{error:t}=await Rr.from("tier_product_overrides").insert(e);if(t)throw t;await Rr.from("tier_overrides").upsert({tier_id:s,has_product_overrides:!0}),i()}catch(e){}},children:"Save Product Overrides"})]})]})}const tu=te.lazy((()=>xe((()=>import("./CustomerSearch-91yax2Nn.js")),__vite__mapDeps([2,3,1,4])))),su=te.lazy((()=>xe((()=>import("./QueryList-CfNXohZy.js")),__vite__mapDeps([5,3,1,4])))),ru=te.lazy((()=>xe((()=>import("./TagList-W2pCEymf.js")),__vite__mapDeps([6,3,1,4])))),au=te.lazy((()=>xe((()=>import("./GroupList-8IalffFt.js")),__vite__mapDeps([7,3,1,4])))),iu=te.lazy((()=>xe((()=>import("./ClubList-BHo-9fE0.js")),__vite__mapDeps([8,3,1,4])))),nu=[{id:"query",name:"Queries",icon:na,description:"Choose queries to add matching customers to this tier"},{id:"tag",name:"Tags",icon:Na,description:"Select customer tags to add tagged customers to this tier"},{id:"group",name:"Groups",icon:Ea,description:"Add customers from selected customer groups"},{id:"club",name:"Clubs",icon:Oa,description:"Add customers from wine club memberships"},{id:"search",name:"Search",icon:ya,description:"Search and select individual customers to add"}],ou={q1:{name:"High Value Customers",count:150},q2:{name:"Recent Purchasers",count:75},q3:{name:"Club Members",count:200},t1:{name:"VIP",count:150},t2:{name:"Collector",count:75},t3:{name:"Early Access",count:200},g1:{name:"West Coast",count:500},g2:{name:"East Coast",count:300},g3:{name:"Trade",count:100},c1:{name:"Reserve Club",count:250},c2:{name:"Reds Only",count:175},c3:{name:"Mixed Club",count:300},cust1:{name:"John Doe"},cust2:{name:"Jane Smith"},cust3:{name:"Bob Wilson"}},lu=ne.memo((({selectedSource:t,onSourceChange:s})=>e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-5 gap-4",children:nu.map((r=>e.jsxs("button",{onClick:()=>s(r.id),className:`\n          relative group rounded-lg border bg-white p-6 transition-all duration-200\n          ${t===r.id?"bg-primary/5 border-primary/20":"bg-card hover:bg-accent/50"}\n        `,children:[e.jsx(r.icon,{className:"w-6 h-6"}),e.jsx("span",{className:"text-sm font-medium text-center",children:r.name})]},r.id)))})));function cu({allocation:t}){const[s,r]=te.useState(!1),[a,i]=te.useState("query"),[n,o]=te.useState([]),[l,c]=te.useState([]),[d,u]=te.useState([]),[h,m]=te.useState(new Set),[p,x]=te.useState(!0),[g,f]=te.useState(null),[v,y]=te.useState(!1),[j,b]=te.useState({name:"",level:1,accessStart:"",accessEnd:"",overrides:{}}),w=te.useCallback((e=>{i(e),o([])}),[]),N=te.useCallback((e=>{o((t=>{const s=t.includes(e)?t.filter((t=>t!==e)):[...t,e],r=a;return 0===s.length?c((e=>e.filter((e=>e.sourceId!==r)))):c((e=>{const t=e.findIndex((e=>e.sourceId===r)),a=s.filter((e=>ou[e])).map((e=>({id:e,...ou[e]})));if(-1===t)return[...e,{sourceId:r,items:a}];const i=[...e];return i[t]={sourceId:r,items:a},i})),s}))}),[a]),_=te.useCallback((e=>{c((t=>t.filter((t=>t.sourceId!==e)))),e===a&&o([])}),[a]),k=te.useMemo((()=>{var e;return null==(e=nu.find((e=>e.id===a)))?void 0:e.description}),[a]),S=te.useMemo((()=>l.reduce(((e,t)=>e+t.items.reduce(((e,t)=>e+(t.count||1)),0)),0)),[l]),C=te.useCallback((async()=>{try{x(!0);const{data:e,error:s}=await Rr.from("allocation_tiers").select("\n          id,\n          name,\n          level,\n          access_start,\n          access_end,\n          customer_count\n        ").eq("allocation_id",t.id).order("level",{ascending:!0});if(s)throw s;const r=await Promise.all((e||[]).map((async e=>{const{data:t}=await Rr.from("tier_overrides").select("*").eq("tier_id",e.id).maybeSingle();return{...e,overrides:t||void 0}})));u(r)}catch(e){}finally{x(!1)}}),[t.id]);te.useEffect((()=>{C()}),[C]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium",children:"Allocation Tiers"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Create and manage customer tiers for this allocation."})]}),e.jsxs(Ri,{onClick:()=>r(!0),children:[e.jsx(fa,{className:"w-4 h-4 mr-2"}),"Create Tier"]})]}),s&&e.jsxs("div",{className:"bg-card rounded-lg border p-6 space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Create New Tier"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Configure tier settings and add customers."})]}),e.jsxs("div",{className:"grid gap-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"tierName",children:"Tier Name"}),e.jsx(Gi,{id:"tierName",value:j.name,onChange:e=>b((t=>({...t,name:e.target.value}))),placeholder:"e.g., Premium Members"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"tierLevel",children:"Tier Level"}),e.jsx(Gi,{type:"number",id:"tierLevel",min:"1",value:j.level,onChange:e=>b((t=>({...t,level:parseInt(e.target.value)})))})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"accessStart",children:"Access Start"}),e.jsx(Gi,{type:"datetime-local",id:"accessStart",value:j.accessStart,onChange:e=>b((t=>({...t,accessStart:e.target.value})))})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"accessEnd",children:"Access End"}),e.jsx(Gi,{type:"datetime-local",id:"accessEnd",value:j.accessEnd,onChange:e=>b((t=>({...t,accessEnd:e.target.value})))})]})]})]}),e.jsx("div",{className:"border-t pt-6",children:e.jsx(Xd,{allocation:t,value:j,onChange:b})}),j.overrides.products&&e.jsx("div",{className:"border-t pt-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Product Settings"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Configure product-specific settings for this tier."})]}),e.jsx(Ri,{variant:"outline",onClick:()=>y(!0),children:"Configure Products"})]})}),e.jsxs("div",{className:"border-t pt-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx($n,{children:"Add Customers"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:k})]}),e.jsx(lu,{selectedSource:a,onSourceChange:w}),e.jsx("div",{className:"mt-4 border rounded-lg",children:(()=>{const t={selectedItems:n,onItemSelect:N};return e.jsxs(te.Suspense,{fallback:e.jsx("div",{className:"p-4 text-center",children:"Loading..."}),children:["search"===a&&e.jsx(tu,{...t}),"query"===a&&e.jsx(su,{...t}),"tag"===a&&e.jsx(ru,{...t}),"group"===a&&e.jsx(au,{...t}),"club"===a&&e.jsx(iu,{...t})]})})()}),l.length>0&&e.jsxs("div",{className:"bg-muted/50 rounded-lg p-4 space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h4",{className:"font-medium",children:"Selected Sources"}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:[S.toLocaleString()," total customers"]})]}),e.jsx("div",{className:"space-y-3",children:l.map((t=>{const s=nu.find((e=>e.id===t.sourceId)),r=t.items.reduce(((e,t)=>e+(t.count||1)),0);return e.jsxs("div",{className:"bg-background rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[s&&e.jsx(s.icon,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:null==s?void 0:s.name}),e.jsxs("span",{className:"text-sm text-muted-foreground",children:["(",r.toLocaleString()," customers)"]})]}),e.jsx(Ri,{variant:"ghost",size:"sm",onClick:()=>_(t.sourceId),children:e.jsx(Ra,{className:"w-4 h-4"})})]}),e.jsx("div",{className:"space-y-1",children:t.items.map((t=>e.jsxs("div",{className:"text-sm flex items-center justify-between",children:[e.jsx("span",{children:t.name}),t.count&&e.jsxs("span",{className:"text-muted-foreground",children:[t.count.toLocaleString()," customers"]})]},t.id)))})]},t.sourceId)}))})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ri,{variant:"outline",onClick:()=>r(!1),children:"Cancel"}),e.jsx(Ri,{onClick:async()=>{try{if(!(j.name&&j.level&&j.accessStart&&j.accessEnd))throw new Error("Please fill in all required fields");const{data:e,error:s}=await Rr.from("allocation_tiers").insert({allocation_id:t.id,name:j.name,level:j.level,access_start:new Date(j.accessStart).toISOString(),access_end:new Date(j.accessEnd).toISOString(),customer_count:S}).select().single();if(s)throw s;if(Object.keys(j.overrides).length>0){const{error:t}=await Rr.from("tier_overrides").insert({tier_id:e.id,requirements:j.overrides.requirements||null,discounts:j.overrides.discounts||null,shipping:j.overrides.shipping||null,has_product_overrides:!!j.overrides.products});if(t)throw t}if(l.length>0){const s=l.flatMap((s=>s.items.map((r=>({allocation_id:t.id,tier_id:e.id,customer_id:r.id,source_type:s.sourceId,source_id:r.id,created_at:(new Date).toISOString()}))))),{error:r}=await Rr.from("customer_tiers").insert(s);if(r)throw r}await C(),b({name:"",level:1,accessStart:"",accessEnd:"",overrides:{}}),c([]),o([]),r(!1)}catch(e){}},children:"Create Tier"})]})]}),e.jsx("div",{className:"space-y-4",children:p?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:"Loading tiers..."}):0===d.length?e.jsx("div",{className:"text-center py-8 text-muted-foreground",children:'No tiers created yet. Click "Create Tier" to add your first tier.'}):d.map((t=>e.jsxs("div",{className:"border rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 cursor-pointer",onClick:()=>{return e=t.id,void m((t=>{const s=new Set(t);return s.has(e)?s.delete(e):s.add(e),s}));var e},children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-primary/10 text-primary font-medium",children:t.level}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium",children:t.name}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:[t.customer_count.toLocaleString()," customers"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ri,{variant:"ghost",size:"sm",children:e.jsx(wa,{className:"w-4 h-4"})}),e.jsx(Ri,{variant:"ghost",size:"sm",onClick:e=>{e.stopPropagation(),(async e=>{try{const{error:t}=await Rr.from("allocation_tiers").delete().eq("id",e);if(t)throw t;await C()}catch(t){}})(t.id)},children:e.jsx(ka,{className:"w-4 h-4"})}),h.has(t.id)?e.jsx(Xr,{className:"w-5 h-5"}):e.jsx(Kr,{className:"w-5 h-5"})]})]}),h.has(t.id)&&e.jsxs("div",{className:"border-t p-4 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx($n,{className:"text-sm text-muted-foreground",children:"Access Start"}),e.jsx("p",{className:"mt-1",children:new Date(t.access_start).toLocaleString()})]}),e.jsxs("div",{children:[e.jsx($n,{className:"text-sm text-muted-foreground",children:"Access End"}),e.jsx("p",{className:"mt-1",children:new Date(t.access_end).toLocaleString()})]})]}),t.overrides&&e.jsxs(e.Fragment,{children:[t.overrides.requirements&&e.jsxs("div",{children:[e.jsx($n,{className:"text-sm text-muted-foreground",children:"Purchase Requirements"}),e.jsxs("div",{className:"mt-1 space-y-1",children:[t.overrides.requirements.cartMin&&e.jsxs("p",{children:["Minimum Bottles: ",t.overrides.requirements.cartMin]}),t.overrides.requirements.cartMax&&e.jsxs("p",{children:["Maximum Bottles: ",t.overrides.requirements.cartMax]}),t.overrides.requirements.minAmount&&e.jsxs("p",{children:["Minimum Amount: $",t.overrides.requirements.minAmount]})]})]}),t.overrides.discounts&&e.jsxs("div",{children:[e.jsx($n,{className:"text-sm text-muted-foreground",children:"Discounts"}),e.jsx("div",{className:"mt-1 space-y-1",children:e.jsxs("p",{children:["Order Discount: ",t.overrides.discounts.amount,"percentage"===t.overrides.discounts.type?"%":"$"]})})]}),t.overrides.shipping&&e.jsxs("div",{children:[e.jsx($n,{className:"text-sm text-muted-foreground",children:"Shipping"}),e.jsxs("div",{className:"mt-1 space-y-1",children:[e.jsxs("p",{children:["Method: ",t.overrides.shipping.method]}),e.jsxs("p",{children:["Discount: ",t.overrides.shipping.amount,"percentage"===t.overrides.shipping.type?"%":"$"]})]})]}),e.jsxs("div",{children:[e.jsx($n,{className:"text-sm text-muted-foreground",children:"Product Settings"}),e.jsx("div",{className:"mt-2",children:e.jsx(Ri,{variant:"outline",size:"sm",onClick:()=>{f(t.id)},children:t.overrides.has_product_overrides?"Edit Product Overrides":"Configure Products"})})]})]})]})]},t.id)))}),g&&e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm",children:e.jsx("div",{className:"fixed left-[50%] top-[50%] z-50 grid w-full max-w-3xl translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 rounded-lg",children:e.jsx(eu,{allocation:t,tierId:g,onClose:()=>{f(null),C()}})})}),v&&e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm",children:e.jsx("div",{className:"fixed left-[50%] top-[50%] z-50 grid w-full max-w-3xl translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 rounded-lg",children:e.jsx(eu,{allocation:t,initialOverrides:{},onSave:e=>{b((t=>({...t,productOverrides:e}))),y(!1)},onClose:()=>y(!1)})})})]})}lu.displayName="CustomerSourceSelector";const du=[{id:"queries",name:"Queries",type:"query",icon:na},{id:"tags",name:"Tags",type:"tag",icon:Na},{id:"groups",name:"Groups",type:"group",icon:Ea},{id:"clubs",name:"Clubs",type:"club",icon:Oa},{id:"search",name:"Search",type:"search",icon:ya}];function uu({allocation:t}){const[s,r]=te.useState("queries"),[a,i]=te.useState([]),[n,o]=te.useState(!1);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-medium",children:"Individual Allocations"}),e.jsx("p",{className:"mt-1 text-sm text-muted-foreground",children:"Manage individual customer allocations."})]}),e.jsxs(Ri,{onClick:()=>{o(!0)},disabled:0===a.length,children:[e.jsx(fa,{className:"w-4 h-4 mr-2"}),"Create Allocation"]})]}),e.jsxs("div",{className:"grid grid-cols-[240px,1fr] gap-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx($n,{children:"Customer Source"}),e.jsx(Ln,{value:s,onValueChange:r,className:"space-y-2",children:du.map((t=>e.jsxs("div",{className:`\n                  flex items-center gap-3 p-3 rounded-lg border cursor-pointer\n                  ${s===t.id?"bg-accent border-accent-foreground/20":"bg-card hover:bg-accent/50"}\n                `,children:[e.jsx(Fn,{value:t.id,id:t.id,className:"sr-only"}),e.jsx(t.icon,{className:"w-5 h-5"}),e.jsx($n,{htmlFor:t.id,className:"cursor-pointer flex-1",children:t.name})]},t.id)))}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsx($n,{children:"Filters"}),"queries"===s&&e.jsx("div",{className:"space-y-2",children:e.jsx(Gi,{placeholder:"Search queries..."})})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative flex-1",children:[e.jsx(ya,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"}),e.jsx(Gi,{className:"pl-10",placeholder:"Search customers..."})]}),a.length>0&&e.jsxs("div",{className:"text-sm text-muted-foreground",children:[a.length," selected"]})]}),e.jsx("div",{className:"border rounded-lg divide-y",children:[{id:"1",name:"John Doe",email:"john@example.com"},{id:"2",name:"Jane Smith",email:"jane@example.com"},{id:"3",name:"Bob Johnson",email:"bob@example.com"}].map((t=>e.jsxs("div",{className:"flex items-center gap-4 p-4 hover:bg-accent/50",children:[e.jsx(Rn,{id:`customer-${t.id}`,checked:a.includes(t.id),onCheckedChange:()=>{return e=t.id,void i((t=>t.includes(e)?t.filter((t=>t!==e)):[...t,e]));var e}}),e.jsxs("div",{className:"flex-1",children:[e.jsx($n,{htmlFor:`customer-${t.id}`,className:"font-medium cursor-pointer",children:t.name}),e.jsx("div",{className:"text-sm text-muted-foreground",children:t.email})]})]},t.id)))})]})]}),n&&e.jsx("div",{className:"fixed inset-0 bg-background/80 backdrop-blur-sm",children:e.jsx("div",{className:"fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 rounded-lg",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Create Allocation"}),e.jsxs("p",{className:"text-sm text-muted-foreground",children:["Configure allocation settings for ",a.length," selected customers."]}),e.jsx("div",{className:"space-y-4"}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ri,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsxs(Ri,{children:[e.jsx(Hr,{className:"w-4 h-4 mr-2"}),"Create Allocations"]})]})]})})})]})}function hu({allocation:t}){var s;const[r,a]=te.useState([]),[i,n]=te.useState([]),[o,l]=te.useState(!0),c=Math.ceil((new Date(t.end_date).getTime()-(new Date).getTime())/864e5),d=Math.ceil((new Date(t.end_date).getTime()-new Date(t.start_date).getTime())/864e5),u=Math.min(100,Math.max(0,(d-c)/d*100));return te.useEffect((()=>{(async()=>{try{if(l(!0),"tier"===t.allocation_type){const{data:e,error:s}=await Rr.from("allocation_tiers").select("*").eq("allocation_id",t.id).order("level",{ascending:!0});if(s)throw s;a(e||[])}const{data:e,error:s}=await Rr.from("allocation_products").select("*").eq("allocation_id",t.id);if(s)throw s;n(e||[])}catch(e){}finally{l(!1)}})()}),[t.id,t.allocation_type]),e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ta,{className:"text-blue-600",size:20}),e.jsx("div",{className:"flex-1",children:e.jsx("span",{className:"text-blue-900",children:"scheduled"===t.status?`This allocation will open in ${c} days`:"active"===t.status?`${c} days remaining in this allocation`:"completed"===t.status?"This allocation has ended":"This allocation is in draft mode"})})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Ea,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Total Customers"})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-2xl font-semibold",children:(null==(s=t.total_customers)?void 0:s.toLocaleString())||0}),e.jsx("span",{className:"text-sm text-gray-500",children:"customers"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(aa,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Current Revenue"})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-2xl font-semibold",children:["$",(t.current_revenue||0).toLocaleString()]}),e.jsxs("span",{className:"text-sm text-gray-500",children:["of $",(t.expected_revenue||0).toLocaleString()]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Oa,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Products"})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-2xl font-semibold",children:i.length}),e.jsx("span",{className:"text-sm text-gray-500",children:"available"})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Jr,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Duration"})]}),e.jsxs("div",{className:"flex items-baseline gap-2",children:[e.jsx("span",{className:"text-2xl font-semibold",children:d}),e.jsx("span",{className:"text-sm text-gray-500",children:"days total"})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Allocation Progress"}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Progress"}),e.jsxs("span",{className:"text-sm font-medium",children:[Math.round(u),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-600 rounded-full",style:{width:`${u}%`}})}),e.jsxs("div",{className:"mt-2 flex justify-between text-sm text-gray-500",children:[e.jsx("span",{children:new Date(t.start_date).toLocaleDateString()}),e.jsx("span",{children:new Date(t.end_date).toLocaleDateString()})]})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Allocation Products"}),o?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"Loading products..."}):0===i.length?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"No products have been added to this allocation yet."}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 text-left",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-3 text-sm font-medium text-gray-500",children:"Product ID"}),e.jsx("th",{className:"px-4 py-3 text-sm font-medium text-gray-500",children:"Price Override"}),e.jsx("th",{className:"px-4 py-3 text-sm font-medium text-gray-500",children:"Purchase Limits"}),e.jsx("th",{className:"px-4 py-3 text-sm font-medium text-gray-500",children:"Wish Requests"}),e.jsx("th",{className:"px-4 py-3 text-sm font-medium text-gray-500",children:"Inventory"})]})}),e.jsx("tbody",{className:"divide-y",children:i.map((t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-3 font-medium",children:t.product_id}),e.jsx("td",{className:"px-4 py-3",children:t.override_price?`$${t.override_price.toFixed(2)}`:"Default"}),e.jsx("td",{className:"px-4 py-3",children:t.min_purchase||t.max_purchase?e.jsxs("span",{children:[t.min_purchase?`Min: ${t.min_purchase}`:"",t.min_purchase&&t.max_purchase?"  ":"",t.max_purchase?`Max: ${t.max_purchase}`:""]}):e.jsx("span",{className:"text-gray-400",children:"No limits"})}),e.jsx("td",{className:"px-4 py-3",children:t.allow_wish_requests?e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:"Enabled"}):e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:"Disabled"})}),e.jsx("td",{className:"px-4 py-3",children:e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium",children:t.remaining_inventory}),e.jsxs("span",{className:"text-gray-500",children:["/ ",t.total_inventory]})]})})]},t.id)))})]})})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"tier"===t.allocation_type?"Tier Structure":"Individual Allocations"}),"tier"===t.allocation_type?o?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"Loading tiers..."}):0===r.length?e.jsx("div",{className:"text-center py-4 text-gray-500",children:"No tiers have been created yet. Configure tiers in the Tiers tab."}):e.jsx("div",{className:"space-y-4",children:r.map((t=>e.jsxs("div",{className:"flex items-center justify-between p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-primary/10 text-primary font-medium",children:t.level}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.customer_count.toLocaleString()," customers"]})]})]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[e.jsxs("div",{children:["Access Start: ",new Date(t.access_start).toLocaleDateString()]}),e.jsxs("div",{children:["Access End: ",new Date(t.access_end).toLocaleDateString()]})]}),e.jsx(Qr,{className:"w-5 h-5 text-gray-400"})]},t.id)))}):e.jsxs("div",{className:"space-y-2",children:[e.jsx("p",{className:"text-gray-600",children:"This allocation is configured for individual customer allocations. Each customer can be assigned their own specific allocation settings."}),e.jsx("p",{className:"text-gray-500 text-sm",children:"Manage individual customer allocations in the Individual Allocations tab."})]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg shadow-sm border",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Configuration Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Purchase Requirements"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Minimum Bottles:"}),e.jsx("span",{children:t.cart_min||"No minimum"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Maximum Bottles:"}),e.jsx("span",{children:t.cart_max||"No maximum"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Minimum Amount:"}),e.jsxs("span",{children:["$",t.min_amount||"No minimum"]})]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-2",children:"Discounts"}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Order Discount:"}),e.jsx("span",{children:t.order_discount_amount?`${t.order_discount_amount}${"percentage"===t.order_discount_type?"%":"$"}`:"None"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Shipping Discount:"}),e.jsx("span",{children:t.shipping_discount_amount?`${t.shipping_discount_amount}${"percentage"===t.shipping_discount_type?"%":"$"}`:"None"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-500",children:"Shipping Method:"}),e.jsx("span",{children:t.shipping_discount_method||"Default"})]})]})]})]})]})]})}function mu(){const{allocation:t,loading:s,error:r}=ro(),a=ae(),[i,n]=te.useState("overview"),[o,l]=te.useState(!1);return s?e.jsx("div",{className:"flex items-center justify-center h-96",children:"Loading..."}):r||!t?e.jsx("div",{children:"Error loading allocation"}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("button",{onClick:()=>a("/allocations"),className:"text-gray-600 hover:text-gray-900 flex items-center gap-1",children:[e.jsx(Ur,{size:16}),"Back to All Allocations"]})}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:t.name}),e.jsx("p",{className:"mt-1 text-gray-500",children:"draft"===t.status?"Configure allocation details before opening":"Manage your allocation"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(Ri,{variant:"outline",onClick:()=>l(!0),children:[e.jsx(sa,{className:"w-4 h-4 mr-2"}),"Duplicate"]}),e.jsx(Ri,{variant:"outline",children:"Save Draft"}),e.jsx(Ri,{children:"Publish Allocation"})]})]})]}),e.jsx("div",{className:"border-b",children:e.jsxs("div",{className:"flex gap-6",children:[e.jsx("button",{className:"pb-4 text-sm font-medium relative "+("overview"===i?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),onClick:()=>n("overview"),children:"Overview"}),e.jsx("button",{className:"pb-4 text-sm font-medium relative "+("configuration"===i?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),onClick:()=>n("configuration"),children:"Configuration"}),e.jsx("button",{className:"pb-4 text-sm font-medium relative "+("customers"===i?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),onClick:()=>n("customers"),children:"tier"===t.allocation_type?"Tiers":"Individual Allocations"})]})}),e.jsx("div",{className:"py-6",children:"overview"===i?e.jsx(hu,{allocation:t}):"configuration"===i?e.jsx(Qd,{allocation:t}):"tier"===t.allocation_type?e.jsx(cu,{allocation:t}):e.jsx(uu,{allocation:t})}),e.jsx(Dn,{allocation:t,isOpen:o,onClose:()=>l(!1)})]})}function pu({allocation:t}){const s=t.current_revenue||0,r=t.expected_revenue||0,a=r>0?s/r*100:0;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ca,{className:"text-blue-600",size:20}),e.jsx("div",{className:"flex-1",children:e.jsx("span",{className:"text-blue-900",children:"We predict there next time you can add 7 customers from your waiting list of 213 customers to generate additional revenue of $14,000."})}),e.jsx("button",{className:"text-blue-600 font-medium hover:text-blue-700",children:"VIEW WISH REQUESTS"})]})}),e.jsx("div",{className:"bg-purple-50 border border-purple-100 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ma,{className:"text-purple-600",size:20}),e.jsx("div",{className:"flex-1",children:e.jsx("span",{className:"text-purple-900",children:"We predict sending an email reminder now to your 368 customers who haven't purchased would generate a projected revenue of $1,667,000.00."})}),e.jsx("button",{className:"text-purple-600 font-medium hover:text-purple-700",children:"VIEW REMINDER"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsxs("div",{className:"flex items-baseline justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Revenue"}),e.jsxs("div",{className:"mt-1 text-2xl font-semibold",children:["$",s.toLocaleString(),e.jsxs("span",{className:"text-sm text-gray-500 font-normal ml-2",children:["of $",r.toLocaleString()," expected"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Progress"}),e.jsxs("div",{className:"text-lg font-medium",children:[Math.round(a),"%"]})]})]}),e.jsx("div",{className:"h-2 bg-gray-200 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-600 rounded-full",style:{width:`${a}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Customer Status"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("div",{className:"text-gray-500",children:"Purchasers"}),e.jsx("div",{className:"text-xl font-medium",children:"1,245"})]}),e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("div",{className:"text-gray-500",children:"Non-Purchasers"}),e.jsx("div",{className:"text-xl font-medium",children:"2,225"})]}),e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("div",{className:"text-gray-500",children:"Completion Rate"}),e.jsx("div",{className:"text-xl font-medium",children:"35.8%"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"High-Value Customers"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("div",{className:"text-gray-500",children:"Total Orders"}),e.jsx("div",{className:"text-xl font-medium",children:"425"})]}),e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("div",{className:"text-gray-500",children:"Average Order Value"}),e.jsx("div",{className:"text-xl font-medium",children:"$2,450"})]}),e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("div",{className:"text-gray-500",children:"Revenue Share"}),e.jsx("div",{className:"text-xl font-medium",children:"45%"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Inventory Status"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("div",{className:"text-gray-500",children:"Bottles Sold"}),e.jsx("div",{className:"text-xl font-medium",children:"3,567"})]}),e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("div",{className:"text-gray-500",children:"Remaining"}),e.jsx("div",{className:"text-xl font-medium",children:"1,433"})]}),e.jsxs("div",{className:"flex justify-between items-baseline",children:[e.jsx("div",{className:"text-gray-500",children:"Sell-Through Rate"}),e.jsx("div",{className:"text-xl font-medium",children:"71.3%"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Waitlist Insights"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-semibold",children:"213"}),e.jsx("div",{className:"text-gray-500 mt-1",children:"Customers Waiting"}),e.jsx("div",{className:"text-sm text-gray-500 mt-2",children:"Average wait time: 45 days"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"text-3xl font-semibold",children:"$425,000"}),e.jsx("div",{className:"text-gray-500 mt-1",children:"Potential Revenue"}),e.jsx("div",{className:"text-sm text-gray-500 mt-2",children:"Based on average order value"})]})]})]})]})}function xu({allocation:t}){const[s,r]=te.useState(!0),[a,i]=te.useState([]),[n,o]=te.useState([]),[l,c]=te.useState(""),[d,u]=te.useState("all"),[h,m]=te.useState("all");te.useEffect((()=>{(async()=>{try{const{data:e}=await Rr.from("allocation_tiers").select("\n            id,\n            name,\n            customer_count,\n            customer_tiers (\n              id,\n              has_purchased\n            )\n          ").eq("allocation_id",t.id);e&&i(e.map((e=>{var t,s,r;return{id:e.id,name:e.name,total:e.customer_count,purchasers:(null==(t=e.customer_tiers)?void 0:t.filter((e=>e.has_purchased)).length)||0,viewed:(null==(s=e.customer_tiers)?void 0:s.length)||0,completion:e.customer_count>0?((null==(r=e.customer_tiers)?void 0:r.filter((e=>e.has_purchased)).length)||0)/e.customer_count*100:0}})));const{data:s}=await Rr.from("customer_tiers").select("\n            customer_id,\n            tier_id,\n            has_purchased,\n            last_engagement,\n            allocation_tiers (\n              name\n            )\n          ").eq("allocation_id",t.id);if(s){const e=s.map(((e,t)=>{var s;const r=((e,t)=>({id:`${e}-${t}`,name:`Customer ${t+1}`,email:`customer${t+1}@example.com`,viewed_at:(new Date).toISOString(),order_status:Math.random()>.5?"completed":null,order_value:Math.random()>.5?Math.round(5e3*Math.random()):void 0}))(e.customer_id,t);return{...r,tier:null==(s=e.allocation_tiers)?void 0:s.name,viewed_at:e.last_engagement,order_status:e.has_purchased?"completed":null,order_value:e.has_purchased?Math.round(5e3*Math.random()):void 0}}));o(e)}}catch(e){}finally{r(!1)}})()}),[t.id]);const p=n.filter((e=>{const t=e.name.toLowerCase().includes(l.toLowerCase())||e.email.toLowerCase().includes(l.toLowerCase()),s="all"===d||"purchased"===d&&"completed"===e.order_status||"pending"===d&&"pending"===e.order_status||"not_purchased"===d&&!e.order_status,r="all"===h||e.tier===h;return t&&s&&r}));return s?e.jsx("div",{className:"text-center py-12",children:"Loading customer data..."}):e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-purple-50 border border-purple-100 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ma,{className:"text-purple-600",size:20}),e.jsx("div",{className:"flex-1",children:e.jsx("span",{className:"text-purple-900",children:"2,266 customers haven't made a purchase yet. Sending a reminder email could generate $1,867,000 in revenue."})}),e.jsx(Ri,{variant:"outline",className:"text-purple-600 hover:text-purple-700",children:"Send Reminder"})]})}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Tier Progress"}),e.jsx("div",{className:"space-y-4",children:a.map((t=>e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium",children:t.name}),e.jsxs("p",{className:"text-sm text-gray-500",children:[t.purchasers," of ",t.total," customers purchased"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-medium",children:[Math.round(t.completion),"%"]}),e.jsx("p",{className:"text-sm text-gray-500",children:"completion"})]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-600 rounded-full",style:{width:`${t.completion}%`}})})]},t.id)))})]}),e.jsxs("div",{className:"bg-white rounded-lg border",children:[e.jsxs("div",{className:"p-6 border-b",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Customers"}),e.jsxs("div",{className:"mt-4 flex gap-4",children:[e.jsx(Gi,{placeholder:"Search customers...",value:l,onChange:e=>c(e.target.value),className:"max-w-sm"}),e.jsxs(Wi,{value:d,onValueChange:u,children:[e.jsx(Hi,{className:"w-[180px]",children:e.jsx(Ji,{placeholder:"Filter by status"})}),e.jsxs(Qi,{children:[e.jsx(Xi,{value:"all",children:"All Statuses"}),e.jsx(Xi,{value:"purchased",children:"Purchased"}),e.jsx(Xi,{value:"pending",children:"Pending"}),e.jsx(Xi,{value:"not_purchased",children:"Not Purchased"})]})]}),e.jsxs(Wi,{value:h,onValueChange:m,children:[e.jsx(Hi,{className:"w-[180px]",children:e.jsx(Ji,{placeholder:"Filter by tier"})}),e.jsxs(Qi,{children:[e.jsx(Xi,{value:"all",children:"All Tiers"}),a.map((t=>e.jsx(Xi,{value:t.name,children:t.name},t.id)))]})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Customer"}),e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Tier"}),e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Viewed"}),e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Status"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Order Value"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:p.map((t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.name}),e.jsx("div",{className:"text-sm text-gray-500",children:t.email})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:t.tier||"No Tier"})}),e.jsx("td",{className:"p-4 text-sm text-gray-500",children:t.viewed_at?new Date(t.viewed_at).toLocaleDateString():"Not viewed"}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("completed"===t.order_status?"bg-green-100 text-green-800":"pending"===t.order_status?"bg-yellow-100 text-yellow-800":"bg-gray-100 text-gray-800"),children:"completed"===t.order_status?"Purchased":"pending"===t.order_status?"Pending":"Not Purchased"})}),e.jsx("td",{className:"p-4 text-right",children:t.order_value?`$${t.order_value.toLocaleString()}`:"-"}),e.jsx("td",{className:"p-4 text-right",children:e.jsx(Ri,{variant:"outline",size:"sm",children:"View Details"})})]},t.id)))})]})})]})]})}const gu=[{id:"DM22CHCLO2",name:"2022 Chardonnay Chloe",sku:"DM22CHCLO2",qtySold:1383,revenue:172875,qtyLeft:12023,wishRequests:1208,potentialRevenue:151e3},{id:"DM22CHEST2",name:"2022 Chardonnay DuMOL Estate Vineyard",sku:"DM22CHEST2",qtySold:1209,revenue:120900,qtyLeft:1895,wishRequests:1569,potentialRevenue:189500},{id:"DM22CHBRE2",name:"2022 Chardonnay Bressay Estate Vineyard",sku:"DM22CHBRE2",qtySold:955,revenue:100275,qtyLeft:12634,wishRequests:1343,potentialRevenue:141015},{id:"DM22PNRYN2",name:"2022 Pinot Noir Ryan",sku:"DM22PNRYN2",qtySold:252,revenue:22680,qtyLeft:2367,wishRequests:898,potentialRevenue:80820},{id:"DM22PNEST2",name:"2022 Pinot Noir DuMOL Estate Vineyard",sku:"DM22PNEST2",qtySold:633,revenue:63e3,qtyLeft:897,wishRequests:456,potentialRevenue:45600}];function fu({allocation:t}){const s=gu.reduce(((e,t)=>e+t.qtySold+t.qtyLeft),0),r=gu.reduce(((e,t)=>e+t.qtySold),0),a=gu.reduce(((e,t)=>e+t.revenue),0),i=gu.reduce(((e,t)=>e+t.wishRequests),0),n=gu.reduce(((e,t)=>e+t.potentialRevenue),0),o=r/s*100;return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ca,{className:"text-blue-600",size:20}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:"text-blue-900",children:["Grant ",i.toLocaleString()," wishes to sell ",Math.round(i/s*100),"% of your remaining inventory"]})}),e.jsx(Ri,{variant:"outline",className:"text-blue-600 hover:text-blue-700",children:"VIEW WISH REQUESTS"})]})}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsxs("div",{className:"flex items-baseline justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Inventory"}),e.jsxs("div",{className:"mt-1 text-2xl font-semibold",children:[r.toLocaleString(),e.jsxs("span",{className:"text-sm text-gray-500 font-normal ml-2",children:["of ",s.toLocaleString()," total bottles"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-sm text-gray-500",children:"Sold"}),e.jsxs("div",{className:"text-lg font-medium",children:[Math.round(o),"%"]})]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-600 rounded-full",style:{width:`${o}%`}})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Current Revenue"}),e.jsxs("div",{className:"text-3xl font-semibold",children:["$",a.toLocaleString()]}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:["From ",r.toLocaleString()," bottles sold"]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Potential Revenue"}),e.jsxs("div",{className:"text-3xl font-semibold",children:["$",n.toLocaleString()]}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:["If all ",i.toLocaleString()," wishes granted"]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Average Price"}),e.jsxs("div",{className:"text-3xl font-semibold",children:["$",Math.round(a/r).toLocaleString()]}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"Per bottle sold"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsx("h3",{className:"text-lg font-medium",children:"Products"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Product"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Qty Sold"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Revenue"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Qty Left"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Wish Requests"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Potential Revenue"})]})}),e.jsx("tbody",{className:"divide-y",children:gu.map((t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.name}),e.jsx("div",{className:"text-sm text-gray-500",children:t.sku})]})}),e.jsx("td",{className:"p-4 text-right",children:t.qtySold.toLocaleString()}),e.jsxs("td",{className:"p-4 text-right",children:["$",t.revenue.toLocaleString()]}),e.jsx("td",{className:"p-4 text-right",children:t.qtyLeft.toLocaleString()}),e.jsx("td",{className:"p-4 text-right",children:t.wishRequests.toLocaleString()}),e.jsxs("td",{className:"p-4 text-right",children:["$",t.potentialRevenue.toLocaleString()]})]},t.id)))}),e.jsx("tfoot",{className:"bg-gray-50 border-t",children:e.jsxs("tr",{children:[e.jsx("td",{className:"p-4 font-medium",children:"Totals"}),e.jsx("td",{className:"p-4 text-right font-medium",children:r.toLocaleString()}),e.jsxs("td",{className:"p-4 text-right font-medium",children:["$",a.toLocaleString()]}),e.jsx("td",{className:"p-4 text-right font-medium",children:gu.reduce(((e,t)=>e+t.qtyLeft),0).toLocaleString()}),e.jsx("td",{className:"p-4 text-right font-medium",children:i.toLocaleString()}),e.jsxs("td",{className:"p-4 text-right font-medium",children:["$",n.toLocaleString()]})]})})]})})]})]})}const vu=[{id:"wr1",customerId:"c1",customerName:"Brooklyn Simmons",customerEmail:"deanna.curtis@example.com",memberSince:"23 years",tier:"1",allocationAmount:456.32,completion:100,items:4,type:"Wish request Origin order 3",amount:1678.89},{id:"wr2",customerId:"c2",customerName:"Macy Henderson",customerEmail:"deanna.curtis@example.com",memberSince:"24 years",tier:"1",allocationAmount:456.32,completion:100,items:4,type:"Wish request Origin order 3",amount:1678.89},{id:"wr3",customerId:"c3",customerName:"Darrell Steward",customerEmail:"deanna.curtis@example.com",memberSince:"2 years",tier:"1",allocationAmount:576.25,completion:100,items:4,type:"Wish request Origin order 3",amount:202.87}],yu=[{tier:"Tier 1",requests:6072,revenue:3631260,color:"rgb(239, 68, 68)",percentage:71},{tier:"Tier 2",requests:1956,revenue:1205380,color:"rgb(59, 130, 246)",percentage:23},{tier:"Tier 3",requests:357,revenue:347485,color:"rgb(147, 197, 253)",percentage:4},{tier:"Tier 4",requests:144,revenue:515e3,color:"rgb(30, 41, 59)",percentage:2},{tier:"Tier 5",requests:0,revenue:0,color:"rgb(241, 245, 249)",percentage:0}];function ju({allocation:t}){const[s,r]=te.useState(new Set),[a,i]=te.useState(""),[n,o]=te.useState("all"),[l,c]=te.useState("all"),d=8469,u=224399,h=e=>{r(e?new Set(vu.map((e=>e.id))):new Set)};return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ca,{className:"text-blue-600",size:20}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:"text-blue-900",children:["Grant ",d.toLocaleString()," wishes to sell ",Math.round(15.096323958662916),"% of your remaining inventory"]})}),e.jsx(Ri,{variant:"outline",className:"text-blue-600 hover:text-blue-700",children:"VIEW WISH REQUESTS"})]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-6",children:"Breakdown by Tier"}),e.jsx("div",{className:"relative pt-1",children:e.jsx("div",{className:"flex mb-2 h-4 overflow-hidden rounded-full",children:yu.map(((t,s)=>e.jsx("div",{style:{width:`${t.percentage}%`,backgroundColor:t.color},className:"flex flex-col justify-center"},t.tier)))})}),e.jsx("div",{className:"space-y-4 mt-6",children:yu.map((t=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:t.color}}),e.jsx("span",{className:"font-medium",children:t.tier}),e.jsxs("span",{className:"text-gray-500",children:["(",t.requests.toLocaleString()," requests)"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"font-medium",children:["$",t.revenue.toLocaleString()]}),e.jsxs("div",{className:"text-sm text-gray-500",children:[t.percentage,"% of total"]})]})]},t.tier)))})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Total Wish Requests"}),e.jsx("div",{className:"text-3xl font-semibold",children:d.toLocaleString()}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:["From ",6775.200000000001.toFixed(0)," unique customers"]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Potential Revenue"}),e.jsxs("div",{className:"text-3xl font-semibold",children:["$",3556980..toLocaleString()]}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"If all wishes are granted"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border",children:[e.jsxs("div",{className:"p-6 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Individual Wish Requests"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-sm text-gray-500",children:[33876..toLocaleString()," / ",u.toLocaleString()]}),e.jsx("span",{className:"text-sm font-medium",children:"bottles asked for"})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(Gi,{placeholder:"Search requests...",value:a,onChange:e=>i(e.target.value)})}),e.jsxs(Wi,{value:n,onValueChange:o,children:[e.jsx(Hi,{className:"w-[180px]",children:e.jsx(Ji,{placeholder:"Filter by tier"})}),e.jsxs(Qi,{children:[e.jsx(Xi,{value:"all",children:"All Tiers"}),yu.map((t=>e.jsx(Xi,{value:t.tier,children:t.tier},t.tier)))]})]}),e.jsxs(Wi,{value:l,onValueChange:c,children:[e.jsx(Hi,{className:"w-[180px]",children:e.jsx(Ji,{placeholder:"Filter by status"})}),e.jsxs(Qi,{children:[e.jsx(Xi,{value:"all",children:"All Statuses"}),e.jsx(Xi,{value:"pending",children:"Pending"}),e.jsx(Xi,{value:"approved",children:"Approved"}),e.jsx(Xi,{value:"denied",children:"Denied"})]})]}),e.jsxs(Ri,{variant:"outline",className:"gap-2",children:[e.jsx(la,{className:"w-4 h-4"}),"More Filters",e.jsx(Kr,{className:"w-4 h-4"})]})]}),e.jsxs("div",{className:"mt-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(Rn,{checked:s.size===vu.length,onCheckedChange:h}),e.jsxs("span",{className:"text-sm text-gray-500",children:[s.size," selected"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(Ri,{variant:"outline",size:"sm",children:[e.jsx(wa,{className:"w-4 h-4 mr-2"}),"Edit Selected"]}),e.jsxs(Ri,{size:"sm",children:[e.jsx(Hr,{className:"w-4 h-4 mr-2"}),"Grant Selected"]})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"w-8 p-4",children:e.jsx(Rn,{checked:s.size===vu.length,onCheckedChange:h})}),e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Customer"}),e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Member For"}),e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Tier"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Allocation Amount"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Completion"}),e.jsx("th",{className:"text-center text-sm font-medium text-gray-500 p-4",children:"Items"}),e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Type"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Amount"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:vu.map((t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-4",children:e.jsx(Rn,{checked:s.has(t.id),onCheckedChange:()=>(e=>{const t=new Set(s);t.has(e)?t.delete(e):t.add(e),r(t)})(t.id)})}),e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.customerName}),e.jsx("div",{className:"text-sm text-gray-500",children:t.customerEmail})]})}),e.jsx("td",{className:"p-4",children:t.memberSince}),e.jsx("td",{className:"p-4",children:e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:["Tier ",t.tier]})}),e.jsxs("td",{className:"p-4 text-right",children:["$",t.allocationAmount]}),e.jsxs("td",{className:"p-4 text-right",children:[t.completion,"%"]}),e.jsx("td",{className:"p-4 text-center",children:t.items}),e.jsx("td",{className:"p-4",children:t.type}),e.jsxs("td",{className:"p-4 text-right",children:["$",t.amount]}),e.jsx("td",{className:"p-4 text-right",children:e.jsx(Ri,{variant:"outline",size:"sm",children:"Grant Wish"})})]},t.id)))})]})})]})]})}function bu({allocation:t}){const s=ae(),{id:r}=oe(),[a,i]=te.useState(!0),[n,o]=te.useState(null),[l,c]=te.useState([]);return te.useEffect((()=>{(async()=>{try{const{data:e,error:s}=await Rr.from("allocation_tiers").select("\n            *,\n            customer_tiers (\n              id,\n              has_purchased\n            )\n          ").eq("allocation_id",t.id).order("level",{ascending:!0});if(s)throw s;const r=(e||[]).map((e=>{var t;const s=(null==(t=e.customer_tiers)?void 0:t.filter((e=>e.has_purchased)).length)||0,r=e.customer_count||0,a=r>0?s/r*100:0,i=[];a>75?i.push({type:"success",message:`${a.toFixed(0)}% of customers have completed their purchase`}):a<25&&i.push({type:"warning",message:`Only ${a.toFixed(0)}% of customers have made a purchase`});const n=1500*s,o=2e3*r;return{id:e.id,name:e.name,level:e.level,customerCount:r,purchasedCount:s,revenue:n,targetRevenue:o,averageOrder:s>0?n/s:0,products:[],insights:i}}));c(r),o(null)}catch(e){o("Failed to load tier data")}finally{i(!1)}})()}),[t.id]),a?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-lg font-medium text-gray-900",children:"Loading Tiers"}),e.jsx("div",{className:"mt-2 text-sm text-gray-500",children:"Please wait..."})]})}):n?e.jsx("div",{className:"bg-red-50 border border-red-100 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(zr,{className:"text-red-600",size:20}),e.jsx("div",{className:"flex-1",children:e.jsx("span",{className:"text-red-900",children:n})})]})}):e.jsxs("div",{className:"space-y-6",children:[l.length>0&&e.jsx("div",{className:"bg-blue-50 border border-blue-100 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ca,{className:"text-blue-600",size:20}),e.jsx("div",{className:"flex-1",children:e.jsxs("span",{className:"text-blue-900",children:[l[0].customerCount," customers across ",l.length," tiers"]})})]})}),e.jsxs("div",{className:"space-y-6",children:[l.map((t=>e.jsx("div",{className:"bg-white rounded-lg border",children:e.jsxs("div",{className:"p-6 border-b",children:[e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center justify-center w-8 h-8 rounded-full bg-primary/10 text-primary font-medium",children:t.level}),e.jsx("h3",{className:"text-lg font-medium",children:t.name})]}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:[t.customerCount.toLocaleString()," total customers"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-2xl font-semibold",children:["$",t.revenue.toLocaleString()]}),e.jsxs("div",{className:"text-sm text-gray-500",children:["of $",t.targetRevenue.toLocaleString()," target"]})]})]}),e.jsxs("div",{className:"mt-6 space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Customer Purchases"}),e.jsxs("span",{className:"text-sm font-medium",children:[Math.round(t.purchasedCount/t.customerCount*100),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-600 rounded-full",style:{width:t.purchasedCount/t.customerCount*100+"%"}})}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[t.purchasedCount.toLocaleString()," of ",t.customerCount.toLocaleString()," customers have purchased"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Revenue Progress"}),e.jsxs("span",{className:"text-sm font-medium",children:[Math.round(t.revenue/t.targetRevenue*100),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-600 rounded-full",style:{width:t.revenue/t.targetRevenue*100+"%"}})}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:["Average order value: $",t.averageOrder.toLocaleString()]})]})]}),e.jsx("div",{className:"mt-6 space-y-2",children:t.insights.map(((t,s)=>e.jsxs("div",{className:"flex items-center gap-2 text-sm "+("success"===t.type?"text-green-600":"warning"===t.type?"text-yellow-600":"text-blue-600"),children:[e.jsx(zr,{className:"w-4 h-4"}),e.jsx("span",{children:t.message})]},s)))}),e.jsx("div",{className:"mt-6 flex justify-end",children:e.jsxs(Ri,{variant:"outline",onClick:()=>s(`/allocations/${r}/open/tier/${t.id}`),className:"gap-2",children:["View Details",e.jsx(Qr,{className:"w-4 h-4"})]})})]})},t.id))),0===l.length&&e.jsx("div",{className:"text-center py-12 bg-gray-50 rounded-lg border",children:e.jsx("p",{className:"text-gray-500",children:"No tiers found for this allocation."})})]})]})}const wu=F,Nu=z,_u=L,ku=te.forwardRef((({className:t,...s},r)=>e.jsx(R,{ref:r,className:Ai("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...s})));ku.displayName=R.displayName;const Su=te.forwardRef((({className:t,children:s,...r},a)=>e.jsxs(_u,{children:[e.jsx(ku,{}),e.jsxs(D,{ref:a,className:Ai("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...r,children:[s,e.jsxs(I,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[e.jsx(Ra,{className:"h-4 w-4"}),e.jsx("span",{className:"sr-only",children:"Close"})]})]})]})));Su.displayName=D.displayName;const Cu=({className:t,...s})=>e.jsx("div",{className:Ai("flex flex-col space-y-1.5 text-center sm:text-left",t),...s});Cu.displayName="DialogHeader";const Tu=te.forwardRef((({className:t,...s},r)=>e.jsx(M,{ref:r,className:Ai("text-lg font-semibold leading-none tracking-tight",t),...s})));Tu.displayName=M.displayName;function Au({allocation:t}){const[s,r]=te.useState([]),[a,i]=te.useState(!0),[n,o]=te.useState(!1),[l,c]=te.useState({name:"",type:"email",subject:"",content:"",scheduled_for:""});te.useEffect((()=>{(async()=>{try{const{data:e,error:s}=await Rr.from("campaigns").select("\n            *,\n            campaign_recipients (\n              status,\n              opened_at,\n              clicked_at\n            )\n          ").eq("allocation_id",t.id).order("created_at",{ascending:!1});if(s)throw s;const a=(null==e?void 0:e.map((e=>{var t,s,r,a;return{...e,metrics:{total:(null==(t=e.campaign_recipients)?void 0:t.length)||0,delivered:(null==(s=e.campaign_recipients)?void 0:s.filter((e=>"delivered"===e.status)).length)||0,opened:(null==(r=e.campaign_recipients)?void 0:r.filter((e=>e.opened_at)).length)||0,clicked:(null==(a=e.campaign_recipients)?void 0:a.filter((e=>e.clicked_at)).length)||0}}})))||[];r(a)}catch(e){}finally{i(!1)}})()}),[t.id]);return e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"bg-purple-50 border border-purple-100 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ma,{className:"text-purple-600",size:20}),e.jsx("div",{className:"flex-1",children:e.jsx("span",{className:"text-purple-900",children:"368 customers haven't made a purchase yet. Sending a reminder email could generate $1,667,000 in revenue."})}),e.jsx(Ri,{variant:"outline",className:"text-purple-600 hover:text-purple-700",children:"Create Campaign"})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(ma,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Email Campaigns"})]}),e.jsx("div",{className:"text-2xl font-semibold",children:s.filter((e=>"email"===e.type)).length}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[s.filter((e=>"email"===e.type&&"sent"===e.status)).length," sent"]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(xa,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"SMS Campaigns"})]}),e.jsx("div",{className:"text-2xl font-semibold",children:s.filter((e=>"sms"===e.type)).length}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[s.filter((e=>"sms"===e.type&&"sent"===e.status)).length," sent"]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Jr,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Scheduled"})]}),e.jsx("div",{className:"text-2xl font-semibold",children:s.filter((e=>"scheduled"===e.status)).length}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"campaigns pending"})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(ta,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Average Open Rate"})]}),e.jsxs("div",{className:"text-2xl font-semibold",children:[Math.round(s.reduce(((e,t)=>e+t.metrics.opened/t.metrics.delivered*100),0)/s.filter((e=>e.metrics.delivered>0)).length||0),"%"]}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"across all campaigns"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border",children:[e.jsxs("div",{className:"p-6 border-b",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Campaigns"}),e.jsxs(wu,{open:n,onOpenChange:o,children:[e.jsx(Nu,{asChild:!0,children:e.jsxs(Ri,{children:[e.jsx(fa,{className:"w-4 h-4 mr-2"}),"New Campaign"]})}),e.jsxs(Su,{children:[e.jsx(Cu,{children:e.jsx(Tu,{children:"Create New Campaign"})}),e.jsxs("div",{className:"space-y-4 py-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Campaign Name"}),e.jsx(Gi,{value:l.name,onChange:e=>c((t=>({...t,name:e.target.value}))),placeholder:"Enter campaign name"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Campaign Type"}),e.jsxs(Wi,{value:l.type,onValueChange:e=>c((t=>({...t,type:e}))),children:[e.jsx(Hi,{children:e.jsx(Ji,{placeholder:"Select campaign type"})}),e.jsxs(Qi,{children:[e.jsx(Xi,{value:"email",children:"Email"}),e.jsx(Xi,{value:"sms",children:"SMS"})]})]})]}),"email"===l.type&&e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Subject Line"}),e.jsx(Gi,{value:l.subject,onChange:e=>c((t=>({...t,subject:e.target.value}))),placeholder:"Enter email subject"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Content"}),e.jsx(Vn,{value:l.content,onChange:e=>c((t=>({...t,content:e.target.value}))),placeholder:`Enter campaign ${"email"===l.type?"message":"SMS"} content`,rows:6})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{children:"Schedule For (Optional)"}),e.jsx(Gi,{type:"datetime-local",value:l.scheduled_for,onChange:e=>c((t=>({...t,scheduled_for:e.target.value})))})]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(Ri,{variant:"outline",onClick:()=>o(!1),children:"Cancel"}),e.jsx(Ri,{onClick:async()=>{try{const{data:e,error:s}=await Rr.from("campaigns").insert({allocation_id:t.id,name:l.name,type:l.type,subject:l.subject,content:l.content,scheduled_for:l.scheduled_for||null}).select().single();if(s)throw s;r((t=>[{...e,metrics:{total:0,delivered:0,opened:0,clicked:0}},...t])),o(!1),c({name:"",type:"email",subject:"",content:"",scheduled_for:""})}catch(e){}},children:"Create Campaign"})]})]})]})]}),e.jsxs("div",{className:"mt-4 flex items-center gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(Gi,{placeholder:"Search campaigns..."})}),e.jsxs(Wi,{defaultValue:"all",children:[e.jsx(Hi,{className:"w-[180px]",children:e.jsx(Ji,{placeholder:"Filter by type"})}),e.jsxs(Qi,{children:[e.jsx(Xi,{value:"all",children:"All Types"}),e.jsx(Xi,{value:"email",children:"Email"}),e.jsx(Xi,{value:"sms",children:"SMS"})]})]}),e.jsxs(Wi,{defaultValue:"all",children:[e.jsx(Hi,{className:"w-[180px]",children:e.jsx(Ji,{placeholder:"Filter by status"})}),e.jsxs(Qi,{children:[e.jsx(Xi,{value:"all",children:"All Statuses"}),e.jsx(Xi,{value:"draft",children:"Draft"}),e.jsx(Xi,{value:"scheduled",children:"Scheduled"}),e.jsx(Xi,{value:"sent",children:"Sent"})]})]}),e.jsxs(Ri,{variant:"outline",className:"gap-2",children:[e.jsx(la,{className:"w-4 h-4"}),"More Filters",e.jsx(Kr,{className:"w-4 h-4"})]})]})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Campaign"}),e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Type"}),e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Status"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Recipients"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Delivered"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Opened"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Clicked"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:s.map((t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.name}),"email"===t.type&&t.subject&&e.jsx("div",{className:"text-sm text-gray-500",children:t.subject})]})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("email"===t.type?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"),children:t.type.toUpperCase()})}),e.jsx("td",{className:"p-4",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("sent"===t.status?"bg-green-100 text-green-800":"scheduled"===t.status?"bg-yellow-100 text-yellow-800":"cancelled"===t.status?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800"),children:t.status.charAt(0).toUpperCase()+t.status.slice(1)})}),e.jsx("td",{className:"p-4 text-right",children:t.metrics.total}),e.jsx("td",{className:"p-4 text-right",children:t.metrics.delivered}),e.jsxs("td",{className:"p-4 text-right",children:[t.metrics.opened," (",Math.round(t.metrics.opened/t.metrics.delivered*100),"%)"]}),e.jsxs("td",{className:"p-4 text-right",children:[t.metrics.clicked," (",Math.round(t.metrics.clicked/t.metrics.delivered*100),"%)"]}),e.jsx("td",{className:"p-4 text-right",children:e.jsx(Ri,{variant:"outline",size:"sm",children:"View Details"})})]},t.id)))})]})})]})]})}function Pu(){var t;const{allocation:s,loading:r,error:a}=ro(),i=ae(),[n,o]=te.useState("overall");if(r)return e.jsx("div",{className:"flex items-center justify-center h-96",children:"Loading..."});if(a||!s)return e.jsx("div",{children:"Error loading allocation"});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("button",{onClick:()=>i("/allocations"),className:"text-gray-600 hover:text-gray-900 flex items-center gap-1",children:[e.jsx(Ur,{size:16}),"Back to All Allocations..."]})}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:s.name}),e.jsx("div",{className:"mt-2 space-y-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 text-green-800",children:s.status.charAt(0).toUpperCase()+s.status.slice(1)}),e.jsx("span",{className:"text-gray-500",children:""}),e.jsxs("span",{className:"text-gray-500",children:[new Date(s.start_date).toLocaleDateString()," - ",new Date(s.end_date).toLocaleDateString()]}),e.jsx("span",{className:"text-gray-500",children:""}),e.jsxs("span",{className:"text-gray-500",children:[null==(t=s.total_customers)?void 0:t.toLocaleString()," customers"]})]})})]}),e.jsxs(Ri,{onClick:()=>i(`/allocations/${s.id}/edit`),children:[e.jsx(wa,{className:"w-4 h-4 mr-2"}),"Edit Allocation"]})]})]}),e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"flex gap-6",children:[{id:"overall",label:"Overall Progress"},{id:"customers",label:"Customer Progress"},{id:"inventory",label:"Inventory"},{id:"wishes",label:"Wish Request Management"},{id:"tiers",label:"Tier Performance"},{id:"campaigns",label:"Campaigns"}].map((t=>e.jsx("button",{className:"pb-4 text-sm font-medium relative "+(n===t.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),onClick:()=>{o(t.id)},children:t.label},t.id)))})}),e.jsx("div",{className:"py-6",children:(()=>{switch(n){case"overall":return e.jsx(pu,{allocation:s});case"customers":return e.jsx(xu,{allocation:s});case"inventory":return e.jsx(fu,{allocation:s});case"wishes":return e.jsx(ju,{allocation:s});case"tiers":return e.jsx(bu,{allocation:s});case"campaigns":return e.jsx(Au,{allocation:s});default:return null}})()})]})}function Eu({title:t,value:s,subValue:r,icon:a,trend:i}){return e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(a,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:t})]}),e.jsx("div",{className:"text-2xl font-semibold",children:s}),r&&e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:r}),i&&e.jsxs("div",{className:"mt-2 flex items-center gap-1 text-sm "+(i.value>=0?"text-green-600":"text-red-600"),children:[i.value>=0?e.jsx(Zr,{className:"w-4 h-4"}):e.jsx(Vr,{className:"w-4 h-4"}),e.jsxs("span",{children:[Math.abs(i.value),"% ",i.label]})]})]})}function Ou({allocation:t}){const s={totalRevenue:t.current_revenue||0,expectedRevenue:t.expected_revenue||0,totalOrders:Math.round(.75*t.total_customers),averageOrder:Math.round((t.current_revenue||0)/(.75*t.total_customers)),totalCustomers:t.total_customers||0,conversionRate:75,inventorySold:3567,totalInventory:5e3,previousAllocation:{revenue:12e5,customers:2800,conversion:70}},r=(s.totalRevenue-s.previousAllocation.revenue)/s.previousAllocation.revenue*100,a=(s.totalCustomers-s.previousAllocation.customers)/s.previousAllocation.customers*100;return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Key Insights"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-green-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Zr,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Higher Customer Retention"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"75% of customers from the previous allocation made a purchase in this allocation, up from 65% in the last period."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Sa,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Increased Average Order Value"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Average order value increased by 15% compared to the previous allocation, driven by higher-priced wine selections."})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Recommendations"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-purple-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Ea,{className:"w-4 h-4 text-purple-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Expand Tier 1 Allocation"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Consider increasing inventory for Tier 1 customers as they showed 95% purchase rate and generated 45% of total revenue."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-orange-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Oa,{className:"w-4 h-4 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Adjust Product Mix"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Increase allocation of premium wines as they showed strong demand with over 500 unfulfilled wish requests."})]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsx(Eu,{title:"Total Revenue",value:`$${s.totalRevenue.toLocaleString()}`,subValue:`${Math.round(s.totalRevenue/s.expectedRevenue*100)}% of target`,icon:aa,trend:{value:Math.round(r),label:"vs previous"}}),e.jsx(Eu,{title:"Total Orders",value:s.totalOrders.toLocaleString(),subValue:`$${s.averageOrder.toLocaleString()} avg. order`,icon:Sa}),e.jsx(Eu,{title:"Customers",value:s.totalCustomers.toLocaleString(),subValue:`${s.conversionRate}% conversion`,icon:Ea,trend:{value:Math.round(a),label:"vs previous"}}),e.jsx(Eu,{title:"Inventory Sold",value:`${s.inventorySold.toLocaleString()}`,subValue:`${Math.round(s.inventorySold/s.totalInventory*100)}% of total`,icon:Oa})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Revenue Over Time"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Daily revenue progression during the allocation period"})]}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-blue-500"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Current"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full bg-gray-300"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Previous"})]})]})]}),e.jsx("div",{className:"h-[300px] flex items-center justify-center text-gray-500",children:"Revenue chart will be implemented here"})]})]})}function $u({allocation:t}){const s={totalCustomers:t.total_customers||0,purchasedCustomers:Math.round(.75*(t.total_customers||0)),newCustomers:Math.round(.3*(t.total_customers||0)),returningCustomers:Math.round(.45*(t.total_customers||0)),averageSpend:2500,retentionRate:85,dropOffRate:15,segments:[{name:"High Value",count:250,revenue:875e3,avgOrder:3500},{name:"Regular",count:1500,revenue:225e4,avgOrder:1500},{name:"Occasional",count:750,revenue:75e4,avgOrder:1e3}]};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Ea,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Total Customers"})]}),e.jsx("div",{className:"text-2xl font-semibold",children:s.totalCustomers.toLocaleString()}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[s.newCustomers.toLocaleString()," new customers"]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Ta,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Purchased"})]}),e.jsx("div",{className:"text-2xl font-semibold",children:s.purchasedCustomers.toLocaleString()}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[Math.round(s.purchasedCustomers/s.totalCustomers*100),"% conversion"]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Sa,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Average Spend"})]}),e.jsxs("div",{className:"text-2xl font-semibold",children:["$",s.averageSpend.toLocaleString()]}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"per customer"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Aa,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Drop-off Rate"})]}),e.jsxs("div",{className:"text-2xl font-semibold",children:[s.dropOffRate,"%"]}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"of allocated customers"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border",children:[e.jsxs("div",{className:"p-6 border-b",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Customer Segments"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Breakdown of customer performance by segment"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Segment"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Customers"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Revenue"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Avg. Order"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"% of Total"})]})}),e.jsx("tbody",{className:"divide-y",children:s.segments.map((t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-4 font-medium",children:t.name}),e.jsx("td",{className:"p-4 text-right",children:t.count.toLocaleString()}),e.jsxs("td",{className:"p-4 text-right",children:["$",t.revenue.toLocaleString()]}),e.jsxs("td",{className:"p-4 text-right",children:["$",t.avgOrder.toLocaleString()]}),e.jsxs("td",{className:"p-4 text-right",children:[Math.round(t.count/s.totalCustomers*100),"%"]})]},t.name)))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Retention Analysis"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Retention Rate"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.retentionRate,"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-600 rounded-full",style:{width:`${s.retentionRate}%`}})}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[s.returningCustomers.toLocaleString()," returning customers"]})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Drop-off Rate"}),e.jsxs("span",{className:"text-sm font-medium",children:[s.dropOffRate,"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-red-600 rounded-full",style:{width:`${s.dropOffRate}%`}})}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[Math.round(s.totalCustomers*(s.dropOffRate/100)).toLocaleString()," lost customers"]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Customer Insights"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-green-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Ta,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Strong Retention"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"85% of customers from previous allocations made a purchase, indicating high customer loyalty."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Sa,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"High Value Growth"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"The High Value segment grew by 25% compared to the previous allocation, showing successful customer development."})]})]})]})]})]})]})}function Ru({allocation:t}){const s={totalProducts:12,totalSold:15e3,totalRevenue:t.current_revenue||0,averagePrice:125,sellThroughRate:85,products:[{id:"p1",name:"2022 Cabernet Sauvignon",allocated:5e3,sold:4750,revenue:95e4,price:200,wishRequests:850},{id:"p2",name:"2022 Chardonnay",allocated:3e3,sold:2850,revenue:427500,price:150,wishRequests:450},{id:"p3",name:"2022 Pinot Noir",allocated:2500,sold:2375,revenue:475e3,price:200,wishRequests:325}]};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Oa,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Total Products"})]}),e.jsx("div",{className:"text-2xl font-semibold",children:s.totalProducts}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"wines offered"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(ga,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Total Sold"})]}),e.jsx("div",{className:"text-2xl font-semibold",children:s.totalSold.toLocaleString()}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"bottles sold"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Sa,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Average Price"})]}),e.jsxs("div",{className:"text-2xl font-semibold",children:["$",s.averagePrice]}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"per bottle"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(zr,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Sell-Through Rate"})]}),e.jsxs("div",{className:"text-2xl font-semibold",children:[s.sellThroughRate,"%"]}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"of allocated inventory"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border",children:[e.jsxs("div",{className:"p-6 border-b",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Product Performance"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Detailed breakdown of each product's performance"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Product"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Allocated"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Sold"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Price"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Revenue"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Sell-Through"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Wish Requests"})]})}),e.jsx("tbody",{className:"divide-y",children:s.products.map((t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-4 font-medium",children:t.name}),e.jsx("td",{className:"p-4 text-right",children:t.allocated.toLocaleString()}),e.jsx("td",{className:"p-4 text-right",children:t.sold.toLocaleString()}),e.jsxs("td",{className:"p-4 text-right",children:["$",t.price]}),e.jsxs("td",{className:"p-4 text-right",children:["$",t.revenue.toLocaleString()]}),e.jsxs("td",{className:"p-4 text-right",children:[Math.round(t.sold/t.allocated*100),"%"]}),e.jsx("td",{className:"p-4 text-right",children:t.wishRequests.toLocaleString()})]},t.id)))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Top Performers"}),e.jsx("div",{className:"space-y-4",children:s.products.slice(0,2).map((t=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium",children:t.name}),e.jsxs("span",{className:"text-sm text-gray-500",children:["$",t.revenue.toLocaleString()," revenue"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-600 rounded-full",style:{width:t.sold/t.allocated*100+"%"}})}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[Math.round(t.sold/t.allocated*100),"% sell-through rate"]})]},t.id)))})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Product Insights"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-green-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Sa,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Strong Premium Performance"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Premium wines ($200+) showed 95% sell-through rate with high wish request volume."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:e.jsx(zr,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Inventory Optimization"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"High wish request volume suggests opportunity to increase allocation for top-performing products."})]})]})]})]})]})]})}function Du({allocation:t}){const s={totalCampaigns:8,emailsSent:12500,emailsOpened:9375,emailsClicked:3750,smsDelivered:5e3,smsClicked:2e3,campaigns:[{id:"c1",name:"Early Access Announcement",type:"email",sent:5e3,delivered:4950,opened:3960,clicked:1980,revenue:495e3},{id:"c2",name:"Last Chance Reminder",type:"email",sent:4e3,delivered:3960,opened:3168,clicked:1584,revenue:396e3},{id:"c3",name:"SMS Reminder",type:"sms",sent:2500,delivered:2475,opened:1980,clicked:990,revenue:247500}]};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(ma,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Email Performance"})]}),e.jsxs("div",{className:"text-2xl font-semibold",children:[Math.round(s.emailsOpened/s.emailsSent*100),"%"]}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"open rate"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(xa,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"SMS Performance"})]}),e.jsxs("div",{className:"text-2xl font-semibold",children:[Math.round(s.smsClicked/s.smsDelivered*100),"%"]}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"click-through rate"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Gr,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Total Campaigns"})]}),e.jsx("div",{className:"text-2xl font-semibold",children:s.totalCampaigns}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"campaigns sent"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Sa,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Campaign Revenue"})]}),e.jsxs("div",{className:"text-2xl font-semibold",children:["$",s.campaigns.reduce(((e,t)=>e+t.revenue),0).toLocaleString()]}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"attributed revenue"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border",children:[e.jsxs("div",{className:"p-6 border-b",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Campaign Performance"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Detailed breakdown of each campaign's performance"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Campaign"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Type"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Sent"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Delivered"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Opened"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Clicked"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Revenue"})]})}),e.jsx("tbody",{className:"divide-y",children:s.campaigns.map((t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-4 font-medium",children:t.name}),e.jsx("td",{className:"p-4 text-right",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium "+("email"===t.type?"bg-blue-100 text-blue-800":"bg-purple-100 text-purple-800"),children:t.type.toUpperCase()})}),e.jsx("td",{className:"p-4 text-right",children:t.sent.toLocaleString()}),e.jsxs("td",{className:"p-4 text-right",children:[t.delivered.toLocaleString(),e.jsxs("span",{className:"text-sm text-gray-500 ml-1",children:["(",Math.round(t.delivered/t.sent*100),"%)"]})]}),e.jsxs("td",{className:"p-4 text-right",children:[t.opened.toLocaleString(),e.jsxs("span",{className:"text-sm text-gray-500 ml-1",children:["(",Math.round(t.opened/t.delivered*100),"%)"]})]}),e.jsxs("td",{className:"p-4 text-right",children:[t.clicked.toLocaleString(),e.jsxs("span",{className:"text-sm text-gray-500 ml-1",children:["(",Math.round(t.clicked/t.opened*100),"%)"]})]}),e.jsxs("td",{className:"p-4 text-right",children:["$",t.revenue.toLocaleString()]})]},t.id)))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Email Performance"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Open Rate"}),e.jsxs("span",{className:"text-sm font-medium",children:[Math.round(s.emailsOpened/s.emailsSent*100),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-600 rounded-full",style:{width:s.emailsOpened/s.emailsSent*100+"%"}})})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Click Rate"}),e.jsxs("span",{className:"text-sm font-medium",children:[Math.round(s.emailsClicked/s.emailsOpened*100),"%"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-green-600 rounded-full",style:{width:s.emailsClicked/s.emailsOpened*100+"%"}})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Campaign Insights"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-green-100 flex items-center justify-center flex-shrink-0",children:e.jsx(ma,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Early Access Success"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Early access email campaigns showed 40% higher engagement and generated 25% more revenue per recipient."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:e.jsx(xa,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"SMS Effectiveness"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"SMS reminders drove 35% of last-minute purchases, particularly effective for premium wines."})]})]})]})]})]})]})}function Iu({allocation:t}){const s={totalWishes:2500,grantedWishes:1875,potentialRevenue:75e4,averageWishValue:400,products:[{id:"p1",name:"2022 Cabernet Sauvignon",wishes:850,granted:637,remaining:213,potentialRevenue:42600},{id:"p2",name:"2022 Chardonnay",wishes:450,granted:338,remaining:112,potentialRevenue:16800},{id:"p3",name:"2022 Pinot Noir",wishes:325,granted:244,remaining:81,potentialRevenue:16200}],tiers:[{id:"t1",name:"Tier 1",wishes:1e3,granted:750,conversionRate:85},{id:"t2",name:"Tier 2",wishes:900,granted:675,conversionRate:75},{id:"t3",name:"Tier 3",wishes:600,granted:450,conversionRate:65}]};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(ca,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Total Wishes"})]}),e.jsx("div",{className:"text-2xl font-semibold",children:s.totalWishes.toLocaleString()}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"from all customers"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(ga,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Granted Wishes"})]}),e.jsx("div",{className:"text-2xl font-semibold",children:s.grantedWishes.toLocaleString()}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[Math.round(s.grantedWishes/s.totalWishes*100),"% fulfillment rate"]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Sa,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Potential Revenue"})]}),e.jsxs("div",{className:"text-2xl font-semibold",children:["$",s.potentialRevenue.toLocaleString()]}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"from unfulfilled wishes"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(zr,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Average Wish Value"})]}),e.jsxs("div",{className:"text-2xl font-semibold",children:["$",s.averageWishValue]}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"per wish request"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border",children:[e.jsxs("div",{className:"p-6 border-b",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Product Wish Analysis"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Breakdown of wish requests by product"})]}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Product"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Total Wishes"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Granted"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Remaining"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Potential Revenue"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Fulfillment Rate"})]})}),e.jsx("tbody",{className:"divide-y",children:s.products.map((t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-4 font-medium",children:t.name}),e.jsx("td",{className:"p-4 text-right",children:t.wishes.toLocaleString()}),e.jsx("td",{className:"p-4 text-right",children:t.granted.toLocaleString()}),e.jsx("td",{className:"p-4 text-right",children:t.remaining.toLocaleString()}),e.jsxs("td",{className:"p-4 text-right",children:["$",t.potentialRevenue.toLocaleString()]}),e.jsxs("td",{className:"p-4 text-right",children:[Math.round(t.granted/t.wishes*100),"%"]})]},t.id)))})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Tier Performance"}),e.jsx("div",{className:"space-y-4",children:s.tiers.map((t=>e.jsxs("div",{children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-medium",children:t.name}),e.jsxs("span",{className:"text-sm text-gray-500",children:[t.wishes.toLocaleString()," wishes"]})]}),e.jsx("div",{className:"h-2 bg-gray-100 rounded-full overflow-hidden",children:e.jsx("div",{className:"h-full bg-blue-600 rounded-full",style:{width:t.granted/t.wishes*100+"%"}})}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[Math.round(t.granted/t.wishes*100),"% fulfillment rate"]})]},t.id)))})]}),e.jsxs("div",{className:"bg-white rounded-lg border p-6",children:[e.jsx("h3",{className:"text-lg font-medium mb-4",children:"Wish Request Insights"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-green-100 flex items-center justify-center flex-shrink-0",children:e.jsx(ca,{className:"w-4 h-4 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"High Conversion on Grants"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"85% of granted wishes resulted in purchases, indicating strong purchase intent from wish requesters."})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 rounded-full bg-blue-100 flex items-center justify-center flex-shrink-0",children:e.jsx(Sa,{className:"w-4 h-4 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:"Premium Product Demand"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Premium wines received 40% more wish requests per bottle allocated, suggesting opportunity for inventory adjustment."})]})]})]})]})]})]})}function Mu(){var t;const s=ae(),{allocation:r,loading:a,error:i}=ro(),[n,o]=te.useState("overall");if(a)return e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx(ha,{className:"w-10 h-10 text-blue-600 animate-spin mx-auto"}),e.jsx("div",{className:"text-lg font-medium text-gray-900",children:"Loading Allocation"})]})});if(i||!r)return e.jsx("div",{className:"min-h-[400px] flex flex-col items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(zr,{className:"mx-auto h-12 w-12 text-red-500"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Allocation Not Found"}),e.jsx("p",{className:"text-gray-500",children:"The allocation you're looking for doesn't exist."}),e.jsxs(Ri,{variant:"outline",onClick:()=>s("/allocations"),children:[e.jsx(Ur,{className:"w-4 h-4 mr-2"}),"Return to Allocations"]})]})});return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("button",{onClick:()=>s("/allocations"),className:"text-gray-600 hover:text-gray-900 flex items-center gap-1",children:[e.jsx(Ur,{size:16}),"Back to All Allocations"]})}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:r.name}),e.jsx("div",{className:"mt-2 space-y-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:"Previous"}),e.jsx("span",{className:"text-gray-500",children:""}),e.jsxs("span",{className:"text-gray-500",children:[new Date(r.start_date).toLocaleDateString()," - ",new Date(r.end_date).toLocaleDateString()]}),e.jsx("span",{className:"text-gray-500",children:""}),e.jsxs("span",{className:"text-gray-500",children:[null==(t=r.total_customers)?void 0:t.toLocaleString()," customers"]})]})})]}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsx(Ri,{variant:"outline",children:"Export Report"})})]})]}),e.jsx("div",{className:"border-b",children:e.jsx("div",{className:"flex gap-6",children:[{id:"overall",label:"Overall Performance"},{id:"customers",label:"Customer Behavior"},{id:"products",label:"Product Performance"},{id:"marketing",label:"Marketing Performance"},{id:"wishes",label:"Wish Analysis"}].map((t=>e.jsx("button",{className:"pb-4 text-sm font-medium relative "+(n===t.id?"text-blue-600 border-b-2 border-blue-600":"text-gray-500 hover:text-gray-700"),onClick:()=>o(t.id),children:t.label},t.id)))})}),e.jsx("div",{className:"py-6",children:(()=>{switch(n){case"overall":return e.jsx(Ou,{allocation:r});case"customers":return e.jsx($u,{allocation:r});case"products":return e.jsx(Ru,{allocation:r});case"marketing":return e.jsx(Du,{allocation:r});case"wishes":return e.jsx(Iu,{allocation:r});default:return null}})()})]})}te.forwardRef((({className:t,...s},r)=>e.jsx(q,{ref:r,className:Ai("text-sm text-muted-foreground",t),...s}))).displayName=q.displayName;function qu(){const{id:t,tierId:s}=oe(),r=ae(),{allocation:a,loading:i}=ro(),[n,o]=te.useState(!0),[l,c]=te.useState(null),[d,u]=te.useState(null),[h,m]=te.useState(null),[p,x]=te.useState([]),[g,f]=te.useState([]),[v,y]=te.useState([]);return te.useEffect((()=>{(async()=>{var e;try{if(o(!0),c(null),!t||!s)throw new Error("Missing required parameters");const{data:r,error:a}=await Rr.from("allocation_tiers").select("\n            *,\n            customer_tiers (\n              customer_id,\n              has_purchased,\n              last_engagement,\n              pvn_score\n            ),\n            tier_overrides (\n              requirements,\n              discounts,\n              shipping\n            )\n          ").eq("id",s).eq("allocation_id",t).maybeSingle();if(a)throw a;if(!r)throw new Error("Tier not found");if(r.allocation_id!==t)throw new Error("Tier does not belong to this allocation");u(r);const i=r.customer_count||0,n=(null==(e=r.customer_tiers)?void 0:e.filter((e=>e.has_purchased)).length)||0,l={customerCount:i,purchasedCount:n,revenue:125e4,averageOrder:2500,completionRate:i>0?n/i*100:0,inventorySold:750,totalInventory:1e3};m(l),x((e=>{const t=[];e.completionRate>75&&t.push({type:"success",message:"Completion rate is above average",metric:"Completion Rate",trend:"up",value:`${e.completionRate.toFixed(1)}%`}),e.revenue>1e6&&t.push({type:"info",message:"High potential for additional revenue",metric:"Potential Revenue",value:"$325,000"});const s=(e.totalInventory-e.inventorySold)/e.totalInventory*100;return s<25&&t.push({type:"warning",message:"Inventory running low for top products",metric:"Remaining Inventory",trend:"down",value:`${s.toFixed(1)}%`}),t})(l)),f([{id:1,name:"John Doe",email:"john@example.com",lastPurchase:"2024-02-20",totalSpent:5200},{id:2,name:"Jane Smith",email:"jane@example.com",lastPurchase:"2024-02-19",totalSpent:3800},{id:3,name:"Bob Wilson",email:"bob@example.com",lastPurchase:"2024-02-18",totalSpent:4500}]),y([{id:1,name:"2022 Cabernet Sauvignon",sold:250,revenue:125e3,remaining:50},{id:2,name:"2022 Chardonnay",sold:180,revenue:72e3,remaining:120},{id:3,name:"2022 Pinot Noir",sold:160,revenue:88e3,remaining:90}])}catch(r){c(r instanceof Error?r.message:"An unknown error occurred")}finally{o(!1)}})()}),[t,s]),i?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx(ha,{className:"w-10 h-10 text-blue-600 animate-spin mx-auto"}),e.jsx("div",{className:"text-lg font-medium text-gray-900",children:"Loading Allocation"})]})}):a?n?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("button",{onClick:()=>r(`/allocations/${t}/open`),className:"text-gray-600 hover:text-gray-900 flex items-center gap-1",children:[e.jsx(Ur,{size:16}),"Back to Allocation"]})})}),e.jsx("div",{className:"flex items-center justify-center h-[calc(100vh-200px)]",children:e.jsxs("div",{className:"text-center space-y-3",children:[e.jsx(ha,{className:"w-10 h-10 text-blue-600 animate-spin mx-auto"}),e.jsx("div",{className:"text-lg font-medium text-gray-900",children:"Loading Tier Data"})]})})]}):l||!d?e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"space-y-4",children:e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("button",{onClick:()=>r(`/allocations/${t}/open`),className:"text-gray-600 hover:text-gray-900 flex items-center gap-1",children:[e.jsx(Ur,{size:16}),"Back to Allocation"]})})}),e.jsx("div",{className:"min-h-[400px] flex flex-col items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(zr,{className:"mx-auto h-12 w-12 text-red-500"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Error Loading Tier"}),e.jsx("p",{className:"text-gray-500 max-w-md mx-auto",children:l||"Unable to load tier data. Please try again."})]})})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("button",{onClick:()=>r(`/allocations/${t}/open`),className:"text-gray-600 hover:text-gray-900 flex items-center gap-1",children:[e.jsx(Ur,{size:16}),"Back to Allocation"]})}),e.jsx("div",{className:"flex items-start justify-between",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:d.name}),e.jsx("div",{className:"mt-2 space-y-1",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-blue-100 text-blue-800",children:["Level ",d.level]}),e.jsx("span",{className:"text-gray-500",children:""}),e.jsxs("span",{className:"text-gray-500",children:[new Date(d.access_start).toLocaleDateString()," - ",new Date(d.access_end).toLocaleDateString()]})]})})]})})]}),e.jsx("div",{className:"grid grid-cols-3 gap-6",children:p.map(((t,s)=>e.jsx("div",{className:"p-6 rounded-lg border "+("success"===t.type?"bg-green-50 border-green-100":"warning"===t.type?"bg-yellow-50 border-yellow-100":"bg-blue-50 border-blue-100"),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(zr,{className:`\n                ${"success"===t.type?"text-green-600":"warning"===t.type?"text-yellow-600":"text-blue-600"}\n              `,size:20}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:`\n                  ${"success"===t.type?"text-green-900":"warning"===t.type?"text-yellow-900":"text-blue-900"}\n                `,children:t.message}),t.metric&&e.jsxs("div",{className:"mt-2 flex items-baseline gap-2",children:[e.jsxs("span",{className:"text-sm font-medium",children:[t.metric,":"]}),e.jsx("span",{className:"text-lg font-semibold",children:t.value})]})]})]})},s)))}),e.jsxs("div",{className:"grid grid-cols-4 gap-6",children:[e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Ea,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Customers"})]}),e.jsx("div",{className:"text-2xl font-semibold",children:null==h?void 0:h.customerCount.toLocaleString()}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:[null==h?void 0:h.purchasedCount.toLocaleString()," purchased"]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(aa,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Revenue"})]}),e.jsxs("div",{className:"text-2xl font-semibold",children:["$",null==h?void 0:h.revenue.toLocaleString()]}),e.jsxs("div",{className:"mt-1 text-sm text-gray-500",children:["$",null==h?void 0:h.averageOrder.toLocaleString()," avg. order"]})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Oa,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Inventory"})]}),e.jsx("div",{className:"text-2xl font-semibold",children:null==h?void 0:h.inventorySold.toLocaleString()}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"bottles sold"})]}),e.jsxs("div",{className:"bg-white p-6 rounded-lg border",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-500 mb-2",children:[e.jsx(Sa,{className:"h-5 w-5"}),e.jsx("span",{className:"text-sm",children:"Completion"})]}),e.jsxs("div",{className:"text-2xl font-semibold",children:[null==h?void 0:h.completionRate.toFixed(1),"%"]}),e.jsx("div",{className:"mt-1 text-sm text-gray-500",children:"of customers purchased"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg border",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsx("h2",{className:"text-lg font-medium",children:"Recent Customers"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Customer"}),e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Last Purchase"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Total Spent"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Actions"})]})}),e.jsx("tbody",{className:"divide-y",children:g.map((t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:t.name}),e.jsx("div",{className:"text-sm text-gray-500",children:t.email})]})}),e.jsx("td",{className:"p-4",children:new Date(t.lastPurchase).toLocaleDateString()}),e.jsxs("td",{className:"p-4 text-right",children:["$",t.totalSpent.toLocaleString()]}),e.jsx("td",{className:"p-4 text-right",children:e.jsx(Ri,{variant:"outline",size:"sm",children:"View Details"})})]},t.id)))})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg border",children:[e.jsx("div",{className:"p-6 border-b",children:e.jsx("h2",{className:"text-lg font-medium",children:"Top Products"})}),e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b bg-gray-50",children:[e.jsx("th",{className:"text-left text-sm font-medium text-gray-500 p-4",children:"Product"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Sold"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Revenue"}),e.jsx("th",{className:"text-right text-sm font-medium text-gray-500 p-4",children:"Remaining"})]})}),e.jsx("tbody",{className:"divide-y",children:v.map((t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"p-4",children:e.jsx("div",{className:"font-medium",children:t.name})}),e.jsx("td",{className:"p-4 text-right",children:t.sold.toLocaleString()}),e.jsxs("td",{className:"p-4 text-right",children:["$",t.revenue.toLocaleString()]}),e.jsx("td",{className:"p-4 text-right",children:t.remaining.toLocaleString()})]},t.id)))})]})})]})]}):e.jsx("div",{className:"min-h-[400px] flex flex-col items-center justify-center",children:e.jsxs("div",{className:"text-center space-y-4",children:[e.jsx(zr,{className:"mx-auto h-12 w-12 text-red-500"}),e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Allocation Not Found"}),e.jsx("p",{className:"text-gray-500",children:"The allocation you're looking for doesn't exist."}),e.jsxs(Ri,{variant:"outline",onClick:()=>r("/allocations"),children:[e.jsx(Ur,{className:"w-4 h-4 mr-2"}),"Return to Allocations"]})]})})}function Lu(){const t=ae(),{signIn:s}=qr(),[r,a]=te.useState(""),[i,n]=te.useState(""),[o,l]=te.useState(null),[c,d]=te.useState(!1);return e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsx("div",{children:e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to your account"})}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:async e=>{e.preventDefault(),l(null),d(!0);try{await s(r,i),t("/")}catch(a){l("Failed to sign in. Please check your credentials.")}finally{d(!1)}},children:[o&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsx("div",{className:"text-sm text-red-700",children:o})}),e.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),e.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,value:r,onChange:e=>a(e.target.value),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Email address"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"current-password",required:!0,value:i,onChange:e=>n(e.target.value),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Password"})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:c,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:c?"Signing in...":"Sign in"})})]})]})})}function Fu(){const{signUp:t}=qr(),[s,r]=te.useState(""),[a,i]=te.useState(""),[n,o]=te.useState(null),[l,c]=te.useState(!1),[d,u]=te.useState(!1);return d?e.jsx("div",{className:"rounded-md bg-green-50 p-4",children:e.jsx("div",{className:"text-sm text-green-700",children:"Account created successfully! You can now sign in."})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gray-50 py-12 px-4 sm:px-6 lg:px-8",children:e.jsxs("div",{className:"max-w-md w-full space-y-8",children:[e.jsx("div",{children:e.jsx("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Create your account"})}),e.jsxs("form",{className:"mt-8 space-y-6",onSubmit:async e=>{e.preventDefault(),o(null),c(!0);try{await t(s,a),u(!0)}catch(r){o("Failed to create account. Please try again.")}finally{c(!1)}},children:[n&&e.jsx("div",{className:"rounded-md bg-red-50 p-4",children:e.jsx("div",{className:"text-sm text-red-700",children:n})}),e.jsxs("div",{className:"rounded-md shadow-sm -space-y-px",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"email-address",className:"sr-only",children:"Email address"}),e.jsx("input",{id:"email-address",name:"email",type:"email",autoComplete:"email",required:!0,value:s,onChange:e=>r(e.target.value),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-t-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Email address"})]}),e.jsxs("div",{children:[e.jsx("label",{htmlFor:"password",className:"sr-only",children:"Password"}),e.jsx("input",{id:"password",name:"password",type:"password",autoComplete:"new-password",required:!0,value:a,onChange:e=>i(e.target.value),className:"appearance-none rounded-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-b-md focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Password"})]})]}),e.jsx("div",{children:e.jsx("button",{type:"submit",disabled:l,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:l?"Creating account...":"Create account"})})]})]})})}class zu{constructor(e="https://api.securecheckout.com/v1"){this.baseUrl=e,this.authToken=null}async request(e,t={}){const s=e.startsWith("/")?e:`/${e}`,r=`https://cors-anywhere.herokuapp.com/${this.baseUrl}${s}`,a={"Content-Type":"application/json",Accept:"application/json","X-Requested-With":"XMLHttpRequest",Origin:window.location.origin,...t.headers};this.authToken&&(a.Authorization=this.authToken,a["X-Auth-Token"]=this.authToken);try{const e=await fetch(r,{...t,headers:a,mode:"cors",credentials:"omit"});if(403===e.status){if((await e.text()).includes("cors-anywhere"))throw new Wn("CORS proxy access not enabled. Please visit https://cors-anywhere.herokuapp.com/corsdemo to enable temporary access.",403,"Forbidden")}if(!e.ok){await e.text();throw new Wn(`API request failed: ${e.statusText}`,e.status,e.statusText)}const s=e.headers.get("content-type");if(null==s?void 0:s.includes("application/json")){const t=await e.json();if(t.error)throw new Wn(t.error.message||"API Error",t.error.code||e.status);return t}await e.text();return null}catch(i){if(i instanceof Wn)throw i;if(i instanceof TypeError&&"Failed to fetch"===i.message)throw new Wn("Network error - unable to reach API. Please check your internet connection and try again.",0,"Network Error");throw new Wn(i instanceof Error?i.message:"An unknown error occurred")}}async authenticate(e,t,s){return this.request("/account/authenticate",{method:"POST",body:JSON.stringify({username:e,password:t,account:s})})}async authenticate2FA(e,t){return this.request("/account/authenticate/2fa",{method:"POST",body:JSON.stringify({ticket:e,pin:t})})}async getAuthToken(e,t){const s=await this.request("/account/authorize",{method:"POST",body:JSON.stringify({ticket:e,account:t})});return s.token&&(this.authToken=s.token),s}setAuthToken(e){this.authToken=e}clearAuthToken(){this.authToken=null}async createAddress(e){return this.request("/addresses",{method:"POST",body:JSON.stringify(e)})}async getAddress(e){return this.request(`/addresses/${e}`)}async getAddresses(e,t){return this.request(`/addresses/${e}/${t}`)}async updateAddress(e,t){return this.request(`/addresses/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteAddress(e){return this.request(`/addresses/${e}`,{method:"DELETE"})}async getCustomerAddresses(e){return this.request(`/addresses/customer/${e}`)}async getCustomerDefaultAddress(e){return this.request(`/addresses/customer/${e}/default`)}async setCustomerDefaultAddress(e,t){return this.request(`/addresses/customer/${e}/default/${t}`,{method:"PUT"})}async createCustomer(e){return this.request("/customers",{method:"POST",body:JSON.stringify(e)})}async getCustomer(e){return this.request(`/customers/${e}`)}async updateCustomer(e,t){return this.request(`/customers/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteCustomer(e){return this.request(`/customers/${e}`,{method:"DELETE"})}async searchCustomers(e){return this.request(`/customers/search/${e}`)}async filterCustomers(e){return this.request("/customers/filter",{method:"POST",body:JSON.stringify(e)})}async getCustomerTags(){return this.request("/customers/tags")}async addCustomerToGroup(e,t){return this.request(`/customers/${e}/groups/${t}`,{method:"PUT"})}async removeCustomerFromGroup(e,t){return this.request(`/customers/${e}/groups/${t}`,{method:"DELETE"})}async getCustomerGroups(e){return this.request(`/customers/${e}/groups`)}async clearCustomerGroups(e){return this.request(`/customers/${e}/groups`,{method:"DELETE"})}async createGroup(e){return this.request("/groups",{method:"POST",body:JSON.stringify(e)})}async getGroup(e){return this.request(`/groups/${e}`)}async getAllGroups(){return this.request("/groups")}async updateGroup(e,t){return this.request(`/groups/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deleteGroup(e){return this.request(`/groups/${e}`,{method:"DELETE"})}async getGroupCustomers(e){return this.request(`/groups/${e}/customers`)}async getOrder(e){return this.request(`/orders/${e}`)}async searchOrders(e){return this.request(`/orders/search/${e}`)}async filterOrders(e){return this.request("/orders/filter",{method:"POST",body:JSON.stringify(e)})}async updateOrder(e,t){return this.request(`/orders/${e}`,{method:"PUT",body:JSON.stringify(t)})}async cancelOrder(e){return this.request(`/orders/${e}`,{method:"DELETE"})}async createPaymentMethod(e){return this.request("/payment",{method:"POST",body:JSON.stringify(e)})}async getPaymentMethod(e){return this.request(`/payment/${e}`)}async getAllPaymentMethods(){return this.request("/payment")}async updatePaymentMethod(e,t){return this.request(`/payment/${e}`,{method:"PUT",body:JSON.stringify(t)})}async deletePaymentMethod(e){return this.request(`/payment/${e}`,{method:"DELETE"})}async getCustomerPaymentMethods(e){return this.request(`/payment/customer/${e}`)}async getCustomerDefaultPaymentMethod(e){return this.request(`/payment/customer/${e}/default`)}async setCustomerDefaultPaymentMethod(e,t){return this.request(`/payment/customer/${e}/default/${t}`,{method:"PUT"})}}function Vu(e={}){const{settings:t}=Kn(),[s,r]=te.useState(!1),[a,i]=te.useState(null),n=(o=e.baseUrl,new zu(o));var o;te.useEffect((()=>{t.managementAuthToken&&n.setAuthToken(t.managementAuthToken)}),[n,t.managementAuthToken]);const l=te.useCallback((async e=>{r(!0),i(null);try{return await e(n)}catch(t){throw t instanceof Wn?i({message:t.message,status:t.status,statusText:t.statusText,details:t}):t instanceof Error?i({message:t.message,details:t}):i({message:"An unknown error occurred",details:t}),t}finally{r(!1)}}),[n]),c=te.useCallback((()=>{i(null)}),[]);return{client:n,loading:s,error:a,request:l,clearError:c}}const Uu=[{id:"reporting-groups-all",name:"Get All Groups",path:"/groups",method:"GET",description:"Get a list of all available groups",parameters:[],api:"reporting"},{id:"reporting-group-get",name:"Get Group",path:"/groups/{id}",method:"GET",description:"Get details for a specific group",parameters:[{name:"id",type:"string",required:!0,description:"Group ID"}],api:"reporting"},{id:"reporting-clubs-all",name:"Get All Clubs",path:"/clubs",method:"GET",description:"Get a list of all available clubs",parameters:[],api:"reporting"},{id:"reporting-club-get",name:"Get Club",path:"/clubs/{id}",method:"GET",description:"Get details for a specific club",parameters:[{name:"id",type:"string",required:!0,description:"Club ID"}],api:"reporting"},{id:"reporting-customer-get",name:"Get Customer",path:"/customers/{id}",method:"GET",description:"Get details for a specific customer",parameters:[{name:"id",type:"string",required:!0,description:"Customer ID"}],api:"reporting"},{id:"reporting-customers-signup",name:"Get Customers by Signup Date",path:"/customers/created/{start}/{end}/{limit}/{page}",method:"GET",description:"Get customers filtered by signup date",parameters:[{name:"start",type:"string",required:!0,description:"Start date (YYYY-MM-DD)"},{name:"end",type:"string",required:!0,description:"End date (YYYY-MM-DD)"},{name:"limit",type:"number",required:!0,description:"Number of records per page"},{name:"page",type:"number",required:!0,description:"Page number"}],api:"reporting"},{id:"reporting-products-all",name:"Get All Products",path:"/products",method:"GET",description:"Get a list of all available products",parameters:[],api:"reporting"},{id:"management-auth-user",name:"Authenticate User",path:"/account/authenticate",method:"POST",description:"Authenticate a user with username and password",parameters:[{name:"username",type:"string",required:!0,description:"User email address"},{name:"password",type:"string",required:!0,description:"User password"},{name:"account",type:"string",required:!1,description:"Optional account name"}],api:"management",requiresAuth:!1},{id:"management-auth-2fa",name:"Authenticate 2FA",path:"/account/authenticate/2fa",method:"POST",description:"Complete two-factor authentication",parameters:[{name:"ticket",type:"string",required:!0,description:"Authentication ticket"},{name:"pin",type:"string",required:!0,description:"2FA code"}],api:"management",requiresAuth:!1},{id:"management-auth-token",name:"Get Auth Token",path:"/account/authorize",method:"POST",description:"Get an authentication token for an account",parameters:[{name:"ticket",type:"string",required:!0,description:"Authentication ticket"},{name:"account",type:"string",required:!0,description:"Account name"}],api:"management",requiresAuth:!1},{id:"management-customer-tags",name:"Get Customer Tags",path:"/customers/tags",method:"GET",description:"Get all customer tags",parameters:[],api:"management",requiresAuth:!0},{id:"management-address-create",name:"Create Address",path:"/addresses",method:"POST",description:"Create a new address",parameters:[{name:"address",type:"string",required:!0,description:"Street address"},{name:"city",type:"string",required:!0,description:"City"},{name:"state",type:"string",required:!0,description:"State"},{name:"zip",type:"string",required:!0,description:"Zip code"},{name:"customer_id",type:"string",required:!0,description:"Customer ID"}],api:"management",requiresAuth:!0},{id:"management-address-get",name:"Get Address",path:"/addresses/{id}",method:"GET",description:"Get address details",parameters:[{name:"id",type:"string",required:!0,description:"Address ID"}],api:"management",requiresAuth:!0},{id:"management-address-update",name:"Update Address",path:"/addresses/{id}",method:"PUT",description:"Update an existing address",parameters:[{name:"id",type:"string",required:!0,description:"Address ID"},{name:"address",type:"string",required:!1,description:"Street address"},{name:"city",type:"string",required:!1,description:"City"},{name:"state",type:"string",required:!1,description:"State"}],api:"management",requiresAuth:!0},{id:"management-customer-create",name:"Create Customer",path:"/customers",method:"POST",description:"Create a new customer",parameters:[{name:"email",type:"string",required:!0,description:"Customer email"},{name:"first_name",type:"string",required:!0,description:"First name"},{name:"last_name",type:"string",required:!0,description:"Last name"},{name:"password",type:"string",required:!0,description:"Customer password"}],api:"management",requiresAuth:!0},{id:"management-customer-get",name:"Get Customer",path:"/customers/{id}",method:"GET",description:"Get customer details",parameters:[{name:"id",type:"string",required:!0,description:"Customer ID"}],api:"management",requiresAuth:!0},{id:"management-customer-search",name:"Search Customers",path:"/customers/search/{query}",method:"GET",description:"Search for customers",parameters:[{name:"query",type:"string",required:!0,description:"Search query"}],api:"management",requiresAuth:!0},{id:"management-group-create",name:"Create Group",path:"/groups",method:"POST",description:"Create a new customer group",parameters:[{name:"name",type:"string",required:!0,description:"Group name"},{name:"description",type:"string",required:!1,description:"Group description"},{name:"status",type:"string",required:!1,description:"Group status"}],api:"management",requiresAuth:!0},{id:"management-group-get",name:"Get Group",path:"/groups/{id}",method:"GET",description:"Get group details",parameters:[{name:"id",type:"string",required:!0,description:"Group ID"}],api:"management",requiresAuth:!0},{id:"management-groups-all",name:"Get All Groups",path:"/groups",method:"GET",description:"Get all customer groups",parameters:[],api:"management",requiresAuth:!0},{id:"management-order-get",name:"Get Order",path:"/orders/{id}",method:"GET",description:"Get order details",parameters:[{name:"id",type:"string",required:!0,description:"Order ID"}],api:"management",requiresAuth:!0},{id:"management-order-search",name:"Search Orders",path:"/orders/search/{query}",method:"GET",description:"Search for orders",parameters:[{name:"query",type:"string",required:!0,description:"Search query"}],api:"management",requiresAuth:!0},{id:"management-order-cancel",name:"Cancel Order",path:"/orders/{id}",method:"DELETE",description:"Cancel an order",parameters:[{name:"id",type:"string",required:!0,description:"Order ID"}],api:"management",requiresAuth:!0},{id:"management-payment-create",name:"Create Payment Method",path:"/payment",method:"POST",description:"Create a new payment method",parameters:[{name:"customer_id",type:"string",required:!0,description:"Customer ID"},{name:"card_token",type:"string",required:!0,description:"Stripe card token"},{name:"card_type",type:"string",required:!0,description:"Card type (e.g., Visa)"},{name:"credit_number",type:"string",required:!0,description:"Last 4 digits"}],api:"management",requiresAuth:!0},{id:"management-payment-get",name:"Get Payment Method",path:"/payment/{id}",method:"GET",description:"Get payment method details",parameters:[{name:"id",type:"string",required:!0,description:"Payment method ID"}],api:"management",requiresAuth:!0},{id:"management-payment-customer",name:"Get Customer Payment Methods",path:"/payment/customer/{customer_id}",method:"GET",description:"Get all payment methods for a customer",parameters:[{name:"customer_id",type:"string",required:!0,description:"Customer ID"}],api:"management",requiresAuth:!0}];function Zu(){const{request:t,loading:s}=Qn(),{request:r,loading:a,client:i}=Vu(),{settings:n}=Kn(),[o,l]=te.useState("reporting"),[c,d]=te.useState(null),[u,h]=te.useState({}),[m,p]=te.useState(null),[x,g]=te.useState(null),[f,v]=te.useState("");te.useEffect((()=>{n.managementAuthToken&&v(n.managementAuthToken)}),[n.managementAuthToken]);const y=Uu.filter((e=>e.api===o));return e.jsx("div",{className:"max-w-6xl mx-auto py-8 px-4",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-semibold text-gray-900",children:"API Test Console"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"Test and explore the Offset APIs"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx($n,{children:"Select API"}),e.jsxs(Ln,{value:o,onValueChange:e=>{l(e),d(null),h({}),p(null),g(null)},className:"flex gap-4",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fn,{value:"reporting",id:"reporting"}),e.jsx($n,{htmlFor:"reporting",children:"Reporting API"})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(Fn,{value:"management",id:"management"}),e.jsx($n,{htmlFor:"management",children:"Management API"})]})]})]}),"management"===o&&e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"authToken",children:"Auth Token"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Gi,{id:"authToken",value:f,onChange:e=>v(e.target.value),placeholder:"Enter authentication token",className:"flex-1"}),e.jsx(Ri,{variant:"outline",onClick:()=>{v(""),i.clearAuthToken()},children:"Clear"})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:f?"Token set. Will be used for authenticated endpoints.":"No token set. Authenticate first or enter a token manually."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx($n,{children:"Select Endpoint"}),e.jsxs(Wi,{value:null==c?void 0:c.id,onValueChange:e=>{const t=Uu.find((t=>t.id===e));d(t||null),h({}),p(null),g(null)},children:[e.jsx(Hi,{children:e.jsx(Ji,{placeholder:"Choose an endpoint"})}),e.jsx(Qi,{children:y.map((t=>e.jsxs(Xi,{value:t.id,children:[t.name," ",t.requiresAuth?"":""]},t.id)))})]})]}),c&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-700 rounded",children:c.method}),e.jsx("code",{className:"font-mono text-gray-800",children:c.path}),c.requiresAuth&&e.jsx("span",{className:"ml-auto px-2 py-1 bg-yellow-100 text-yellow-800 rounded text-xs",children:"Requires Auth"})]}),e.jsx("p",{className:"mt-2 text-sm text-gray-600",children:c.description})]}),c.parameters.length>0&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Parameters"}),e.jsx("div",{className:"space-y-3",children:c.parameters.map((t=>e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:[t.name,t.required&&e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(Gi,{type:"number"===t.type?"number":"text",value:u[t.name]||"",onChange:e=>{return s=t.name,r=e.target.value,void h((e=>({...e,[s]:r})));var s,r},placeholder:t.description})]},t.name)))})]}),e.jsx(Ri,{onClick:async()=>{if(c)try{g(null),p(null);const e=c.parameters.filter((e=>e.required&&!u[e.name]));if(e.length>0)return void g(`Missing required parameters: ${e.map((e=>e.name)).join(", ")}`);if("management"===c.api&&!0===c.requiresAuth&&!f)return void g("Authentication token is required for this endpoint. Please authenticate first and set the token.");"management"===c.api&&f&&i.setAuthToken(f);let s=c.path;if(c.parameters.forEach((e=>{s=s.replace(`{${e.name}}`,u[e.name]||"")})),"reporting"===o){const e=await t((async e=>{switch(c.id){case"reporting-groups-all":return e.getGroups();case"reporting-group-get":return e.getGroup(u.id);case"reporting-clubs-all":return e.getClubs();case"reporting-club-get":return e.getClub(u.id);case"reporting-customer-get":return e.getCustomer(u.id);case"reporting-customers-signup":return e.getCustomersBySignup(u.start,u.end,parseInt(u.limit),parseInt(u.page));case"reporting-products-all":return e.getAvailableProducts();default:throw new Error("Unknown endpoint")}}));p(e)}else{const e=await r((async e=>{switch(c.id){case"management-auth-user":return e.authenticate(u.username,u.password,u.account);case"management-auth-2fa":return e.authenticate2FA(u.ticket,u.pin);case"management-auth-token":const t=await e.getAuthToken(u.ticket,u.account);return t&&t.token&&v(t.token),t;case"management-customer-tags":return e.getCustomerTags();case"management-address-create":return e.createAddress(u);case"management-address-get":return e.getAddress(u.id);case"management-address-update":return e.updateAddress(u.id,u);case"management-customer-create":return e.createCustomer(u);case"management-customer-get":return e.getCustomer(u.id);case"management-customer-search":return e.searchCustomers(u.query);case"management-group-create":return e.createGroup(u);case"management-group-get":return e.getGroup(u.id);case"management-groups-all":return e.getAllGroups();case"management-order-get":return e.getOrder(u.id);case"management-order-search":return e.searchOrders(u.query);case"management-order-cancel":return e.cancelOrder(u.id);case"management-payment-create":return e.createPaymentMethod(u);case"management-payment-get":return e.getPaymentMethod(u.id);case"management-payment-customer":return e.getCustomerPaymentMethods(u.customer_id);default:throw new Error("Unknown endpoint")}}));p(e)}}catch(e){g(e instanceof Error?e.message:"An error occurred")}},disabled:s||a,className:"w-full",children:s||a?e.jsxs(e.Fragment,{children:[e.jsx(ha,{className:"w-4 h-4 mr-2 animate-spin"}),"Testing..."]}):"Test Endpoint"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-medium text-gray-700",children:"Response"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 min-h-[400px]",children:s||a?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(ha,{className:"w-6 h-6 text-gray-400 animate-spin"})}):x?e.jsx("div",{className:"text-red-600 whitespace-pre-wrap",children:x}):m?e.jsx("pre",{className:"text-sm text-gray-800 whitespace-pre-wrap",children:JSON.stringify(m,null,2)}):e.jsx("div",{className:"text-gray-500 text-center",children:'Select an endpoint and click "Test Endpoint" to see the response'})})]})]})]})})}function Bu(){const t=[{icon:ja,label:"General",to:"/settings"},{icon:ua,label:"API",to:"/settings/api"},{icon:Pa,label:"Account",to:"/settings/account"},{icon:Gr,label:"Notifications",to:"/settings/notifications"},{icon:ba,label:"Security",to:"/settings/security"},{icon:ra,label:"Data",to:"/settings/data"}];return e.jsx("div",{className:"space-y-6",children:e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold mb-4",children:"Settings"}),e.jsx("nav",{className:"space-y-1",children:t.map((t=>e.jsxs(se,{to:t.to,className:({isActive:e})=>"flex items-center gap-3 px-3 py-2 rounded-lg transition-colors "+(e?"bg-primary/5 text-primary font-medium":"text-gray-600 hover:bg-gray-100"),end:"/settings"===t.to,children:[e.jsx(t.icon,{size:18}),e.jsx("span",{children:t.label})]},t.to)))})]})})}function Gu(){return e.jsxs("div",{className:"grid grid-cols-[240px,1fr] gap-6",children:[e.jsx(Bu,{}),e.jsx("div",{className:"space-y-6",children:e.jsx(re,{})})]})}function Wu(){return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"General Settings"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Configure general application settings"})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"text-lg font-medium",children:"Application Preferences"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"timezone",children:"Timezone"}),e.jsxs(Wi,{defaultValue:"America/Los_Angeles",children:[e.jsx(Hi,{id:"timezone",children:e.jsx(Ji,{placeholder:"Select timezone"})}),e.jsxs(Qi,{children:[e.jsx(Xi,{value:"America/Los_Angeles",children:"Pacific Time (US & Canada)"}),e.jsx(Xi,{value:"America/Denver",children:"Mountain Time (US & Canada)"}),e.jsx(Xi,{value:"America/Chicago",children:"Central Time (US & Canada)"}),e.jsx(Xi,{value:"America/New_York",children:"Eastern Time (US & Canada)"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"dateFormat",children:"Date Format"}),e.jsxs(Wi,{defaultValue:"MM/DD/YYYY",children:[e.jsx(Hi,{id:"dateFormat",children:e.jsx(Ji,{placeholder:"Select date format"})}),e.jsxs(Qi,{children:[e.jsx(Xi,{value:"MM/DD/YYYY",children:"MM/DD/YYYY"}),e.jsx(Xi,{value:"DD/MM/YYYY",children:"DD/MM/YYYY"}),e.jsx(Xi,{value:"YYYY-MM-DD",children:"YYYY-MM-DD"})]})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"language",children:"Language"}),e.jsxs(Wi,{defaultValue:"en",children:[e.jsx(Hi,{id:"language",children:e.jsx(Ji,{placeholder:"Select language"})}),e.jsxs(Qi,{children:[e.jsx(Xi,{value:"en",children:"English"}),e.jsx(Xi,{value:"es",children:"Spanish"}),e.jsx(Xi,{value:"fr",children:"French"})]})]})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(Ri,{children:"Save Changes"})})]})]})}var Ju="Tabs",[Hu,Ku]=V(Ju,[U]),Yu=U(),[Qu,Xu]=Hu(Ju),eh=te.forwardRef(((t,s)=>{const{__scopeTabs:r,value:a,onValueChange:i,defaultValue:n,orientation:o="horizontal",dir:l,activationMode:c="automatic",...d}=t,u=Z(l),[h,m]=B({prop:a,onChange:i,defaultProp:n});return e.jsx(Qu,{scope:r,baseId:G(),value:h,onValueChange:m,orientation:o,dir:u,activationMode:c,children:e.jsx(W.div,{dir:u,"data-orientation":o,...d,ref:s})})}));eh.displayName=Ju;var th="TabsList",sh=te.forwardRef(((t,s)=>{const{__scopeTabs:r,loop:a=!0,...i}=t,n=Xu(th,r),o=Yu(r);return e.jsx(J,{asChild:!0,...o,orientation:n.orientation,dir:n.dir,loop:a,children:e.jsx(W.div,{role:"tablist","aria-orientation":n.orientation,...i,ref:s})})}));sh.displayName=th;var rh="TabsTrigger",ah=te.forwardRef(((t,s)=>{const{__scopeTabs:r,value:a,disabled:i=!1,...n}=t,o=Xu(rh,r),l=Yu(r),c=oh(o.baseId,a),d=lh(o.baseId,a),u=a===o.value;return e.jsx(H,{asChild:!0,...l,focusable:!i,active:u,children:e.jsx(W.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":d,"data-state":u?"active":"inactive","data-disabled":i?"":void 0,disabled:i,id:c,...n,ref:s,onMouseDown:K(t.onMouseDown,(e=>{i||0!==e.button||!1!==e.ctrlKey?e.preventDefault():o.onValueChange(a)})),onKeyDown:K(t.onKeyDown,(e=>{[" ","Enter"].includes(e.key)&&o.onValueChange(a)})),onFocus:K(t.onFocus,(()=>{const e="manual"!==o.activationMode;u||i||!e||o.onValueChange(a)}))})})}));ah.displayName=rh;var ih="TabsContent",nh=te.forwardRef(((t,s)=>{const{__scopeTabs:r,value:a,forceMount:i,children:n,...o}=t,l=Xu(ih,r),c=oh(l.baseId,a),d=lh(l.baseId,a),u=a===l.value,h=te.useRef(u);return te.useEffect((()=>{const e=requestAnimationFrame((()=>h.current=!1));return()=>cancelAnimationFrame(e)}),[]),e.jsx(Y,{present:i||u,children:({present:r})=>e.jsx(W.div,{"data-state":u?"active":"inactive","data-orientation":l.orientation,role:"tabpanel","aria-labelledby":c,hidden:!r,id:d,tabIndex:0,...o,ref:s,style:{...t.style,animationDuration:h.current?"0s":void 0},children:r&&n})})}));function oh(e,t){return`${e}-trigger-${t}`}function lh(e,t){return`${e}-content-${t}`}nh.displayName=ih;var ch=sh,dh=ah,uh=nh;const hh=eh,mh=te.forwardRef((({className:t,...s},r)=>e.jsx(ch,{ref:r,className:Ai("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",t),...s})));mh.displayName=ch.displayName;const ph=te.forwardRef((({className:t,...s},r)=>e.jsx(dh,{ref:r,className:Ai("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",t),...s})));ph.displayName=dh.displayName;const xh=te.forwardRef((({className:t,...s},r)=>e.jsx(uh,{ref:r,className:Ai("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",t),...s})));function gh(){const{settings:t,updateSettings:s,saveSettings:r}=Kn(),{request:a,loading:i,error:n,client:o}=Vu(),[l,c]=te.useState(t.reportingApiKey||""),[d,u]=te.useState(t.managementUsername||""),[h,m]=te.useState(""),[p,x]=te.useState("idle"),[g,f]=te.useState(""),[v,y]=te.useState({}),[j,b]=te.useState(t.managementAccount||""),[w,N]=te.useState(t.managementAuthToken||""),[_,k]=te.useState(""),[S,C]=te.useState(""),[T,A]=te.useState(!1),[P,E]=te.useState(!1),O=te.useMemo((()=>Object.entries(v).filter((([e,t])=>{const s=S.toLowerCase();return t.name.toLowerCase().includes(s)||t.account.toLowerCase().includes(s)})).sort(((e,t)=>e[1].name.localeCompare(t[1].name)))),[v,S]);te.useEffect((()=>{t.managementAuthToken&&o.setAuthToken(t.managementAuthToken)}),[t.managementAuthToken,o]);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-semibold",children:"API Settings"}),e.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:"Configure API credentials for Offset Reporting and Management APIs"})]}),e.jsxs(hh,{defaultValue:"reporting",children:[e.jsxs(mh,{children:[e.jsx(ph,{value:"reporting",children:"Reporting API"}),e.jsx(ph,{value:"management",children:"Management API"})]}),e.jsx(xh,{value:"reporting",className:"space-y-6 mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ua,{className:"h-5 w-5 mt-0.5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Reporting API Configuration"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure your Offset Reporting API credentials"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"reportingApiKey",children:"API Key"}),e.jsx(Gi,{id:"reportingApiKey",value:l,onChange:e=>c(e.target.value),placeholder:"Enter your Reporting API key",type:"password"}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Your API key is used to authenticate requests to the Offset Reporting API"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(Ri,{onClick:()=>{s({reportingApiKey:l}),r()},children:"Save API Key"})})]})}),e.jsx(xh,{value:"management",className:"space-y-6 mt-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Pa,{className:"h-5 w-5 mt-0.5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Management API Authentication"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Authenticate with your Offset account credentials"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"managementUsername",children:"Username"}),e.jsx(Gi,{id:"managementUsername",value:d,onChange:e=>u(e.target.value),placeholder:"Enter your Offset username"})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"managementPassword",children:"Password"}),e.jsx(Gi,{id:"managementPassword",value:h,onChange:e=>m(e.target.value),placeholder:"Enter your Offset password",type:"password"})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(Ri,{onClick:async()=>{try{x("loading"),f("Authenticating...");const e=await a((e=>e.authenticate(d,h)));(null==e?void 0:e.ticket)&&(null==e?void 0:e.accounts)?(k(e.ticket),y(e.accounts),x("success"),f("Authentication successful! Please select an account."),s({managementUsername:d})):(x("error"),f("Authentication failed. Please check your credentials."))}catch(e){x("error"),f(e instanceof Error?e.message:"Authentication failed")}},disabled:i||!d||!h,children:i&&"loading"===p?e.jsxs(e.Fragment,{children:[e.jsx(ha,{className:"mr-2 h-4 w-4 animate-spin"}),"Authenticating..."]}):"Authenticate"})})]}),"idle"!==p&&e.jsx("div",{className:"p-4 rounded-lg "+("success"===p?"bg-green-50 text-green-800":"error"===p?"bg-red-50 text-red-800":"bg-blue-50 text-blue-800"),children:e.jsxs("div",{className:"flex items-center gap-2",children:["success"===p?e.jsx(Hr,{className:"h-5 w-5"}):"error"===p?e.jsx(zr,{className:"h-5 w-5"}):e.jsx(ha,{className:"h-5 w-5 animate-spin"}),e.jsx("span",{children:g})]})}),Object.keys(v).length>0&&e.jsxs("div",{className:"space-y-4 border-t pt-4",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(Wr,{className:"h-5 w-5 mt-0.5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-medium",children:"Select Account"}),e.jsx("p",{className:"text-sm text-muted-foreground",children:"Choose the account you want to use with the Management API"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"accountSearch",children:"Search Accounts"}),e.jsxs("div",{className:"relative",children:[e.jsx(ya,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-muted-foreground"}),e.jsx(Gi,{id:"accountSearch",placeholder:"Search by name or account ID...",value:S,onChange:e=>C(e.target.value),className:"pl-10"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx($n,{htmlFor:"account",children:"Account"}),e.jsxs(Wi,{value:j,onValueChange:b,children:[e.jsx(Hi,{id:"account",children:e.jsx(Ji,{placeholder:"Select an account"})}),e.jsxs(Qi,{className:"max-h-80",children:[O.map((([t,s])=>e.jsxs(Xi,{value:t,children:[s.name," (",s.account,")"]},t))),0===O.length&&e.jsx("div",{className:"py-2 px-2 text-sm text-muted-foreground text-center",children:"No accounts found"})]})]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[Object.keys(v).length," accounts available",S&&`  ${O.length} matches`]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx(Ri,{onClick:async()=>{if(!_||!j)return x("error"),void f("Please authenticate and select an account first");try{x("loading"),f("Getting auth token...");const e=v[j];if(!e)throw new Error("Selected account not found");const t=await a((t=>t.getAuthToken(_,e.account)));(null==t?void 0:t.token)?(N(t.token),x("success"),f("Authentication token received successfully!"),s({managementAccount:j,managementAuthToken:t.token,managementAccountName:e.name}),r()):(x("error"),f("Failed to get authentication token"))}catch(e){x("error"),f(e instanceof Error?e.message:"Failed to get authentication token")}},disabled:i||!j,children:i&&"loading"===p?e.jsxs(e.Fragment,{children:[e.jsx(ha,{className:"mr-2 h-4 w-4 animate-spin"}),"Getting token..."]}):"Get Auth Token"})})]}),w&&e.jsxs("div",{className:"space-y-2 border-t pt-4",children:[e.jsx($n,{htmlFor:"authToken",children:"Authentication Token"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(Gi,{id:"authToken",value:w,readOnly:!0,className:"font-mono text-xs"}),e.jsxs(Ri,{variant:"outline",onClick:()=>{navigator.clipboard.writeText(w),A(!0),setTimeout((()=>A(!1)),2e3)},children:[T?e.jsx(Hr,{className:"h-4 w-4 mr-2"}):e.jsx(sa,{className:"h-4 w-4 mr-2"}),T?"Copied!":"Copy"]})]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"This token will be used for all Management API requests"})]}),t.managementAccountName&&e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Current Account:"})," ",t.managementAccountName]}),t.managementAuthToken&&e.jsxs("div",{className:"flex justify-between items-center mt-1",children:[e.jsxs("p",{className:"text-sm",children:[e.jsx("span",{className:"font-medium",children:"Auth Status:"})," Authenticated"]}),e.jsxs(Ri,{variant:"outline",size:"sm",onClick:async()=>{try{E(!0);await a((e=>e.getAllGroups()))?(x("success"),f("Connection test successful! API is working correctly.")):(x("error"),f("Connection test failed. No data returned."))}catch(e){x("error"),f(e instanceof Error?e.message:"Connection test failed")}finally{E(!1)}},disabled:P,children:[P?e.jsx(ha,{className:"h-4 w-4 mr-2 animate-spin"}):e.jsx(va,{className:"h-4 w-4 mr-2"}),"Test Connection"]})]})]})]})})]})]})}function fh({children:t}){const{user:s,loading:r}=qr();return r?e.jsx("div",{children:"Loading..."}):s?e.jsx(e.Fragment,{children:t}):e.jsx(ue,{to:"/login"})}function vh(){return e.jsx(Mr,{children:e.jsx(le,{children:e.jsxs(ce,{children:[e.jsx(de,{path:"/login",element:e.jsx(Lu,{})}),e.jsx(de,{path:"/signup",element:e.jsx(Fu,{})}),e.jsxs(de,{path:"/",element:e.jsx(fh,{children:e.jsx(Ui,{})}),children:[e.jsx(de,{index:!0,element:e.jsx(Bi,{})}),e.jsxs(de,{path:"allocations",children:[e.jsx(de,{index:!0,element:e.jsx(In,{})}),e.jsx(de,{path:"new",element:e.jsx(so,{})}),e.jsx(de,{path:":id",element:e.jsx(mu,{})}),e.jsx(de,{path:":id/open",element:e.jsx(Pu,{})}),e.jsx(de,{path:":id/previous",element:e.jsx(Mu,{})}),e.jsx(de,{path:":id/open/tier/:tierId",element:e.jsx(qu,{})})]}),e.jsx(de,{path:"api",element:e.jsx(Zu,{})}),e.jsx(de,{path:"queries",element:e.jsx("div",{children:"Queries"})}),e.jsxs(de,{path:"settings",element:e.jsx(Gu,{}),children:[e.jsx(de,{index:!0,element:e.jsx(Wu,{})}),e.jsx(de,{path:"api",element:e.jsx(gh,{})}),e.jsx(de,{path:"account",element:e.jsx("div",{children:"Account Settings"})}),e.jsx(de,{path:"notifications",element:e.jsx("div",{children:"Notification Settings"})}),e.jsx(de,{path:"security",element:e.jsx("div",{children:"Security Settings"})}),e.jsx(de,{path:"data",element:e.jsx("div",{children:"Data Settings"})})]})]})]})})})}xh.displayName=uh.displayName,he(document.getElementById("root")).render(e.jsx(te.StrictMode,{children:e.jsx(vh,{})}));export{Rn as C,Gi as I,$n as L,ya as S,Qn as u};
